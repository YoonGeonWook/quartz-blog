---
sticker: emoji//1f4d5
tags:
  - Anomaly_Detection
  - ì´ìƒíƒì§€
  - distance_based
  - ê±°ë¦¬ê¸°ë°˜
---
# ğŸ² Distance-based Methods

## ğŸ¯ $k$ - Nearest Neighbor-based Anomaly Detection

### $k$ - Nearest Neighbor-based Approach

![[Pasted image 20240117192157.png|center]]

ì´ëŸ¬í•œ ê±°ë¦¬ ê¸°ë°˜ ì´ìƒ íƒì§€ ê¸°ë²•ë“¤ì€ ì´ìƒì¹˜ëŠ” ì •ìƒì ì¸ ë‹¤ë¥¸ ë°ì´í„°ë“¤ê³¼ëŠ” ë©€ë¦¬ ë–¨ì–´ì ¸ ìˆê³ , ì •ìƒ ë°ì´í„°ëŠ” ì£¼ë³€ ê°€ê¹Œì´ì— ë‹¤ë¥¸ ë°ì´í„°ê°€ ë§ì´ ìˆì„ ê²ƒì´ë€ ê°€ì •ì„ ê¹”ê³  ìˆë‹¤. 

- í•µì‹¬ : ì •ìƒ ë°ì´í„° (normal class)ì— ì–´ë– í•œ ì‚¬ì „ í™•ë¥  ë¶„í¬ë„ ê°€ì •í•˜ì§€ ì•ŠìŒ - Nonparametric method
- $k$ ê°œì˜ ì´ì›ƒë“¤ì— ëŒ€í•œ ê±°ë¦¬ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ abnormal scoresë¥¼ ê³„ì‚° 

#### Various distance information used for anomaly score

Parzen window density estimation ì—ì„œëŠ” ì•„ë˜ì˜ ì‹ ì¤‘ $V$ (ê´€ì‹¬ ì˜ì—­ $R$ì˜ volume)ë¥¼ ê³ ì •ì‹œí‚¤ê³  $k$ ë¥¼ êµ¬í–ˆë‹¤: $$p(x)=\frac{k}{N\cdot V}$$
ë°˜ëŒ€ë¡œ KNN ê¸°ë°˜ ë°©ë²•ì€ $k$ ë¥¼ ê³ ì •ì‹œí‚¤ê³  ê·¸ $k$ ë¥¼ ì»¤ë²„í•˜ëŠ” $V$ ë¥¼ ì°¾ê³ ìí•˜ì—¬ í™•ë¥  ë°€ë„ë¥¼ ì¶”ì •í•˜ëŠ” ê°œë…ì´ë‹¤. ê·¸ëŸ°ë° ì´ volume $V$ ë¥¼ ê°œë…ì„ ì •ì˜í•˜ê¸° ìœ„í•´ì„œ, ì¦‰ $k$ ë²ˆì§¸ ê±°ë¦¬ë¥¼ ì¸¡ì •í•˜ëŠ” ì—¬ëŸ¬ ê°€ì§€ ë°©ë²•ì´ ì¡´ì¬í•œë‹¤. 

- Maximum distance to the $k$ -th nearest neighbor 
	- k ë²ˆì§¸ ì´ì›ƒê¹Œì§€ ìµœëŒ€ ê±°ë¦¬ $$d_{\max}^k = \kappa(\mathbf{x}) = ||\mathbf{x}-z_k(\mathbf{x})||$$
- Average distance to the $k$ -th nearest neighbors
	- $k$ ê°œì˜ ì´ì›ƒë“¤ì˜ í‰ê·  ê±°ë¦¬ $$d_{avg}^k=\gamma(\mathbf{x})=\frac{1}{k}\sum_{j=1}^k||\mathbf{x}-z_j(\mathbf{x})||$$
- Distance to the mean of the $k$ -th nearest neighbors
	- $k$ ê°œì˜ ì´ì›ƒë“¤ì˜ ì¤‘ì‹¬ê³¼ì˜ ê±°ë¦¬ $$d_{mean}^k=\delta(\mathbf{x})=\left|\left|\mathbf{x} - \frac{1}{k}\sum_{j=1}^kz_j(\mathbf{x})\right|\right|$$
Maximum, average, mean ê±°ë¦¬ 3ê°œë¥¼ ë¹„êµí•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤ : 

![[Pasted image 20240117193757.png|center]]

ì—¬ê¸°ì„œ $k=5$ ì´ê³ , ìœ„ 4ê°œ ê·¸ë¦¼ ëª¨ë‘ maximum distance $d_\max^5 = 5.0$ ì´ë‹¤. (a)ì™€ (b)ë¥¼ ë³´ë©´ average distanceê°€ ê°ê° 4.2, 2.6 ìœ¼ë¡œ ë‹¤ë¥´ë‹¤. (c)ì™€ (d)ì—ì„œëŠ” ë‘˜ ë‹¤ average scoreëŠ” 4.4ë¡œ ë™ì¼í•˜ì§€ë§Œ, (c) ê·¸ë¦¼ì€ ì´ì›ƒë“¤ì´ ì™¼ìª½ìœ¼ë¡œ ëª°ë ¤ìˆê³ , (d)ëŠ” ì´ì›ƒë“¤ì´ ê°€ìš´ë° ì ì„ ê¸°ì¤€ìœ¼ë¡œ ê³ ë£¨ ë¶„í¬ë˜ì–´ ìˆë‹¤. ê·¸ì— ë”°ë¼ mean scoreëŠ” ê°ê° 3.3, 2.1ë¡œ ë‹¤ë¥´ë‹¤. 

#### Counter example (ë°˜ë¡€) of the previous anomaly scores

- ì•„ë˜ ê·¸ë¦¼ì—ì„œ, Case Aì™€ Case B ê°ê°ì„ ë³´ì•˜ì„ ë•Œ (<font style="color:blue">íŒŒë€ìƒ‰ ë„¤ëª¨ â–¡</font>ë“¤ì´ reference data),  <font style="color:red"> ì„¸ëª¨ â–³</font> ì™€ <font style="color:red">ë™ê·¸ë¼ë¯¸ â—‹</font> ì¤‘ ì´ìƒì¹˜ë¡œ íŒë‹¨ë  ê°€ëŠ¥ì„±ì´ ë†’ì€ ê°ì²´ëŠ” ë¬´ì—‡ì¸ê°€?

![[Pasted image 20240118164211.png|center]]

- 2ê°€ì§€ ê´€ì  : 
	- ìœ„ ê·¸ë¦¼ì—ì„œ (ì£¼í™©ìƒ‰ìœ¼ë¡œ ëœ) ê°€ê¹Œìš´ ì´ì›ƒë“¤ë¡œ ì´ë£¨ì–´ì§„ polygon ì„ ë§Œë“¤ì—ˆì„ ë•Œ, ì •ìƒ ë°ì´í„°ëŠ” ì ì–´ë„ ì´ ì´ì›ƒë“¤ë¡œ êµ¬ì„±ëœ polygon ì•ˆì— ë“¤ì–´ì™€ì•¼ í•˜ì§€ ì•Šì„ê¹Œ? - Case Bì˜ <font style="color:red"> ì„¸ëª¨ â–³</font>
	- ì´ë ‡ê²Œ ì´ì›ƒë“¤ë¡œ êµ¬ì„±ëœ polygon ì•ˆì— ë“¤ì–´ì™€ ìˆì§€ ì•Šë”ë¼ë„, ê·¸ polygon ê¹Œì§€ì˜ ê±°ë¦¬ê°€ ì§§ì•„ì•¼ ì •ìƒ ë°ì´í„°ì´ì§€ ì•Šì„ê¹Œ?
		- ì´ëŸ¬í•œ ê´€ì ì—ì„ , Case Aì˜ <font style="color:red"> ì„¸ëª¨ â–³</font> ê°€ <font style="color:red">ë™ê·¸ë¼ë¯¸ â—‹</font> ë³´ë‹¤ abnormal score ê°€ ë” ë‚®ê²Œ ë‚˜íƒ€ë‚˜ì•¼ í•¨ 

|           |                       | $d_{max}^k$ | $d_{avg}^k$ | $d_{mean}^k$ |
|:----------|:----------------------|:------------|:------------|:-------------|
| A $(k=4)$ | Circle&nbsp;â—‹         |        1.58 |        <font style="color:red">1.14</font> |         0.50 |
|           | Triangle&nbsp;â–³&nbsp; |        <font style="color:red">1.64</font> |        1.07 |         <font style="color:red">0.94</font> |
| B $(k=5)$ | Circle&nbsp;â—‹         |        1.56 |        1.08 |         0.80 |
|           | Triangle&nbsp;â–³&nbsp; |        <font style="color:red">1.86</font> |        <font style="color:red">1.09</font> |         <font style="color:red">0.88</font> |  

ìœ„ ë‘ ê°€ì§€ ê´€ì ìœ¼ë¡œ ê° ê±°ë¦¬ ì¸¡ì •ë²•ì„ í†µí•´ abnormal score ë¥¼ ê³„ì‚°í•´ ë³´ì•˜ì„ ë•Œ, max distance ëŠ” Case Aì™€ B ëª¨ë‘ <font style="color:red"> ì„¸ëª¨ â–³</font> ì— ëŒ€í•´ì„œ ë‘ ê´€ì ê³¼ ë‹¤ë¥´ê²Œ ë‚˜ì™”ê³ , average distance ëŠ” Case A ì— ëŒ€í•´ì„œëŠ” ë§ê²Œ íŒë‹¨í–ˆì§€ë§Œ Case B ì— ëŒ€í•´ì„œëŠ” ë‹¤ë¥´ê²Œ ë‚˜ì™”ë‹¤. ë˜í•œ ë‘ ê´€ì ìœ¼ë¡œ ë³´ì•˜ì„ ë•Œ mean distance ì—­ì‹œ Case A, B ëª¨ë‘ì— ëŒ€í•´ì„œ ì˜ëª» íŒë‹¨í•˜ê³  ìˆë‹¤.  

- ì¶”ê°€ì ì¸ ë³´ì • ë°©ì•ˆì´ í•„ìš”!

#### Consider additional factor

Convex hull ì´ë¼ëŠ” polygon ì„ ë§Œë“¤ì–´ì„œ ê·¸ polygon ê¹Œì§€ì˜ ê±°ë¦¬ë¥¼ ê³„ì‚°í•˜ì—¬ ì¶”ê°€ì ì¸ ë³´ì •ì„ ê°€í•¨ : 
$$
\begin{aligned}
\min_\mathbf{w}&\left(d_{c-hull}^k(\mathbf{x})\right)^2 = \left|\left|\mathbf{x}_{new}-\sum_{j=1}^k\mathbf{w}_iz_j(\mathbf{x})\right|\right|^2\\
s.t.&\sum_{i=1}^k\mathbf{w}_i=1,\quad \mathbf{w}_i\ge 0,\;\forall i.
\end{aligned}
$$
- LLE ì—ì„œ ì°¨ìš©í•œ ì•„ì´ë””ì–´ : 
	- ê°œë³„ì ì¸ ê°ì²´($\mathbf{x}_{new}$)ê°€ ì£¼ì–´ì ¸ ìˆê³ , ê° ê°ì²´ì˜ ì´ì›ƒ($z_j(\mathbf{x})$)ë“¤ì´ ì£¼ì–´ì ¸ ìˆì„ ë•Œ, ê° ê°ì²´ë¥¼ ì´ì›ƒë“¤ë¡œ ì¬êµ¬ì„± (reconstruct) í•˜ëŠ” $\mathbf{w}$ ë¥¼ ì°¾ëŠ” ê²ƒ
- ì•„ë˜ ê·¸ë¦¼ì„ ë³´ë©´ ì´ì›ƒë“¤ë¡œ êµ¬ì„±í•œ polygon ì•ˆì— ìˆìœ¼ë©´ convex hull ê¹Œì§€ì˜ distanceëŠ” 0ì´ ëœë‹¤. ë°˜ë©´ì— polygon ë°”ê¹¥ì— ìˆë‹¤ë©´ ê°€ì¥ ê°€ê¹Œìš´ ì„ ë¶„ì— ìˆ˜ì„ ì˜ ë°œì„ ë‚´ë ¸ì„ ë•Œ ê·¸ ê¸¸ì´ ë˜ëŠ” ê°€ì¥ ê°€ê¹Œìš´ ê¼­ì§“ì ê¹Œì§€ì˜ ê±°ë¦¬ê°€ convex hall distanceë‹¤. 

![[Pasted image 20240118165758.png|center]]

ë”°ë¼ì„œ average distance $d_{avg}^k$ ì— ì´ ê°œë…ì„ ì ìš©í•´ ë³´ì •í•´ì£¼ì í•˜ëŠ” ê²ƒì´ ëª©ì ì´ë‹¤. 

#### Combine the average distance and convex distance

- Average distance to the k-nearest neighbors $$d_{avg}^k=\frac{1}{k}\sum_{j=1}^k||\mathbf{x}-z_j(\mathbf{x})||$$
- Convex distance to its k-nearest neighbors $$d_{c-hull}^k=\left|\left|\mathbf{x}-\sum_{j=1}^k\mathbf{w}_iz_j(\mathbf{x})\right|\right|$$
- Put the penalty term using the convex distance for those instaces located outside the convex hull of its k-nearest neighbors 
$$d_{hybrid}^k=d_{avg}^k\times\left(\frac{2}{1+\exp(-d_{c-hull}^k)}\right)$$
- ì´ëŸ¬í•œ hybrid distance ëŠ” average distance ë¥¼ ê¸°ë³¸ìœ¼ë¡œ í•˜ì—¬, ë§Œì¼ convex hull ê¹Œì§€ì˜ ê±°ë¦¬ê°€ 0 (ì¦‰ ì´ì›ƒë“¤ì˜ polygon ì•ˆì— ìˆìœ¼ë©´)ì´ë©´ average distance ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•œë‹¤. ê·¸ë ‡ì§€ ì•Šê³  polygon ë°”ê¹¥ì— ìˆì–´ì„œ convex hull distance ê°€ 0ë³´ë‹¤ í¬ë‹¤ë©´ average distance ë¥¼ ì¦í­ì‹œí‚¤ëŠ” penalty term ì˜ íš¨ê³¼ë¥¼ ê°–ëŠ”ë‹¤. 


|             |                         |  $d_{max}^k$                                 |  $d_{avg}^k$                                 |  $d_{mean}^k$                                 | $d_{hybrid}^k$ |
|:------------|:------------------------|:---------------------------------------------|:---------------------------------------------|:----------------------------------------------|:---------------|
|  A $(k=4)$  |  Circle&nbsp;â—‹          |                                        1.58  |         <font style="color:red">1.14</font>  |                                         0.50  |           <font style="color:red">1.42</font> |
|             |  Triangle&nbsp;â–³&nbsp;  |         <font style="color:red">1.64</font>  |                                        1.07  |          <font style="color:red">0.94</font>  |           1.18 |
|  B $(k=5)$  |  Circle&nbsp;â—‹          |                                        1.56  |                                        1.08  |                                         0.80  |           <font style="color:red">1.18</font> |
|             |  Triangle&nbsp;â–³&nbsp;  |         <font style="color:red">1.86</font>  |         <font style="color:red">1.09</font>  |          <font style="color:red">0.88</font>  |           1.09 |  

- Hybrid distance ë¥¼ ì´ìš©í•˜ë©´ ì•ì„œ ì„¸ìš´ ë‘ ê°€ì§€ ê´€ì ì— ë”°ë¼ <font style="color:red">Circle</font> ì´ ë” í° abnormal scores ë¥¼ ê°–ê²Œëœë‹¤. 

![[Pasted image 20240118171711.png|center]]

ìœ„ ê·¸ë¦¼ì€ ì„ì˜ë¡œ ë§Œë“  í•˜ë‚˜ì˜ ë°ì´í„°ì…‹ì— ëŒ€í•´ ê° ê±°ë¦¬ ì¸¡ì • ë°©ë²•ë“¤ë¡œ abnormal scores ì„ ê³„ì‚°í•œ ë‹¤ìŒ ë™ì¼í•œ percentileë¡œ boundary ë¥¼ ë§Œë“  ê²ƒì´ë‹¤. (d) average distanceë¥¼ ë³´ë©´, ì™¼ìª½ ì¤‘ê°„ì— ë°€ë„ê°€ ë‚®ì•„ì„œ ì‘ì€ êµ¬ë©ì´ ìƒê¸°ëŠ” ë¬¸ì œê°€ ìƒê¸´ë‹¤. (e) mean distance ëŠ” ê° ë°€ë„ê°€ ë†’ì€ ê²ƒë“¤ ì¤‘ì•™ ë¶€ë¶„ì„ ì •ìƒì´ë¼ê³  ì˜ëª» íŒë‹¨í•˜ê³  ìˆë‹¤. ê·¸ì— ë°˜í•´ì„œ (f) hybrid distance ëŠ” average distance ê°€ ê°–ëŠ” (ë°€ë„ê°€ ë‚®ì€ ì˜ì—­ì— êµ¬ë©ì´ ëš¤ë¦¬ëŠ”) ë‹¨ì ê³¼, mean distance ê°€ ê°€ì§€ëŠ” (ë°€ë„ê°€ ë†’ì€ ì˜ì—­ë“¤ ì¤‘ê°„ ì˜ì—­ì„ ì •ìƒ ì˜ì—­ìœ¼ë¡œ íŒë‹¨í•˜ëŠ”) ë‹¨ì ë“¤ì„ ë³´ì™„í•˜ê³  ìˆë‹¤. 

#### Experiment : ê°•í•„ì„¤ êµìˆ˜ë‹˜

![[Pasted image 20240118172322.png|center]]

- Datasets : $TrN_n$ - training setì—ì„œ normal dataì˜ ìˆ˜, $TsN_n$ - test setì—ì„œ normal dataì˜ ìˆ˜, $TsN_o$ - test setì—ì„œ outlierì˜ ìˆ˜
	- ì´ 21 ê°€ì§€ ë°ì´í„°ì— ëŒ€í•´ì„œ 30íšŒ ë°˜ë³µ ì‹¤í—˜ì„ ì§„í–‰

- Performance in terms of the Integrated Error (IE) :

![[Pasted image 20240118172547.png|center]]

ì—¬ê¸°ê¹Œì§€ê°€ KNN ê¸°ë°˜ì˜ ì´ìƒì¹˜ íƒì§€ ë°©ë²•ì´ë‹¤. 

## ğŸ¯Clustering-based Approach

- êµ°ì§‘í™” ì•Œê³ ë¦¬ì¦˜ ì¤‘ì— ìì²´ì ìœ¼ë¡œ ì´ìƒ íƒì§€ê°€ ê°€ëŠ¥í•œ ê²ƒì´ ìˆëŠ”ë°, ë°”ë¡œ DBSCAN ì´ë‹¤. 
	- êµ°ì§‘ì— í• ë‹¹ë˜ì§€ ì•ŠëŠ” ê°ì²´ë“¤ì„ ëª¨ë‘ outlierë¡œ ê°„ì£¼
- êµ°ì§‘í™” ê¸°ë°˜ ì´ìƒ íƒì§€ ê¸°ë²•ì˜ ê¸°ë³¸ ì•„ì´ë””ì–´ëŠ” êµ°ì§‘í™”ë¥¼ í•˜ê³  ë‚˜ì„œ ê° êµ°ì§‘ìœ¼ë¡œë¶€í„°ì˜ ê±°ë¦¬ê°€ êµ‰ì¥íˆ ë¨¼ ê°ì²´ëŠ” ì´ìƒì¹˜ë¼ê³  íŒë³„í•˜ê² ë‹¤ëŠ” ê²ƒì´ë‹¤. 

#### K-Means clustering (KMC) - based anomaly detection

- ê°ì²´ì— ëŒ€í•œ anomaly score ëŠ” ê°€ì¥ ê°€ê¹Œìš´ centroid ì— ëŒ€í•œ ê±°ë¦¬ ì •ë³´ë¡œ ê³„ì‚°ë¨
- ì •ìƒ ë°ì´í„°ì— ëŒ€í•´ì„œ ì–´ë– í•œ ì‚¬ì „ì ì¸ í™•ë¥ ë¶„í¬ ê°€ì •ì„ í•˜ì§€ ì•ŠìŒ

$$
\begin{aligned}
&\mathcal{X} = C_1\cup C_2\cup \cdots \cup C_K,\quad C_i\cap C_j = \phi,\quad i\ne j.\\
&\arg\min_\mathbf{C}\sum_{i=1}^K\sum_{\mathbf{x}_j\in C_i}||\mathbf{x}_j-\mathbf{c}_i||^2
\end{aligned}
$$

![[Pasted image 20240118173957.png|center]]

- EM algorithm for KMC : 
	1) Select $K$ points as the initial centroids
	2) **repeat** : 
		3) Form $K$ clusters by assigning all points to the closest centroid
		4) Recompute the centroid of each cluster
	5) **until** The centroids don't change

#### Clustering-based approach

KMC ìœ¼ë¡œ êµ°ì§‘í™”ë¥¼ ì§„í–‰í•˜ê³  ë‚˜ì„œ ìƒˆë¡œìš´ ê°ì²´ì— ëŒ€í•´ì„œ abnormal scores ë¥¼ ê³„ì‚°í•˜ëŠ”ë° ìˆì–´ì„œ 2ê°€ì§€ ë°©ì‹ì´ ìˆë‹¤. ê°€ì¥ ê°€ê¹Œìš´ ì¤‘ì‹¬ (nearest centroid)ê¹Œì§€ì˜ 1) ì ˆëŒ€ ê±°ë¦¬(absolute distance)ì™€ 2) ìƒëŒ€ ê±°ë¦¬ (relative distance) ë°©ì‹ì´ë‹¤. 

![[Pasted image 20240118175218.png|center]]
![[Pasted image 20240118174815.png|center]]

KMC ë¥¼ í†µí•´ì„œ ìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ ë‘ ê°œì˜ êµ°ì§‘ì´ ìƒê²¼ë‹¤ê³  í•  ë•Œ, Aì™€ Bë¼ëŠ” í¬ì¸íŠ¸ì—ì„œ ê°€ì¥ ê°€ê¹Œìš´ centroid ê¹Œì§€ì˜ (ì ˆëŒ€)ê±°ë¦¬ê°€ ê°™ìœ¼ë¯€ë¡œ absolute distance ê´€ì ì—ì„œ A, B ì˜ abnormal score ëŠ” ê°™ì•„ì§„ë‹¤. ê° êµ°ì§‘ì˜ centroid ê°€ êµ°ì§‘ boundary ê¹Œì§€ì˜ ê±°ë¦¬ë¥¼ ê³ ë ¤í•œ relative distance ê´€ì ì—ì„œ Aì™€ Bì˜ abnormal scores ë¥¼ êµ¬í•´ë³´ì. ìš°ì„  A ì˜ anomaly scoreëŠ” $\frac{a_2}{a_1}$ (êµ°ì§‘ ì§€ë¦„ ëŒ€ë¹„ ì–¼ë§ˆë‚˜ ë–¨ì–´ì ¸ ìˆëŠ”ì§€) ì´ê³ , B ì˜ anomaly score ëŠ” $\frac{b_1}{b_2}$ ê°€ ë˜ë¯€ë¡œ B ê°€ ë” ë†’ì€ scoreë¥¼ ê°–ëŠ”ë‹¤. 

#### KMC-based anomaly score : Example

![[Pasted image 20240118175301.png|center]]

ìœ„ ê·¸ë¦¼ì€ scikit-learn ì—ì„œ ì œê³µí•˜ëŠ” ì˜ˆì‹œ ê·¸ë¦¼ì¸ë°, êµ°ì§‘ì—ì„œ ë©€ë¦¬ ë–¨ì–´ì ¸ ìˆëŠ” ê°ì²´ì¼ìˆ˜ë¡ anomaly score ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì›ì˜ ë°˜ì§€ë¦„ í¬ê¸°ê°€ ì»¤ì§€ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. 


## ğŸ¯Principal Component Analysis - based Anomaly Detection

#### PCA

- Purpose : maximize the variance after projection 
$$
\begin{aligned}
\max_\mathbf{w} \;&\mathbf{w}^T\mathbf{S}\mathbf{w}\\
s.t. \;&\mathbf{w}^T\mathbf{w}=1
\end{aligned}
$$
- Solution : 
$$
\begin{aligned}
L &= \mathbf{w}^T\mathbf{S}\mathbf{w} - \lambda(\mathbf{w}^T\mathbf{w} - 1)\\
\frac{\partial L}{\partial\mathbf{w}} &= 0 \Rightarrow \mathbf{S}\mathbf{w}-\lambda\mathbf{w}=0 \Rightarrow (\mathbf{S}-\lambda\mathbf{I})\mathbf{w}=0
\end{aligned}
$$

#### PCA as an anomaly detector

- Anomaly score : the amount of reconstruction loss from the projected space into the original space

![[Pasted image 20240118180217.png|center]]

- ê°€ì • : ì •ìƒ ë°ì´í„°ë¼ë©´ projection ì „ê³¼ recontruction í›„ê°€ ë¹„ìŠ·í•œ ê²ƒì´ê³ , ì´ìƒ ë°ì´í„°ë¼ë©´ ë°ì´í„°ê°€ ì• ì´ˆì— ë“¬ì„±ë“¬ì„± ì¡´ì¬í–ˆê¸° ë•Œë¬¸ì— projection ì„ í†µí•´ ê·¸ê²ƒì˜ íŒ¨í„´ì´ íŒŒì•…ë˜ì§€ ì•Šì•„ì„œ reconstruction í›„ ì •ìƒ ë°ì´í„°ì— ë¹„í•´ ì˜¤ì°¨ê°€ í¬ê²Œ ë‚˜íƒ€ë‚  ê²ƒì´ë‹¤.

- Compute the reconstruction loss : 
$$
\begin{aligned}
\text{error}(\mathbf{x}) &= ||\mathbf{x}-\mathbf{w}\mathbf{w}^T\mathbf{x}||^2 = (\mathbf{x}-\mathbf{w}\mathbf{w}^T\mathbf{x})^T(\mathbf{x}-\mathbf{w}\mathbf{w}^T\mathbf{x})\\
&= \mathbf{x}^T\mathbf{x} - \mathbf{x}^T\mathbf{w}\mathbf{w}^T\mathbf{x}-\mathbf{x}^T\mathbf{w}\mathbf{w}^T\mathbf{x} + \mathbf{x}^T\mathbf{w}\mathbf{w}^T\mathbf{w}\mathbf{w}^T\mathbf{x}\\
&= \mathbf{x}^T\mathbf{x}-\mathbf{x}^T\mathbf{w}\mathbf{w}^T\mathbf{x} = ||\mathbf{x}||^2-||\mathbf{w}^T\mathbf{x}||^2
\end{aligned}
$$

![[Pasted image 20240118180839.png|center]]
![[Pasted image 20240118181049.png|center]]

- Graphical interpretation 

![[Pasted image 20240118181309.png|center]]

ì™¼ìª½ ê·¸ë¦¼ì—ì„œ, 1ë²ˆ ë°ì´í„°ì— ëŒ€í•œ reconstruction error ëŠ” 2ë²ˆ ë°ì´í„°ì˜ ê²ƒë³´ë‹¤ í¬ë‹¤. ê·¸ë˜ì„œ anomaly scoreë¡œ ë³´ìë©´ 1ë²ˆì´ 2ë²ˆë³´ë‹¤ ì´ìƒì¹˜ì¼ ê°€ëŠ¥ì„±ì´ ë” ë†’ë‹¤.  

ì˜¤ë¥¸ìª½ ê·¸ë¦¼ì€ ë°˜ë‹¬ ëª¨ì–‘ì˜ ë°ì´í„°ë¥¼ í†µí•´ 1st ì£¼ì„±ë¶„ì„ ì°¾ìœ¼ë©´ ë¹¨ê°„ìƒ‰ ì„ ì´ ë  ê²ƒì´ê³ , ì´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë˜‘ê°™ì€ ê±°ë¦¬ë§Œí¼ í‰í–‰í•˜ê²Œ í™•ì¥í•˜ì—¬ threshold ë¥¼ ë§Œë“ ë‹¤ë©´ í„°ë„ í˜•íƒœì˜ boundary ê°€ ë§Œë“¤ì–´ì§€ê²Œ ëœë‹¤. 