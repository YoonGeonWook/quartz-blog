---
sticker: emoji//1f525
---
Global methodsëŠ” ML ëª¨ë¸ì—ì„œ í‰ê· ì ì¸ ë™ìž‘ì„ ì„¤ëª…í•©ë‹ˆë‹¤. ì´ì— ëŒ€ì‘í•˜ëŠ” ê²ƒì´ Local methodsìž…ë‹ˆë‹¤. Global methodsëŠ” ë°ì´í„° ë¶„í¬ì— ë”°ë¥¸ ê¸°ëŒ€ê°’ìœ¼ë¡œ ë³´í†µ í‘œí˜„ë©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ feature effect plot ì¸ PDPëŠ” ë‹¤ë¥¸ ëª¨ë“  í”¼ì³ë“¤ì„ ì œì™¸í–ˆì„ ë•Œ ê¸°ëŒ€ë˜ëŠ” ì˜ˆì¸¡ì¹˜ìž…ë‹ˆë‹¤. Global methodsëŠ” í‰ê· ì ì¸ ë™ìž‘ì„ ì„¤ëª…í•˜ê¸° ë•Œë¬¸ì— ëª¨ë¸ ìž‘ì„±ìžê°€ ë°ì´í„°ì˜ ì¼ë°˜ì ì¸ ë©”ì»¤ë‹ˆì¦˜ì„ ì´í•´í•˜ê±°ë‚˜ ëª¨ë¸ì„ ë””ë²„ê¹…í•  ë•Œ ìœ ìš©í•©ë‹ˆë‹¤. 

ì´ ì±…ì—ì„œëŠ” ì•„ëž˜ì™€ ê°™ì€ model-agnostic global í•´ì„ ê¸°ë²•ë“¤ì„ ë‹¤ë£¹ë‹ˆë‹¤ : 
- **Partial dependence plot; pdp**ëŠ” feature effect method ìž…ë‹ˆë‹¤
- **Accumulated local effect plots** ëŠ” í”¼ì³ê°€ ì¢…ì†ì ì¼ ë•Œ ìž‘ë™í•˜ëŠ” ë˜ ë‹¤ë¥¸ feature effect method ìž…ë‹ˆë‹¤
- **Feature interaction (H-statistic)** ì€ ì˜ˆì¸¡ì¹˜ê°€ í”¼ì³ë“¤ì˜ joint effect ë¡œ ì¸í•œ ê²°ê³¼ìž„ì„ ì •ëŸ‰í™”í•©ë‹ˆë‹¤. 
- **Functional decomposition**ì€ interpretabilityì˜ í•µì‹¬ ê°œë…ìœ¼ë¡œ, ë³µìž¡í•œ ì˜ˆì¸¡ í•¨ìˆ˜ë¥¼ ë” ìž‘ì€ ë¶€ë¶„ìœ¼ë¡œ ë¶„í•´í•˜ëŠ” ê¸°ë²•ìž…ë‹ˆë‹¤. 
- **Permutation feature importance**ëŠ” í”¼ì³ê°€ ë’¤ì„žì¼ ë•Œ ì†ì‹¤(loss)ì˜ ì¦ê°€ë¡œ ë³€ìˆ˜ ì¤‘ìš”ë„ë¥¼ ì¸¡ì •í•©ë‹ˆë‹¤. 
- **Global surrogate models**ëŠ” í•´ì„ì„ ìœ„í•´ ê¸°ì¡´ ëª¨ë¸ì„ ë” ê°„ë‹¨í•œ ëª¨ë¸ë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤. 
- **Prototypes and criticisms**ëŠ” ì–´ë– í•œ ë¶„í¬ì˜ ëŒ€í‘œì„±ìžˆëŠ” ë°ì´í„° í¬ì¸íŠ¸ì´ë©° í•´ì„ ê°€ëŠ¥ì„±ì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 

# ðŸ“• 08-01. Partial Dependence Plot (PDP)
&#9495; ë¶€ë¶„ ì˜ì¡´ë„ í”Œë¡¯
---
PDP ë˜ëŠ” PD plotì€ í•˜ë‚˜ ë˜ëŠ” ë‘ ê°œì˜ í”¼ì³ê°€ ML ëª¨ë¸ ì˜ˆì¸¡ì¹˜ì— ë¯¸ì¹˜ëŠ” ì£¼ë³€ íš¨ê³¼(marginal effect)ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤. PDPëŠ” targetê³¼ features ê°„ ê´€ê³„ê°€ ì„ í˜•ì¸ì§€, ë‹¨ì¡°ë¡œìš´ì§€ ë˜ëŠ” ë³µìž¡í•œì§€ë¥¼ ë³´ì—¬ì¤„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì„ í˜• íšŒê·€ ëª¨ë¸ì—ì„œ PDPëŠ” í•­ìƒ ì„ í˜• ê´€ê³„ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤. 

Regressionì— ëŒ€í•œ PD functionì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤ : 
$$
\hat{f}_S\left(x_S\right)=E_{X_C}\left[\hat{f}\left(x_S, X_C\right)\right]=\int \hat{f}\left(x_S, X_C\right) d \mathbb{P}\left(X_C\right)
$$
ì—¬ê¸°ì„œ $x_S$ëŠ” PDPë¥¼ ê·¸ë ¤ì•¼ í•˜ëŠ” í”¼ì³ì´ê³ , $X_C$ëŠ” ML ëª¨ë¸ $\hat{f}$ì—ì„œ ì‚¬ìš©ë˜ëŠ” ë‹¤ë¥¸ í”¼ì³ë“¤ì´ë©°, í™•ë¥ ë³€ìˆ˜ë¡œ ì·¨ê¸‰ë©ë‹ˆë‹¤. ë³´í†µ ì§‘í•© $S$ ì—ëŠ” í•˜ë‚˜ ë˜ëŠ” ë‘ ê°œì˜ í”¼ì³ê°€ ì¡´ìž¬í•©ë‹ˆë‹¤. $S$ ì— ìžˆëŠ” í”¼ì³ë“¤ì€ ì˜ˆì¸¡ì¹˜ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ ì•Œê³ ìž í•˜ëŠ” í”¼ì³ë“¤ìž…ë‹ˆë‹¤. í”¼ì³ ë²¡í„° $x_S$ì™€ $x_C$ë¥¼ í•©í•˜ë©´ ì „ì²´ í”¼ì³ ê³µê°„ $x$ ê°€ ë©ë‹ˆë‹¤. PDëŠ” ì§‘í•© $C$ ì˜ í”¼ì³ ë¶„í¬ì— ëŒ€í•´ ML model outputì„ ì£¼ë³€í™”(marginalize)í•˜ì—¬ ê´€ì‹¬ ìžˆëŠ” ì§‘í•© $S$ ì˜ í”¼ì³ì™€ ì˜ˆì¸¡ëœ ê²°ê³¼ ì‚¬ì´ì˜ ê´€ê³„ë¥¼ í‘œì‹œí•˜ë„ë¡ ìž‘ë™í•©ë‹ˆë‹¤. ë‹¤ë¥¸ í”¼ì³ë“¤ì„ ì´ìš©í•´ ì£¼ë³€í™”í•˜ë©´ ë‹¤ë¥¸ í”¼ì³ë“¤ê³¼ì˜ ìƒí˜¸ìž‘ìš©ì„ í¬í•¨í•˜ì—¬ $S$ ì˜ í”¼ì³ì—ë§Œ ì˜ì¡´í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì–»ì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 

Partial function $\hat{f}_S$ëŠ” í•™ìŠµ ë°ì´í„°ì˜ í‰ê· ì„ ëª¬í…Œì¹´ë¥¼ë¡œ ë°©ë²•ìœ¼ë¡œ ì¶”ì •í•©ë‹ˆë‹¤ : 
$$
\hat{f}_S\left(x_S\right)=\frac{1}{n} \sum_{i=1}^n \hat{f}\left(x_S, x_C^{(i)}\right)
$$
ì´ partial functionì€ ì£¼ì–´ì§„ í”¼ì³ ì§‘í•© $S$ ì˜ ê°’ì— ëŒ€í•´ ì˜ˆì¸¡ì¹˜ì˜ í‰ê·  ì£¼ë³€ íš¨ê³¼(average marginal effect)ë¥¼ ì•Œë ¤ì¤ë‹ˆë‹¤. ìœ„ ê³µì‹ì—ì„œ $x_C^{(i)}$ëŠ” ìš°ë¦¬ê°€ ê´€ì‹¬ ë‘ì§€ ì•ŠëŠ” í”¼ì³ì— ëŒ€í•œ ë°ì´í„°ì…‹ì˜ ì‹¤ì œ í”¼ì³ê°’ì´ê³ , $n$ëŠ” ì¸ìŠ¤í„´ìŠ¤ ìˆ˜ìž…ë‹ˆë‹¤. PDPëŠ” $C$ ì˜ í”¼ì³ê°€ $S$ ì˜ í”¼ì³ì™€ ìƒê´€ê´€ê³„ê°€ ì—†ë‹¤ëŠ” ê°€ì •ì„ í•©ë‹ˆë‹¤. ì´ ê°€ì •ì„ ìœ„ë°˜í•˜ë©´ PDPë¡œ ê³„ì‚°ëœ í‰ê· ì´ ë¬´ì˜ë¯¸ í•´ì§‘ë‹ˆë‹¤. 

í´ëž˜ìŠ¤ í™•ë¥ ì„ ì¶œë ¥í•˜ëŠ” ë¶„ë¥˜ ë¬¸ì œì˜ ê²½ìš°, PDPëŠ” $S$ ì˜ í”¼ì³ì— ëŒ€í•´ ì„œë¡œ ë‹¤ë¥¸ ê°’ì´ ì£¼ì–´ì¡Œì„ ë•Œ íŠ¹ì • í´ëž˜ìŠ¤ì— ëŒ€í•œ í™•ë¥ ì„ í‘œì‹œí•©ë‹ˆë‹¤. ì—¬ëŸ¬ í´ëž˜ìŠ¤ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì‰¬ìš´ ë°©ë²•ì€ í´ëž˜ìŠ¤ë‹¹ í•˜ë‚˜ì˜ ì„ ì„ ê·¸ë¦¬ëŠ” ê²ƒìž…ë‹ˆë‹¤. 

PDPëŠ” global method ìž…ë‹ˆë‹¤ : ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê³ ë ¤í•˜ê³  í”¼ì³ì™€ ì˜ˆì¸¡ì¹˜ì˜ global relationshipì— ëŒ€í•œ ì„¤ëª…ì„ ì œê³µí•˜ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤. 

#### Categorical features

ì§€ê¸ˆê¹Œì§€ëŠ” ìˆ«ìží˜• í”¼ì³ë§Œì„ ê³ ë ¤í–ˆìŠµë‹ˆë‹¤. ë²”ì£¼í˜• í”¼ì³ë„ PDPë¥¼ ê³„ì‚°í•˜ê¸° ì‰½ìŠµë‹ˆë‹¤. ê° ë²”ì£¼/ìˆ˜ì¤€ì— ëŒ€í•´ ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ê°€ ë™ì¼í•œ ìˆ˜ì¤€ì„ ê°–ë„ë¡ ê°•ì œí•˜ì—¬ PDP ì¶”ì •ì¹˜ë¥¼ ì–»ìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ìžì „ê±° ëŒ€ì—¬ ë°ì´í„°ì…‹ì„ ë³´ê³  ê³„ì ˆ(`season`)ì— ëŒ€í•œ PDPê°€ ê¶ê¸ˆí•˜ë‹¤ë©´ ê° ê³„ì ˆì— ëŒ€í•´ í•˜ë‚˜ì”© 4ê°œì˜ ê°’ì„ ì–»ì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. "ì—¬ë¦„"ì— ëŒ€í•œ ê°’ì„ ê³„ì‚°í•˜ë ¤ë©´ ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ì˜ ê³„ì ˆì„ "ì—¬ë¦„"ìœ¼ë¡œ ë°”ê¾¸ê³  ì˜ˆì¸¡ì¹˜ì˜ í‰ê· ì„ êµ¬í•˜ë©´ ë©ë‹ˆë‹¤. 

## 1. PDP-based Feature importance

Greenwell et al (2018)ì€ ê°„ë‹¨í•œ PD-based feature importance ì¸¡ì •ë²•ì„ ì œì•ˆí–ˆìŠµë‹ˆë‹¤. ì•„ì´ë””ì–´ëŠ” PDPê°€ í‰í‰í•˜ë©´ í”¼ì³ê°€ ì¤‘ìš”í•˜ì§€ ì•ŠìŒì„ ì˜ë¯¸í•˜ê³ , PDPê°€ ë‹¤ì±„ë¡œìš¸ìˆ˜ë¡ ì¤‘ìš”í•¨ì„ ì˜ë¯¸í•œë‹¤ëŠ” ê²ƒìž…ë‹ˆë‹¤. ìˆ«ìží˜• í”¼ì³ì˜ ê²½ìš° ì¤‘ìš”ë„ëŠ” ê° í”¼ì³ì˜ unique valueì˜ í‰ê·  ê³¡ì„ ìœ¼ë¡œë¶€í„°ì˜ (í‘œì¤€) íŽ¸ì°¨ë¡œ ì •ì˜ë©ë‹ˆë‹¤ : 
$$
I\left(x_S\right)=\sqrt{\frac{1}{K-1} \sum_{k=1}^K\left(\hat{f}_S\left(x_S^{(k)}\right)-\frac{1}{K} \sum_{k=1}^K \hat{f}_S\left(x_S^{(k)}\right)\right)^2}
$$
ì—¬ê¸°ì„œ $x_S^{(k)}$ëŠ” í”¼ì³ $X_S$ì˜ $K$ê°œ unique values ìž…ë‹ˆë‹¤. ë²”ì£¼í˜• í”¼ì³ëŠ” ì•„ëž˜ì™€ ê°™ìŠµë‹ˆë‹¤ : 
$$
I\left(x_S\right)=\left(\max _k\left(\hat{f}_S\left(x_S^{(k)}\right)\right)-\min _k\left(\hat{f}_S\left(x_S^{(k)}\right)\right)\right) / 4
$$
ì´ê²ƒì€ ìœ ë‹ˆí¬í•œ ë²”ì£¼ë“¤ì— ëŒ€í•´ì„œ PDP ê°’ì˜ ë²”ìœ„ë¥¼ 4ë¡œ ë‚˜ëˆˆ ê²ƒìž…ë‹ˆë‹¤. ì´ íŽ¸ì°¨ ê³„ì‚° ë°©ë²•ì„ range rule ì´ë¼ê³  í•©ë‹ˆë‹¤. ë²”ìœ„(range)ë§Œ ì•Œê³  ìžˆì„ ë•Œ íŽ¸ì°¨ì˜ ëŒ€ëžµì ì¸ ì¶”ì •ì¹˜ë¥¼ ì–»ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤. ë¶„ëª¨ 4ëŠ” í‘œì¤€ ì •ê·œë¶„í¬ì—ì„œ 95%ì˜ ë°ì´í„°ê°€ +/- 2ì˜ í‘œì¤€íŽ¸ì°¨ì—ì„œ ë‚˜ì˜¤ëŠ” ê²ƒì—ì„œ ë”°ì˜¨ ê²ƒìž…ë‹ˆë‹¤. ë”°ë¼ì„œ ì´ ë²”ìœ„ë¥¼ 4ë¡œ ë‚˜ëˆˆ ê²ƒì€ ì‹¤ì œ íŽ¸ì°¨ë¥¼ ê³¼ì†Œ í‰ê°€í•˜ëŠ” rough í•œ ì¶”ì •ì¹˜ ì–»ê²Œ í•˜ê¸° ìœ„í•¨ìž…ë‹ˆë‹¤. 

ì´ëŸ¬í•œ PDP ê¸°ë°˜ ë³€ìˆ˜ ì¤‘ìš”ë„ëŠ” ì‹ ì¤‘í•˜ê²Œ í•´ì„í•´ì•¼ í•©ë‹ˆë‹¤. ì´ëŠ” í”¼ì³ì˜ ì£¼íš¨ê³¼(main effect)ë§Œ í¬ì°©í•˜ê³  í”¼ì³ê°„ ìƒí˜¸ìž‘ìš© íš¨ê³¼ëŠ” ë¬´ì‹œí•©ë‹ˆë‹¤. Permutataion feature importance ì™€ ê°™ì€ ë‹¤ë¥¸ ë°©ë²•ì—ì„œëŠ” ì–´ë–¤ í”¼ì³ê°€ ë§¤ìš° ì¤‘ìš”í•  ìˆ˜ ìžˆì§€ë§Œ PDP ì—ì„œëŠ” ê·¸ í”¼ì³ê°€ ë‹¤ë¥¸ í”¼ì³ë“¤ê³¼ì˜ ìƒí˜¸ìž‘ìš©ìœ¼ë¡œ ì¸í•´ ì˜ˆì¸¡ì¹˜ì— ì˜í–¥ì„ ì£¼ê¸° ë•Œë¬¸ì— í‰í‰í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. PDP ê¸°ë°˜ ë³€ìˆ˜ ì¤‘ìš”ë„ì˜ ë˜ ë‹¤ë¥¸ ë‹¨ì ì€ ë³€ìˆ˜ì˜ unique values ì— ì˜í•´ ì •ì˜ëœë‹¤ëŠ” ì ìž…ë‹ˆë‹¤. ì´ëŠ” unique values ì˜ ë¶„í¬ëŠ” ë¬´ì‹œë˜ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤. 

## 2. Example

í•œ ê°œì˜ í”¼ì³ëŠ” 2D plotì„ ë§Œë“¤ê³ , 2ê°œë©´ 3D plotì„ ë§Œë“¤ê¸° ë•Œë¬¸ì— ì‹¤ì œë¡œ í”¼ì³ ì§‘í•© $S$ ì—ëŠ” ë³´í†µ í•˜ë‚˜ ë˜ëŠ” ìµœëŒ€ ë‘ ê°œì˜ í”¼ì³ë§Œ í¬í•¨ë©ë‹ˆë‹¤. ê·¸ ì´ìƒì€ ë§¤ìš° ê¹Œë‹¤ë¡­ìŠµë‹ˆë‹¤. 

ì£¼ì–´ì§„ ë‚ ì§œì— ìžì „ê±° ëŒ€ì—¬ ìˆ˜ë¥¼ ì˜ˆì¸¡í•˜ëŠ” íšŒê·€ ë¬¸ì œë¥¼ ë‹¤ì‹œ ë³´ê² ìŠµë‹ˆë‹¤. ë¨¼ì € ML ëª¨ë¸ì„ fittingí•œ ë‹¤ìŒ, PDë¥¼ ë¶„ì„í•©ë‹ˆë‹¤. ì´ ì˜ˆì œì—ì„œëŠ” ëŒ€ì—¬ ìˆ˜ë¥¼ ì˜ˆì¸¡í•˜ê¸° ìœ„í•´ random forest ë¥¼ ì í•©í•˜ê³  PDPë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì´ í•™ìŠµí•œ ê´€ê³„ë¥¼ ì‹œê°í™” í–ˆìŠµë‹ˆë‹¤. ë‚ ì”¨ í”¼ì³ê°€ ì˜ˆì¸¡ ëŒ€ì—¬ ìˆ˜ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ ì•„ëž˜ ê·¸ë¦¼ì— ì‹œê°í™” í–ˆìŠµë‹ˆë‹¤ : 

![](Pasted%20image%2020240101214109.png) Figure 8.1 : ìžì „ê±° ëŒ€ì—¬ ìˆ˜ ì˜ˆì¸¡ ëª¨ë¸ì—ì„œ `temp`, `hum`, `windspeed`ì— ëŒ€í•œ PDP. ì˜¨ë„ì—ì„œ ê°€ìž¥ í° ì°¨ì´ë¥¼ ë³¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ê¸°ì˜¨ì´ ë†’ì„ìˆ˜ë¡ ëŒ€ì—¬ ìˆ˜ê°€ ë§Žì•„ì§‘ë‹ˆë‹¤. ì´ ì¶”ì„¸ëŠ” ì„­ì”¨ 20ë„ê¹Œì§€ ì´ì–´ì§€ë‹¤ê°€ 30ë„ë¶€í„°ëŠ” í‰í‰í•´ì§€ê³  ì•½ê°„ ê°ì†Œí•©ë‹ˆë‹¤. Xì¶•ì˜ í‘œì‹œëŠ” ë°ì´í„°ì˜ ë¶„í¬ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. 

ë”°ëœ»í•˜ì§€ë§Œ ë„ˆë¬´ ë¥ì§€ ì•Šì€ ë‚ ì”¨ì˜ ê²½ìš° ì´ ëª¨ë¸ì€ í‰ê· ì ìœ¼ë¡œ ìžì „ê±° ëŒ€ì—¬ ê±´ìˆ˜ê°€ ë§Žì„ ê²ƒìœ¼ë¡œ ì˜ˆì¸¡ë©ë‹ˆë‹¤. ìŠµë„(`hum`)ê°€ 60%ë¥¼ ì´ˆê³¼í•˜ë©´ ì´ìš©ìžë“¤ì€ ìžì „ê±° ëŒ€ì—¬ë¥¼ êº¼ë¦¬ê²Œ ë©ë‹ˆë‹¤. ë˜í•œ ë°”ëžŒì´ ë§Žì´ ë¶ˆìˆ˜ë¡ ìžì „ê±°ë¥¼ íƒ€ëŠ” ì‚¬ëžŒì´ ì¤„ì–´ë“œëŠ” ê²ƒë„ ë‹¹ì—°í•œ ê²°ê³¼ìž…ë‹ˆë‹¤. í¥ë¯¸ë¡­ê²Œë„ í’ì†ì´ 25km/h ì—ì„œ 35km/h ë¡œ ì¦ê°€í•´ë„ ì˜ˆì¸¡ëœ ìžì „ê±° ëŒ€ì—¬ ê±´ìˆ˜ëŠ” ê°ì†Œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ëŠ” í•™ìŠµ ë°ì´í„°ê°€ ë§Žì§€ ì•Šì•„ì„œ ML ëª¨ë¸ì´ ì´ ë²”ìœ„ì— ëŒ€í•œ ì˜ë¯¸ ìžˆëŠ” í•™ìŠµì„ í•˜ì§€ ëª»í–ˆì„ ê°€ëŠ¥ì„±ì´ ìžˆìŠµë‹ˆë‹¤. ì ì–´ë„ ì§ê´€ìœ¼ë¡œëŠ” í’ì†ì´ ë§¤ìš° ë†’ìœ¼ë©´ ëŒ€ì—¬ ìˆ˜ê°€ ê°ì†Œí•  ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤. 

ë²”ì£¼í˜• í”¼ì³ì— ëŒ€í•œ PDPë¥¼ ì„¤ëª…í•˜ê¸° ìœ„í•´ `season` í”¼ì³ê°€ ì˜ˆì¸¡ ëŒ€ì—¬ ìˆ˜ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ ì‚´íŽ´ë³´ê² ìŠµë‹ˆë‹¤ : 

![](Pasted%20image%2020240101214250.png)Figure 8.2 : ëŒ€ì—¬ ìˆ˜ ì˜ˆì¸¡ ëª¨ë¸ê³¼ `season`ì— ëŒ€í•œ PDP. ì˜ˆìƒì™¸ë¡œ ëª¨ë“  ê³„ì ˆì—ì„œ ì˜ˆì¸¡ì¹˜ê°€ ë¹„ìŠ·í•œ ì˜í–¥ì„ ë³´ì´ê³  ìžˆê³ , ê²¨ìš¸ì—ë§Œ ëŒ€ì—¬ ê±´ìˆ˜ê°€ ì•½ê°„ ì ê²Œ ì˜ˆì¸¡ë©ë‹ˆë‹¤. 

ìžê¶ê²½ë¶€ì•” ë¶„ë¥˜ ë¬¸ì œì— ëŒ€í•´ì„œë„ PDPë¥¼ ê³„ì‚°í•´ ë³´ê² ìŠµë‹ˆë‹¤. ì´ë²ˆì—ëŠ” Random Forestë¥¼ ì ìš©í•´ ìœ„í—˜ ìš”ì¸ì— ë”°ë¼ ì—¬ì„±ì˜ ìžê¶ ê²½ë¶€ì•” ë°œë³‘ ì—¬ë¶€ë¥¼ ì˜ˆì¸¡í•˜ê² ìŠµë‹ˆë‹¤. Random Forestì— ì—¬ëŸ¬ í”¼ì³ì— ëŒ€í•œ ì•” í™•ë¥ ì˜ PDë¥¼ ê³„ì‚°í•˜ê³  ì‹œê°í™”í–ˆìŠµë‹ˆë‹¤ : 

![](Pasted%20image%2020240101215649.png) Figure 8.3 : ë‚˜ì´ì™€ í˜¸ë¥´ëª¬ í”¼ìž„ì•½ ë³µìš© ê¸°ê°„ì— ë”°ë¥¸ ì•” ë°œìƒ í™•ë¥ ì˜ PDP. ë‚˜ì´ì˜ PDPëŠ” 40ì„¸ê¹Œì§€ëŠ” í™•ë¥ ì´ ë‚®ê³  ê·¸ ì´í›„ì—ëŠ” ì¦ê°€í•¨ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. í˜¸ë¥´ëª¬ í”¼ìž„ì•½ì„ ë³µìš©í•œ ê¸°ê°„ì´ ê¸¸ìˆ˜ë¡, íŠ¹ížˆ 10ë…„ì´ ë„˜ì–´ê°€ë©´ ì•” ë°œìƒ ìœ„í—˜ì´ ë†’ì•„ì§‘ë‹ˆë‹¤. ë‘ í”¼ì³ ëª¨ë‘ í° ê°’ì„ ê°–ëŠ” ë°ì´í„° í¬ì¸íŠ¸ê°€ ë§Žì§€ ì•Šì•„ì„œ ë†’ì€ ê°’ì— ëŒ€í•œ PD ì¶”ì •ì¹˜ì˜ ì‹ ë¢°ë„ê°€ ë‚®ìŠµë‹ˆë‹¤.

ë˜í•œ ë‘ ê°œì˜ í”¼ì³ì— ëŒ€í•œ PDPë¥¼ í•œ ë²ˆì— ì‹œê°í™” í•  ìˆ˜ë„ ìžˆìŠµë‹ˆë‹¤ :

![](Pasted%20image%2020240101220250.png) Figure 8.4 : ì•” ë°œìƒ í™•ë¥ ì˜ PDPì™€ ì—°ë ¹ ë° ìž„ì‹  íšŸìˆ˜ì˜ ìƒí˜¸ìž‘ìš©ìž…ë‹ˆë‹¤. 45ì„¸ì—ì„œ ì•” í™•ë¥ ì´ ì¦ê°€í•¨ì„ ë³¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 25ì„¸ ë¯¸ë§Œì¸ ê²½ìš°, ìž„ì‹  íšŸìˆ˜ê°€ 1~2íšŒì¸ ì—¬ì„±ì€ 0íšŒ ë˜ëŠ” 2íšŒ ì´ìƒì¸ ì—¬ì„±ì˜ ë¹„í•´ ì•” ë°œìƒ ìœ„í—˜ì´ ë‚®ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ê²°ë¡ ì„ ë‚´ë¦´ ë•Œ ì£¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤ : ì´ëŠ” ì¸ê³¼ê´€ê³„ê°€ ì•„ë‹Œ ìƒê´€ê´€ê³„ ìž…ë‹ˆë‹¤!

## 3. Advantages

PDP ì˜ ê³„ì‚°ì€ ì§ê´€ì ìž…ë‹ˆë‹¤ : íŠ¹ì •í•œ í”¼ì³ì— ëŒ€í•œ PD í•¨ìˆ˜ëŠ” ëª¨ë“  ë°ì´í„° í¬ì¸íŠ¸ë¥¼ í•´ë‹¹ í”¼ì³ê°’ìœ¼ë¡œ ê°€ì •í•  ê²½ìš°ì˜ í‰ê·  ì˜ˆì¸¡ì¹˜ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. 

PDPë¥¼ ê³„ì‚°í•œ í”¼ì³ê°€ ë‹¤ë¥¸ í”¼ì³ì™€ ìƒê´€ê´€ê³„ê°€ ì—†ëŠ” ê²½ìš°, PDPëŠ” í”¼ì³ê°€ í‰ê· ì ìœ¼ë¡œ ì˜ˆì¸¡ì¹˜ì— ì–´ë–¤ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ”ì§€ ì™„ë²½í•˜ê²Œ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ìƒê´€ê´€ê³„ê°€ ì—†ëŠ” ê²½ìš°ì—ëŠ” í•´ì„ì´ ëª…í™•í•©ë‹ˆë‹¤. PDPëŠ” $j$ ë²ˆì§¸ í”¼ì³ê°€ ë³€ê²½ë  ë•Œ ë°ì´í„°ì…‹ì˜ í‰ê·  ì˜ˆì¸¡ì¹˜ê°€ ì–´ë–»ê²Œ ë³€í•˜ëŠ”ì§€ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤. í•˜ì§€ë§Œ ìƒê´€ê´€ê³„ê°€ ìžˆëŠ” ê²½ìš° ë‹¨ì ì´ ìžˆìŠµë‹ˆë‹¤. 

êµ¬í˜„ì´ ì‰½ìŠµë‹ˆë‹¤. 

PDPì— ëŒ€í•œ ê³„ì‚°ì€ ì¸ê³¼ ê´€ê³„ë¡œ í•´ì„ë©ë‹ˆë‹¤. í”¼ì³ì— ê°œìž…í•˜ì—¬ ì˜ˆì¸¡ì¹˜ì˜ ë³€í™”ë¥¼ ì¸¡ì •í•˜ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤. ì´ ê³¼ì •ì—ì„œ í”¼ì³ì™€ ì˜ˆì¸¡ì¹˜ ê°„ì˜ ì¸ê³¼ê´€ê³„ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤. ì´ ê´€ê³„ëŠ” outcome ì„ í”¼ì³ì˜ í•¨ìˆ˜ë¡œ ëª…í™•ížˆ ëª¨ë¸ë§í•˜ê¸° ë•Œë¬¸ì— ëª¨ë¸ì—ì„œëŠ” ì¸ê³¼ê´€ê³„ì´ì§€ë§Œ ì‹¤ì œ ì„¸ê³„ì—ì„œëŠ” ì¸ê³¼ê´€ê³„ê°€ ì•„ë‹ ìˆ˜ ìžˆìŠµë‹ˆë‹¤!

## 4. Disadvantages

PD í•¨ìˆ˜ì˜ í˜„ì‹¤ì ì¸ ìµœëŒ€ í”¼ì³ ìˆ˜ëŠ” 2ê°œìž…ë‹ˆë‹¤. ì´ëŠ” PDPì˜ ê²°í•¨ì´ ì•„ë‹ˆë¼ 3ì°¨ì› ì´ìƒì„ ìƒìƒí•˜ì§€ ëª»í•˜ëŠ” ìš°ë¦¬ì˜ ë¬´ëŠ¥ ë•Œë¬¸ìž…ë‹ˆë‹¤. 

ì¼ë¶€ PDPì—ëŠ” í”¼ì³ì˜ ë¶„í¬ê°€ í‘œì‹œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë¶„í¬ë¥¼ ìƒëžµí•˜ë©´ ë°ì´í„°ê°€ ê±°ì˜ ì—†ëŠ” ì˜ì—­ì„ ê³¼ë„í•˜ê²Œ í•´ì„í•˜ê²Œ ë˜ê¸° ë•Œë¬¸ì— ì˜¤í•´ì˜ ì†Œì§€ê°€ ìžˆìŠµë‹ˆë‹¤. ì´ ë¬¸ì œëŠ” `rug` (X ì¶•ì˜ ë°ì´í„° í¬ì¸íŠ¸ì— ëŒ€í•œ bool ì˜µì…˜) ë˜ëŠ” ížˆìŠ¤í† ê·¸ëž¨ì„ í‘œì‹œí•˜ë©´ ì‰½ê²Œ í•´ê²° ê°€ëŠ¥í•©ë‹ˆë‹¤. 

í”¼ì³ ê°„ì˜ ë…ë¦½ì„± ê°€ì •ì€ PDPì˜ ê°€ìž¥ í° ë¬¸ì œì ìž…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ëª¸ë¬´ê²Œì™€ í‚¤ê°€ ì£¼ì–´ì¡Œì„ ë•Œ ì–¼ë§ˆë‚˜ ë¹¨ë¦¬ ê±·ëŠ”ì§€ ì˜ˆì¸¡í•˜ë„ ì‹¶ë‹¤ê³  í•´ë³´ê² ìŠµë‹ˆë‹¤. í‚¤ì™€ ê°™ì€ í”¼ì³ ì¤‘ í•˜ë‚˜ì˜ PDë¥¼ ê³„ì‚°í•  ë•Œ ë‹¤ë¥¸ í”¼ì³(ì²´ì¤‘)ëŠ” í‚¤ì™€ ìƒê´€ê´€ê³„ê°€ ì—†ë‹¤ê³  ê°€ì •í•´ì•¼í•˜ëŠ”ë°, ì´ëŠ” ëª…ë°±ížˆ ìž˜ëª»ëœ ê°€ì •ìž…ë‹ˆë‹¤. íŠ¹ì • í‚¤(ì˜ˆ: 200cm)ì—ì„œ PDPë¥¼ ê³„ì‚°í•˜ê¸° ìœ„í•´ì„  ì²´ì¤‘ì˜ ì£¼ë³€ ë¶„í¬ë¥¼ í‰ê· í™”í•˜ëŠ”ë°, ì—¬ê¸°ì—ëŠ” 2mì¸ ì‚¬ëžŒì—ê²ŒëŠ” ë¹„í˜„ì‹¤ì ì¸ 50kg ë¯¸ë§Œì˜ ì²´ì¤‘ì´ í¬í•¨ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì¦‰ í”¼ì³ê°„ ìƒê´€ê´€ê³„ê°€ ìžˆëŠ” ê²½ìš°, ì‹¤ì œ í™•ë¥ ì´ ë§¤ìš° ë‚®ì€ í”¼ì³ì˜ ë¶„í¬ì— ìƒˆë¡œìš´ ë°ì´í„° í¬ì¸íŠ¸ë¥¼ ìƒì„±í•˜ê²Œ ë©ë‹ˆë‹¤. ì´ ë¬¸ì œì˜ í•´ê²°ì±…ì€ ì£¼ë³€ ë¶„í¬ ëŒ€ì‹  ì¡°ê±´ë¶€ ë¶„í¬ë¡œ ìž‘ë™í•˜ëŠ” **Accumulated Local Effect plots** ë˜ëŠ” **short ALE plots** ìž…ë‹ˆë‹¤. 

PDPëŠ” í‰ê·  ì£¼ë³€ íš¨ê³¼ë§Œ ë‚˜íƒ€ë‚´ë¯€ë¡œ ì´ë¶„ì‚°ì ì¸/ì´ì§ˆì ì¸ íš¨ê³¼ê°€ ìˆ¨ì–´ìžˆì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì–´ë–¤ í”¼ì³ì— ëŒ€í•´ ë°ì´í„° í¬ì¸íŠ¸ì˜ ì ˆë°˜ì´ ì˜ˆì¸¡ì¹˜ì™€ ì–‘ì˜ ìƒê´€ê´€ê³„ë¥¼ ê°€ì§€ê³  ìžˆê³ , ë‚˜ë¨¸ì§€ ì ˆë°˜ì€ ìŒì˜ ìƒê´€ê´€ê³„ë¥¼ ê°–ëŠ”ë‹¤ê³  í•´ë³´ê² ìŠµë‹ˆë‹¤. ë°ì´í„°ì…‹ì˜ ì–‘ìª½ ì ˆë°˜ì˜ íš¨ê³¼ê°€ ì„œë¡œ ìƒì‡„ë  ìˆ˜ ìžˆìœ¼ë¯€ë¡œ PD curveëŠ” ìˆ˜í‰ì„ ì´ ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ í”¼ì³ê°€ ì˜ˆì¸¡ì¹˜ì— ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•ŠëŠ”ë‹¤ê³  ê²°ë¡ ì„ ë‚´ë²„ë¦´ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ ì§‘ê²Œëœ line graph ëŒ€ì‹ ì— **ê°œë³„ ì¡°ê±´ë¶€ ê¸°ëŒ€ ê³¡ì„ (individual conditional expection; ICE curves)**ë¥¼ ì‚¬ìš©í•˜ë©´ ì´ëŸ¬í•œ ì´ì§ˆì ì¸ íš¨ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 

## 5. Software and Alternatives

PDPë¥¼ êµ¬í˜„í•  ìˆ˜ ìžˆëŠ” R íŒ¨í‚¤ì§€ì—ëŠ” ì—¬ëŸ¬ ê°€ì§€ê°€ ìžˆìŠµë‹ˆë‹¤. ì˜ˆì œì—ì„œëŠ” `iml` íŒ¨í‚¤ì§€ë¥¼ ì¼ì§€ë§Œ, `pdp`ë‚˜ `DALEX`ë„ ìžˆìŠµë‹ˆë‹¤. Pythonì—ì„œëŠ” PDPê°€ scikit-learnì— ë‚´ìž¥ë˜ì–´ ìžˆìœ¼ë©° `PDPBox`ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 

ì´ ì±…ì—ì„œ ì†Œê°œí•˜ëŠ” PDPì˜ ëŒ€ì•ˆìœ¼ë¡œëŠ” ALE plotsì™€ ICE curves ìž…ë‹ˆë‹¤. 

---

# ðŸ“• 08-02. Accumulated Local Effects; ALE plot

Accumulated Local Effects; ALEëŠ” í”¼ì³ê°€ ML ëª¨ë¸ ì˜ˆì¸¡ì— í‰ê· ì ìœ¼ë¡œ ì–´ë–¤ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ”ì§€ ì„¤ëª…í•©ë‹ˆë‹¤. ALE plotì€ PDPì— ë¹„í•´ ë” ë¹ ë¥´ê³  ë¹„íŽ¸í–¥ì¸ ëŒ€ì•ˆë²•ìž…ë‹ˆë‹¤. 

PDPê°€ ë” ì´í•´í•˜ê¸°ì— ì‰½ê³  ALE, PDP ëª¨ë‘ í”¼ì³ê°€ ì˜ˆì¸¡ì¹˜ì— í‰ê· ì ìœ¼ë¡œ ì–´ë–¤ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ”ì§€ë¥¼ ì„¤ëª…í•œë‹¤ëŠ” ë™ì¼í•œ ëª©í‘œë¥¼ ê°–ìŠµë‹ˆë‹¤. ì´ì œë¶€í„°ëŠ” í”¼ì³ê°„ ìƒí˜¸ ì—°ê´€ë˜ì–´ ìžˆì„ ë•Œ PDPëŠ” ì¢‹ì§€ ì•ŠìŒì„ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤. 

## 1. Motivation and Intuition

í”¼ì³ë“¤ ê°„ì— ìƒê´€ê´€ê³„ê°€ ìžˆëŠ” ê²½ìš°, PDPëŠ” ì‹ ë¢°ë¥¼ ìžƒìŠµë‹ˆë‹¤. ë‹¤ë¥¸ í”¼ì³ì™€ ê°•í•œ ìƒê´€ê´€ê³„ê°€ ìžˆëŠ” í”¼ì³ì— ëŒ€í•œ PDPë¥¼ ê³„ì‚°í•˜ê¸° ìœ„í•´ ì¸ìœ„ì ì¸ ë°ì´í„°ë¥¼ ë§Œë“¤ì–´ ì¸ìŠ¤í„´ìŠ¤ ì˜ˆì¸¡ì¹˜ì˜ í‰ê· ì„ ê³„ì‚°í–ˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ì¶”ì •ëœ feature effectê°€ í¬ê²Œ íŽ¸í–¥ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ë°©ì˜ ìˆ˜ì™€ ê±°ì‹¤ ë©´ì ì— ë”°ë¼ ì£¼íƒ ê°€ì¹˜ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ML ëª¨ë¸ì˜ PDPë¥¼ ê³„ì‚°í•´ ë³´ê² ìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œ ìš°ë¦¬ëŠ” ê±°ì‹¤ ë©´ì ì´ ì˜ˆì¸¡ì¹˜ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì— ê´€ì‹¬ì´ ìžˆë‹¤ê³  í•˜ê² ìŠµë‹ˆë‹¤. 
- [ã…Œ] PDPë¥¼ ë§Œë“œëŠ” ë°©ë²• : 
	1) í”¼ì³ë¥¼ ì„ íƒ, 
	2) grid ì •ì˜, 
	3) grid ê°’ë³„ë¡œ 
		a) í”¼ì²˜ë¥¼ grid ê°’ìœ¼ë¡œ êµì²´í•˜ê³ , 
		b) í‰ê·  ì˜ˆì¸¡ì¹˜ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤. 
	4) curveë¥¼ ê·¸ë¦½ë‹ˆë‹¤. 

PDPì˜ ì²« ë²ˆì§¸ grid ê°’(ì˜ˆ: 30 ãŽ¡)ì„ ê³„ì‚°í•˜ê¸° ìœ„í•´ ë°©ì´ 10ê°œì¸ ì£¼íƒì˜ ê²½ìš°ì—ë„ ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ì˜ ê±°ì‹¤ ë©´ì ì„ 30ãŽ¡ë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤. PDPëŠ” ì´ëŸ¬í•œ ë¹„í˜„ì‹¤ì ì¸ ì£¼íƒì„ feature effect ì¶”ì •ì— í¬í•¨ì‹œí‚¤ê³  ëª¨ë“  ê²ƒì´ ì •ìƒì¸ ê²ƒì²˜ëŸ¼ ê°€ì •í•©ë‹ˆë‹¤. ì•„ëž˜ ê·¸ë¦¼ì€ 2ê°œì˜ ìƒí˜¸ ì—°ê´€ëœ í”¼ì³ì™€ PDPê°€ ì–´ë–»ê²Œ ë“œë¬¸ ì‚¬ë¡€ì˜ ì˜ˆì¸¡ì„ í‰ê· í™”í•˜ëŠ”ì§€ ë³´ì—¬ì¤ë‹ˆë‹¤ : 
![](Pasted%20image%2020240101232730.png) Figure 8.5 : ê°•í•œ ìƒê´€ê´€ê³„ê°€ ìžˆëŠ” x1ê³¼ x2. `x1=0.75`ì—ì„œ feature effectë¥¼ ê³„ì‚°í•˜ê¸° ìœ„í•´ PDPëŠ” ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ì˜ x1ì„ 0.75ë¡œ ëŒ€ì²´í•˜ì—¬ `x1=0.75`ì—ì„œ x2ì˜ ë¶„í¬ê°€ x2ì˜ ì£¼ë³€ ë¶„í¬(ì„¸ë¡œì„ )ì™€ ê°™ë‹¤ê³  ìž˜ëª» ê°€ì •í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ x1ê³¼ x2ì˜ ê°€ëŠ¥ì„±ì´ ë‚®ì€ ì¡°í•©(ì˜ˆ: x1=0.75, x2=0.2)ì´ ë°œìƒí•˜ë©°, PDPëŠ” í‰ê·  íš¨ê³¼ë¥¼ ê³„ì‚°í•˜ëŠ” ë° ì´ë¥¼ ì´ìš©í•©ë‹ˆë‹¤. 

í”¼ì³ë“¤ì˜ ìƒê´€ê´€ê³„ë¥¼ ê³ ë ¤í•œ feature effect ì¶”ì •ì¹˜ë¥¼ ì–»ìœ¼ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œìš”? í”¼ì³ì˜ ì¡°ê±´ë¶€ ë¶„í¬ì— ëŒ€í•œ í‰ê· ì„ êµ¬í•˜ë©´ ë©ë‹ˆë‹¤. ì¦‰, grid ê°’ì´ x1ì¼ ë•Œ x1 ê°’ì„ ê°€ì§„ ì¸ìŠ¤í„´ìŠ¤ì˜ ì˜ˆì¸¡ì¹˜ë¥¼ í‰ê· í™”í•©ë‹ˆë‹¤. ì¡°ê±´ë¶€ ë¶„í¬ë¥¼ ì‚¬ìš©í•˜ë©´ feature effectë¥¼ ê³„ì‚°í•˜ëŠ” ì†”ë£¨ì…˜ì„ marginal plot ë˜ëŠ” M-plotì´ë¼ê³  í•©ë‹ˆë‹¤(ì‹¤ì œë¡œëŠ” ì£¼ë³€ë¶„í¬ê°€ ì•„ë‹Œ ì¡°ê±´ë¶€ ë¶„í¬ë¥¼ ì‚¬ìš©í•˜ëŠ”ë° í—·ê°ˆë¦¬ëŠ” ì´ë¦„ì„ ì‚¬ìš©í•˜ê³  ìžˆìŠµë‹ˆë‹¤). í•˜ì§€ë§Œ M-plotì€ ì €í¬ê°€ ì°¾ê³  ìžˆëŠ” í•´ê²°ì±…ì´ ì•„ë‹™ë‹ˆë‹¤. M-plotì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ì§€ ëª»í•˜ëŠ” ì´ìœ ëŠ” ë¬´ì—‡ì¼ê¹Œìš”? ì•½ 30ãŽ¡ì˜ ëª¨ë“  ì£¼íƒì— ëŒ€í•œ ì˜ˆì¸¡ì¹˜ë¥¼ í‰ê· ë‚´ë©´ ìƒê´€ê´€ê³„ê°€ ìžˆê¸° ë•Œë¬¸ì— ê±°ì‹¤ ë©´ì ê³¼ ë°©ì˜ ìˆ˜ì˜ **combined effect** ë§Œ ì¶”ì •í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ê±°ì‹¤ ë©´ì ì— ë”°ë¼ ë°©ì˜ ìˆ˜ê°€ ì¦ê°€í•˜ê¸° ë•Œë¬¸ì— M-plotì€ ì—¬ì „ížˆ ê±°ì‹¤ ë©´ì ì´ ì˜ˆì¸¡ì¹˜ë¥¼ ì¦ê°€ì‹œí‚¨ë‹¤ëŠ” ê²ƒì„ ë³´ì—¬ì¤ë‹ˆë‹¤. ì•„ëž˜ ê·¸ë¦¼ì€ ìƒí˜¸ ì—°ê´€ëœ 2ê°€ì§€ í”¼ì³ì— ëŒ€í•´ M-plotì´ ì–´ë–»ê²Œ ìž‘ë™í•˜ëŠ”ì§€ ë³´ì—¬ì¤ë‹ˆë‹¤ : 
![](Pasted%20image%2020240101234122.png) Figure 8.6 : ê°•í•œ ìƒê´€ê´€ê³„ë¥¼ ê°–ëŠ” x1ê³¼ x2. M-plotì€ ì¡°ê±´ë¶€ ë¶„í¬ì— ëŒ€í•œ í‰ê· ìž…ë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” `x1=0.75`ì—ì„œ x2ì˜ ì¡°ê±´ë¶€ ë¶„í¬ìž…ë‹ˆë‹¤. Local ì˜ˆì¸¡ì¹˜ë¥¼ í‰ê· ë‚´ë©´ ë‘ ê°€ì§€ í”¼ì³ì˜ effectê°€ ì„žìž…ë‹ˆë‹¤. 

M-plotì€ ê°€ëŠ¥ì„±ì´ ë‚®ì€ ì¸ìŠ¤í„´ìŠ¤ë“¤ì˜ ì˜ˆì¸¡ì¹˜ í‰ê· í™”ëŠ” í”¼í•˜ì§€ë§Œ, í”¼ì³ì˜ íš¨ê³¼ë¥¼ ìƒê´€ìžˆëŠ” ëª¨ë“  í”¼ì³ íš¨ê³¼ì™€ ì„žì–´ë²„ë¦½ë‹ˆë‹¤. ALE plotì€ í”¼ì³ì˜ ì¡°ê±´ë¶€ ë¶„í¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í‰ê·  ëŒ€ì‹  ì˜ˆì¸¡ì¹˜ì˜ ì°¨ì´ë¥¼ ê³„ì‚°í•´ ì´ ë¬¸ì œë¥¼ í•´ê²°í•©ë‹ˆë‹¤. 30ãŽ¡ ê±°ì‹¤ ë©´ì  íš¨ê³¼ëŠ” ALEì—ì„œëŠ” ì•½ 30ãŽ¡ì˜ ëª¨ë“  ì£¼íƒì„ ì‚¬ìš©í•˜ê³ , ì´ ì£¼íƒì´ 31ãŽ¡ì¸ ê²ƒìœ¼ë¡œ ê°€ì •í•œ ëª¨ë¸ ì˜ˆì¸¡ì—ì„œ 29ãŽ¡ì¸ ê²ƒìœ¼ë¡œ ê°€ì •í•œ ì˜ˆì¸¡ì¹˜ë¥¼ ëº€ ê°’ì„ êµ¬í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ê±°ì‹¤ ë©´ì ì˜ ìˆœìˆ˜í•œ íš¨ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìžˆìœ¼ë©°, ì´ íš¨ê³¼ë¥¼ ìƒê´€ê´€ê³„ê°€ ìžˆëŠ” í”¼ì³ë“¤ì˜ íš¨ê³¼ì™€ ì„žì´ì§€ ì•Šê²Œ í•©ë‹ˆë‹¤. ì°¨ì´ê°’ì„ ì‚¬ìš©í•˜ë©´ ë‹¤ë¥¸ í”¼ì³ì˜ íš¨ê³¼ê°€ ì°¨ë‹¨ë©ë‹ˆë‹¤. ì•„ëž˜ ê·¸ë¦¼ì€ ALE plotì´ ê³„ì‚°ë˜ëŠ” ë°©ì‹ì„ ì§ê´€ì ìœ¼ë¡œ ë³´ì—¬ì¤ë‹ˆë‹¤ : 
![](Pasted%20image%2020240102000247.png) Figure 8.7 : x2ì™€ ìƒê´€ê´€ê³„ê°€ ìžˆëŠ” x1ì— ëŒ€í•œ ALE ê³„ì‚°. ë¨¼ì € í”¼ì³ x1ì„ ê°„ê²©(ì„¸ë¡œì„ )ìœ¼ë¡œ ë‚˜ëˆ•ë‹ˆë‹¤. ê°„ê²©ì˜ ì¸ìŠ¤í„´ìŠ¤(points)ì— ëŒ€í•´ í”¼ì³ë¥¼ ê°„ê²©ì˜ ìƒí•œê³¼ í•˜í•œ(ê°€ë¡œì„ )ìœ¼ë¡œ ëŒ€ì²´í•  ë•Œ ì˜ˆì¸¡ì¹˜ì˜ ì°¨ì´ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì°¨ì´ê°’ì´ ë‚˜ì¤‘ì— ëˆ„ì ë˜ê³  ì¤‘ì‹¬í™”ë˜ë©´ ALE curveê°€ ë©ë‹ˆë‹¤. 

ê° ìœ í˜•ì˜ í”Œë¡¯ (PDP, M, ALE)ì´ íŠ¹ì • grid ê°’ vì—ì„œ í”¼ì³ì˜ íš¨ê³¼ë¥¼ ê³„ì‚°í•˜ëŠ” ë°©ë²•ì„ ìš”ì•½í•˜ë©´ ì•„ëž˜ì™€ ê°™ìŠµë‹ˆë‹¤ : 
- **Partial Denpendence Plots** : ê° ë°ì´í„° ì¸ìŠ¤í„´ìŠ¤ì— í•´ë‹¹ í”¼ì³ ê°’ vê°€ ìžˆì„ ë•Œ ëª¨ë¸ì´ í‰ê· ì ìœ¼ë¡œ ë¬´ì—‡ì„ ì˜ˆì¸¡í•˜ëŠ”ì§€ ë³´ì—¬ë“œë¦½ë‹ˆë‹¤. ê°’ vê°€ ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ì— ì ì ˆí•œì§€ëŠ” ë¬´ì‹œí•©ë‹ˆë‹¤. 
- **M-plots** : í•´ë‹¹ í”¼ì³ì— ëŒ€í•´ vì— ê°€ê¹Œìš´ ê°’ì„ ê°–ëŠ” ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•´ ëª¨ë¸ì´ í‰ê· ì ìœ¼ë¡œ ì˜ˆì¸¡í•˜ëŠ” ê²ƒì„ ë³´ì—¬ì¤ë‹ˆë‹¤. ì´ íš¨ê³¼ëŠ” í•´ë‹¹ í”¼ì³ì˜ ì˜í–¥ì¼ ìˆ˜ë„ ìžˆì§€ë§Œ ìƒê´€ê´€ê³„ì— ìžˆëŠ” í”¼ì³ë“¤ ë•Œë¬¸ì¼ ìˆ˜ë„ ìžˆìŠµë‹ˆë‹¤. 
- **ALE Plots** : v ê°’ ì£¼ë³€ì˜ ìž‘ì€ "ì°½(window)"ì—ì„œ í•´ë‹¹ ì°½ì— ìžˆëŠ” ì¸ìŠ¤í„´ìŠ¤ë“¤ì— ëŒ€í•´ ëª¨ë¸ ì˜ˆì¸¡ì¹˜ê°€ ì–´ë–»ê²Œ ë³€í•˜ëŠ”ì§€ ë³´ì—¬ì¤ë‹ˆë‹¤. 

## 2. Theory

PDP, M-plot, ALE plotì€ ìˆ˜í•™ì ìœ¼ë¡œ ì–´ë–»ê²Œ ë‹¤ë¥¸ì§€ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤. 3ê°€ì§€ ë°©ë²•ì˜ ê³µí†µì ì€ ë³µìž¡í•œ ì˜ˆì¸¡ í•¨ìˆ˜ $f$ ë¥¼ í•˜ë‚˜ ë˜ëŠ” ë‘ ê°œì˜ í”¼ì³ì—ë§Œ ì˜ì¡´í•˜ëŠ” í•¨ìˆ˜ë¡œ ì¤„ì¸ë‹¤ëŠ” ê²ƒìž…ë‹ˆë‹¤. ì„¸ ê°€ì§€ ë°©ë²• ëª¨ë‘ ë‹¤ë¥¸ í”¼ì³ë“¤ì˜ íš¨ê³¼ë¥¼ í‰ê· ë‚´ì–´ í•¨ìˆ˜ë¥¼ ì¶•ì†Œí•˜ì§€ë§Œ, ì˜ˆì¸¡ì¹˜ì˜ í‰ê·  ë˜ëŠ” ì˜ˆì¸¡ì¹˜ì˜ ì°¨ì´, í‰ê· í™”ë¥¼ ì£¼ë³€ë¶„í¬ì— ëŒ€í•´ ìˆ˜í–‰í• ì§€, ì¡°ê±´ë¶€ ë¶„í¬ì— ëŒ€í•´ ìˆ˜í–‰í• ì§€ëŠ” ë‹¤ë¦…ë‹ˆë‹¤. 

PDPì˜ ì£¼ë³€ ë¶„í¬ì— ëŒ€í•œ ì˜ˆì¸¡ì¹˜ì˜ í‰ê· ì„ êµ¬í•©ë‹ˆë‹¤ : 
$$
\begin{aligned}
\hat{f}_{S, P D P}(x) & =E_{X_C}\left[\hat{f}\left(x_S, X_C\right)\right] \\
& =\int_{X_C} \hat{f}\left(x_S, X_C\right) d \mathbb{P}\left(X_C\right)
\end{aligned}
$$
ì´ëŠ” í”¼ì³ê°’ $x_S$ì—ì„œ ì˜ˆì¸¡ í•¨ìˆ˜ $f$ ì˜ ê°’ìœ¼ë¡œ, $X_C$ì˜ ëª¨ë“  í”¼ì³(í™•ë¥ ë³€ìˆ˜)ì— ëŒ€í•´ í‰ê· ì„ ë‚¸ ê°’ìž…ë‹ˆë‹¤. í‰ê· ì„ ë‚¸ë‹¤ëŠ” ê²ƒì€ ì§‘í•© $C$ ì˜ í”¼ì³ë“¤ì— ëŒ€í•œ marginal expectation $E$ ë¥¼ ê³„ì‚°í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•˜ë©°, ì´ëŠ” í™•ë¥  ë¶„í¬ì— ì˜í•´ ê°€ì¤‘ëœ ì˜ˆì¸¡ì¹˜ì— ëŒ€í•œ ì ë¶„ìž…ë‹ˆë‹¤. ì£¼ë³€ ë¶„í¬ì— ëŒ€í•œ ê¸°ëŒ€ê°’ì„ ê³„ì‚°í•˜ë ¤ë©´ ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê°€ì ¸ì™€ì„œ ì§‘í•© $S$ ì˜ í”¼ì³ì— ëŒ€í•´ grid ê°’ì„ ê°•ì œí•˜ê³ , ì´ ì¡°ìž‘ëœ ë°ì´í„°ì…‹ì— ëŒ€í•œ ì˜ˆì¸¡ì¹˜ì˜ í‰ê· ì„ êµ¬í•˜ëŠ” ê²ƒìž…ë‹ˆë‹¤. ì´ ì ˆì°¨ë¥¼ í†µí•´ í”¼ì³ì˜ ì£¼ë³€ ë¶„í¬ì— ëŒ€í•œ í‰ê· ì„ êµ¬í•˜ëŠ” ê²ƒìž…ë‹ˆë‹¤. 

M-plotsì€ ì¡°ê±´ë¶€ ë¶„í¬ë¥¼ í†µí•´ ì˜ˆì¸¡ì¹˜ì˜ í‰ê· ì„ ëƒ…ë‹ˆë‹¤ : 
$$
\begin{aligned}
\hat{f}_{S, M}\left(x_S\right) & =E_{X_C \mid X_S}\left[\hat{f}\left(X_S, X_C\right) \mid X_S=x_s\right] \\
& =\int_{X_C} \hat{f}\left(x_S, X_C\right) d \mathbb{P}\left(X_C \mid X_S=x_S\right)
\end{aligned}
$$
PDPì™€ ë¹„êµí•´ì„œ ë‹¤ë¥¸ ì ì€ ê° grid ê°’ì˜ ì£¼ë³€ ë¶„í¬ë¥¼ ê°€ì •í•˜ëŠ” ëŒ€ì‹  ê´€ì‹¬ ìžˆëŠ” í”¼ì³ì˜ ê° grid ê°’ì— ì¡°ê±´ë¶€ë¡œ ì˜ˆì¸¡ì¹˜ë¥¼ í‰ê· ë‚¸ë‹¤ëŠ” ê²ƒìž…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ 30ãŽ¡ê°€ ì˜ˆì¸¡ëœ ì£¼íƒ ê°€ê²©ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ ê³„ì‚°í•˜ë ¤ë©´ 28ãŽ¡ ~ 32ãŽ¡ ì‚¬ì´ì˜ ëª¨ë“  ì£¼íƒì— ëŒ€í•œ ì˜ˆì¸¡ì¹˜ í‰ê· ì„ êµ¬í•˜ëŠ” ê²ƒì²˜ëŸ¼, ì´ì›ƒì„ ì •ì˜í•´ì•¼ í•©ë‹ˆë‹¤. 

ALE plotsì€ ì˜ˆì¸¡ì¹˜ì˜ ë³€í™”ë¥¼ í‰ê· ë‚´ì–´ gridì— ëˆ„ì í•©ë‹ˆë‹¤ : 
$$
\begin{aligned}
\hat{f}_{S, A L E}\left(x_S\right) & =\int_{z_{0, S}}^{x_S} E_{X_C \mid X_S=x_S}\left[\hat{f}^S\left(X_s, X_c\right) \mid X_S=z_S\right] d z_S-\text { constant } \\
& =\int_{z_{0, S}}^{x_S}\left(\int_{x_C} \hat{f}^S\left(z_s, X_c\right) d \mathbb{P}\left(X_C \mid X_S=z_S\right) d\right) d z_S-\text { constant }
\end{aligned}
$$
ì´ ê³µì‹ì€ M-plotê³¼ 3ê°€ì§€ ì°¨ì´ì ì„ ê°–ìŠµë‹ˆë‹¤. 1) ì˜ˆì¸¡ì¹˜ ìžì²´ê°€ ì•„ë‹ˆë¼ ì˜ˆì¸¡ì¹˜ì˜ ë³€í™”ë¥¼ í‰ê· ëƒ…ë‹ˆë‹¤. ì´ ë³€í™”ëŠ” íŽ¸ë¯¸ë¶„(partial derivative)ë¡œ ì •ì˜ë©ë‹ˆë‹¤ (í•˜ì§€ë§Œ ì‹¤ì œ ê³„ì‚°ì—ì„œëŠ” ê°„ê²©ì— ë”°ë¥¸ ì˜ˆì¸¡ì¹˜ì˜ ì°¨ì´ë¡œ ëŒ€ì²´ë¨).

$$
\hat{f}^S\left(x_s, x_c\right)=\frac{\partial \hat{f}\left(x_S, x_C\right)}{\partial x_S}
$$
ë‘ ë²ˆì§¸ ì°¨ì´ì ì€ 2) $z$ ì— ëŒ€í•œ ì¶”ê°€ì ì¸ ì ë¶„ìž…ë‹ˆë‹¤. ì§‘í•© $S$ ì˜ í”¼ì³ ë²”ìœ„ì— ëŒ€í•œ local partial derivativesë¥¼ ëˆ„ì í•˜ì—¬ í”¼ì³ì˜ ì˜ˆì¸¡ì¹˜ì— ì˜í–¥ì„ ì¸¡ì •í•©ë‹ˆë‹¤. ì‹¤ì œ ê³„ì‚°ì—ì„œ $z$ ëŠ” ì˜ˆì¸¡ì¹˜ì˜ ë³€í™”ë¥¼ ê³„ì‚°í•˜ëŠ” ê°„ê²©ë“¤ì˜ gridë¡œ ëŒ€ì²´ë©ë‹ˆë‹¤. ALEëŠ” ì˜ˆì¸¡ì¹˜ë¥¼ ì§ì ‘ í‰ê· ë‚´ëŠ” ëŒ€ì‹ , í”¼ì³ $S$ ì— ë”°ë¼ ì¡°ê±´ë¶€ë¡œ ì˜ˆì¸¡ì¹˜ì˜ ì°¨ì´ë¥¼ ê³„ì‚°í•˜ê³  í”¼ì³ $S$ ì— ëŒ€í•œ ë¯¸ë¶„ì„ ì ë¶„í•˜ì—¬ íš¨ê³¼ë¥¼ ì¶”ì •í•©ë‹ˆë‹¤. ë¯¸ë¶„ê³¼ ì ë¶„ì„ ì„œë¡œ ìƒì‡„ë˜ëŠ”ë° ì™œ ì´ë ‡ê²Œ í•˜ëŠ”ê±¸ê¹Œìš”? ë¯¸ë¶„ (ë˜ëŠ” ê°„ê²© ì°¨ì´)ì€ ê´€ì‹¬ ìžˆëŠ” í”¼ì³ì˜ íš¨ê³¼ë¥¼ ë¶„ë¦¬í•˜ê³  ìƒí˜¸ ì—°ê´€ëœ í”¼ì³ë“¤ì˜ íš¨ê³¼ë¥¼ ì°¨ë‹¨í•˜ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤. 

ì„¸ ë²ˆì§¸ ì°¨ì´ì ì€ 3) ìƒìˆ˜ë¥¼ ëº€ë‹¤ëŠ” ê²ƒìž…ë‹ˆë‹¤. ì´ ë‹¨ê³„ëŠ” ë°ì´í„°ì— ëŒ€í•œ í‰ê·  íš¨ê³¼ê°€ 0ì´ ë˜ë„ë¡ ALE plotì˜ ì¤‘ì•™ì— ë°°ì¹˜í•©ë‹ˆë‹¤. 

í•œ ê°€ì§€ ë¬¸ì œê°€ ë‚¨ì•„ ìžˆìŠµë‹ˆë‹¤. ëª¨ë“  ëª¨ë¸ì— gradientê°€ ìžˆëŠ” ê²ƒì€ ì•„ë‹Œë°, ì˜ˆë¥¼ ë“¤ì–´ Random Forest ì—ëŠ” gradientê°€ ì—†ìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì‹¤ì œ ê³„ì‚°ì€ gradient ì—†ì´ ìž‘ë™í•˜ë©° ê°„ê²©ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ALE plotì˜ ì¶”ì •ì— ëŒ€í•´ ë” ìžì„¸ížˆ ì‚´íŽ´ë³´ê² ìŠµë‹ˆë‹¤. 

## 3. Estimation

ë¨¼ì € í•œ ê°œì˜ ìˆ«ìží˜• í”¼ì³ì— ëŒ€í•´ ALE plotì˜ ì¶”ì •ë²•ì„ ì„¤ëª…í•˜ê³ , ì´í›„ 2ê°œì˜ ìˆ«ìží˜• í”¼ì³ì™€ ë‹¨ì¼ ë²”ì£¼í˜• í”¼ì³ì˜ ê²½ìš°ë„ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤. í”¼ì³ë¥¼ ì—¬ëŸ¬ ê°œì˜ êµ¬ê°„ìœ¼ë¡œ ë‚˜ëˆ„ê³  ê° êµ¬ê°„ì—ì„œ ì˜ˆì¸¡ì¹˜ì˜ ì°¨ì´ë¥¼ ê³„ì‚°í•¨ìœ¼ë¡œì¨ ì§€ì—­ì  íš¨ê³¼(local effects)ë¥¼ ì¶”ì •í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì´ëŠ” ë¯¸ë¶„ì— ê·¼ì‚¬í™”í•˜ëŠ” ê²ƒìœ¼ë¡œì¨ ë¯¸ë¶„ì´ ë¶ˆê°€ëŠ¥í•œ ëª¨ë¸ì—ì„œë„ ìž‘ë™í•©ë‹ˆë‹¤. 

ë¨¼ì € ë¹„ì¤‘ì‹¬(uncentered) íš¨ê³¼ë¥¼ ì¶”ì •í•´ ë³´ê² ìŠµë‹ˆë‹¤ :
$$
\hat{\tilde{f}}_{j, A L E}(x)=\sum_{k=1}^{k_j(x)} \frac{1}{n_j(k)} \sum_{i: x_j^{(i)} \in N_j(k)}\left[\hat{f}\left(z_{k, j}, x_{-j}^{(i)}\right)-\hat{f}\left(z_{k-1, j}, x_{-j}^{(i)}\right)\right]
$$
**ëˆ„ì  ì§€ì—­ íš¨ê³¼(Accumulated Local Effects)**ë¼ëŠ” ì´ë¦„ì€ ìœ„ ê³µì‹ì˜ ê°œë³„ ìš”ì†Œë“¤ì„ ìž˜ ë°˜ì˜í•˜ê³  ìžˆìŠµë‹ˆë‹¤. ALE methodì˜ í•µì‹¬ì€ ì˜ˆì¸¡ì¹˜ì˜ ì°¨ì´ê°’ì„ ê³„ì‚°í•˜ëŠ” ê²ƒì¸ë°, ê´€ì‹¬ ìžˆëŠ” í”¼ì³ë¥¼ grid value $z$ ë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤. ì˜ˆì¸¡ì¹˜ì˜ ì°¨ì´ëŠ” í”¼ì³ê°€ íŠ¹ì •í•œ ê°„ê²©(interval) ë‚´ì˜ ê°œë³„ ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•´ ê°–ëŠ” íš¨ê³¼(Effect) ìž…ë‹ˆë‹¤.  ì˜¤ë¥¸ìª½ì˜ í•©ê³„ëŠ” ê°„ê²© ë‚´ì˜ ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ì˜ íš¨ê³¼ë“¤ì„ ë”í•œ ê²ƒìœ¼ë¡œ, ìœ„ ê³µì‹ì—ì„œ ì´ì›ƒ $N_j(k)$ë¡œ ë‚˜íƒ€ë‚©ë‹ˆë‹¤. ì´ í•©ê³„ë¥¼ êµ¬ê°„ ë‚´ ì¸ìŠ¤í„´ìŠ¤ì˜ ìˆ˜ $n_j(k)$ë¡œ ë‚˜ëˆ„ë©´ í•´ë‹¹ êµ¬ê°„ì— ëŒ€í•œ í‰ê·  ì˜ˆì¸¡ì¹˜ ì°¨ì´ê°’ì„ êµ¬í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. í•´ë‹¹ ê°„ê²©ì˜ í‰ê· ì€ ALEì—ì„œ Localì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ì™¼ìª½ í•©ê³„ëŠ” ëª¨ë“  êµ¬ê°„(ì´ $k_j(x)$ê°œì˜ êµ¬ê°„ì´ ì¡´ìž¬)ì— ê±¸ì³ ê° êµ¬ê°„ì— í‰ê·  íš¨ê³¼ë¥¼ ëˆ„ì í•© í•œë‹¤ëŠ” ê²ƒìž…ë‹ˆë‹¤. ì´ëŠ” ALEì—ì„œ Accumulated ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. 

ì´ëŸ¬í•œ íš¨ê³¼ë¥¼ ì¤‘ì‹¬í™”ì‹œí‚´ìœ¼ë¡œì¨ í”¼ì³ì˜ í‰ê·  íš¨ê³¼ê°€ 0ì´ ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤ :
$$
\hat{f}_{j, A L E}(x)=\hat{\tilde{f}}_{j, A L E}(x)-\frac{1}{n} \sum_{i=1}^n \hat{\tilde{f}}_{j, A L E}\left(x_j^{(i)}\right)
$$
ALE ê°’ì€ ë°ì´í„°ì˜ í‰ê·  ì˜ˆì¸¡ì¹˜ì™€ ë¹„êµí•´ì„œ í”¼ì³ì˜ íŠ¹ì • ê°’ì—ì„œ ì£¼íš¨ê³¼ë¥¼ í•´ì„í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, $x_j=3$ì—ì„œ ALE ì¶”ì •ì¹˜ê°€ -2 ë¼ëŠ” ê²ƒì€ $j$ë²ˆì§¸ í”¼ì³ê°’ì´ 3ì¼ ë•Œ ì˜ˆì¸¡ì¹˜ê°€ í‰ê·  ì˜ˆì¸¡ì¹˜ì— ë¹„í•´ 2ë§Œí¼ ë‚®ë‹¤ëŠ” ê²ƒìž…ë‹ˆë‹¤. 

í”¼ì³ì˜ ê°„ê²©/êµ¬ê°„ì„ ì •í•  ë•Œ ì‚¬ìš©í•˜ëŠ” gridëŠ” í”¼ì³ ë¶„í¬ì˜ ì‚¬ë¶„ìœ„ìˆ˜ë¥¼ í™œìš©í•©ë‹ˆë‹¤. ì‚¬ë¶„ìœ„ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ê° ê°„ê²©ì— ë™ì¼í•œ ê°œìˆ˜ì˜ ì¸ìŠ¤í„´ìŠ¤ê°€ ë“¤ì–´ê°€ê²Œ í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ ì‚¬ë¶„ìœ„ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ê°„ê²©ì˜ ê¸¸ì´ê°€ ë‹¤ë¥¼ ìˆ˜ ìžˆë‹¤ëŠ” ë‹¨ì ì´ ì¡´ìž¬í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ê´€ì‹¬ í”¼ì³ê°€ ì‹¬í•˜ê²Œ skewed ë˜ì–´ ìžˆëŠ” ê²½ìš° ALE plotì´ ì´ìƒí•´ì§ˆ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 

#### ALE plots for the interaction of two features

ALE plotì€ ë‘ ê°œì˜ í”¼ì³ ê°„ ìƒí˜¸ìž‘ìš© íš¨ê³¼ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤. ì›ë¦¬ëŠ” ë‹¨ì¼ í”¼ì³ì™€ ë™ì¼í•˜ì§€ë§Œ, íš¨ê³¼ë¥¼ 2ì°¨ì›ìœ¼ë¡œ ëˆ„ì í•´ì•¼ í•˜ë¯€ë¡œ ê°„ê²© ëŒ€ì‹  ì§ì‚¬ê°í˜•ì˜ ì…€ë¡œ ìž‘ì—…í•©ë‹ˆë‹¤. ì „ì²´ í‰ê·  íš¨ê³¼ë¥¼ ì¡°ì •í•˜ëŠ” ê²ƒ ë¿ì•„ë‹ˆë¼ ë‘ í”¼ì³ì˜ ì£¼íš¨ê³¼ë„ ì¡°ì •í•´ì•¼ í•©ë‹ˆë‹¤. ì¦‰, ë‘ í”¼ì³ì— ëŒ€í•œ ALEëŠ” í”¼ì³ì˜ ì£¼ íš¨ê³¼ë¥¼ í¬í•¨í•˜ì§€ ì•ŠëŠ” 2ì°¨ íš¨ê³¼ë¥¼ ì¶”ì •í•˜ëŠ” ê²ƒìž…ë‹ˆë‹¤. ë‘ í”¼ì³ì˜ ì¶”ê°€ì ì¸ ìƒí˜¸ìž‘ìš© íš¨ê³¼ë§Œ í‘œì‹œí•©ë‹ˆë‹¤. 2D ALE plotì— ëŒ€í•œ ê³µì‹ì€ ê¸¸ê³  ì½ê¸° ë¶ˆíŽ¸í•˜ê¸° ë•Œë¬¸ì— ìƒëžµí•˜ê² ìŠµë‹ˆë‹¤. 2ì°¨ ALE plot ê³„ì‚°ì— ëŒ€í•œ ì§ê´€ë ¥ì„ ìœ„í•´ ì‹œê°í™” í•´ë³´ê² ìŠµë‹ˆë‹¤ : 
![](Pasted%20image%2020240102140529.png)Figure 8.8 : 2D-ALE ê³„ì‚°. ë‘ í”¼ì³ ìœ„ì— grid ë¥¼ ë°°ì¹˜í•©ë‹ˆë‹¤. ê° grid cellì—ì„œ ê·¸ ì•ˆì˜ ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•œ 2ì°¨ ì°¨ì´ê°’ì„ ê³„ì‚°í•©ë‹ˆë‹¤. ë¨¼ì € x1ê³¼ x2ì˜ ê°’ì„ ì…€ ëª¨ì„œë¦¬ì˜ ê°’ìœ¼ë¡œ ë°”ê¿‰ë‹ˆë‹¤. a,b,c,d ê°€ ì¡°ìž‘ëœ ì¸ìŠ¤í„´ìŠ¤ì˜ ëª¨ì„œë¦¬ ì˜ˆì¸¡ì¹˜ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤ê³  í•˜ê³ , 2ì°¨ ì°¨ì´ëŠ” (d-c) - (b-a)ê°€ ë©ë‹ˆë‹¤. ê° ì…€ì˜ í‰ê·  2ì°¨ ì°¨ì´ê°’ì€ gridì— ëˆ„ì ë˜ì–´ ì¤‘ì•™ì— ìœ„ì¹˜í•©ë‹ˆë‹¤. 

ìœ„ ê·¸ë¦¼ì€ ë‘ í”¼ì³ ê°„ ìƒê´€ê´€ê³„ë¡œ ì¸í•´ ë§Žì€ ì…€ì´ ë¹„ì–´ ìžˆìŠµë‹ˆë‹¤. ALE plotì—ì„œëŠ” ì´ë¥¼ íšŒìƒ‰ìœ¼ë¡œ í‘œì‹œí•˜ê±°ë‚˜ ìƒìžë¥¼ ì–´ë‘¡ê²Œ í‘œì‹œí•´ì„œ ì‹œê°í™”í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ë˜ëŠ” ë¹ˆ ì…€ì˜ ëˆ„ë½ëœ ALE ì¶”ì •ì¹˜ë¥¼ ê°€ìž¥ ê°€ê¹Œìš´ ë¹„ì–´ ìžˆì§€ ì•Šì€ ì…€ì˜ ALE ì¶”ì„±ì¹˜ë¡œ ëŒ€ì²´í•˜ê¸°ë„ í•©ë‹ˆë‹¤. 

ë‘ í”¼ì³ì— ëŒ€í•œ ALE ì¶”ì •ì¹˜ëŠ” í”¼ì³ì˜ 2ì°¨ íš¨ê³¼ë§Œì„ í‘œì‹œí•˜ê¸° ë•Œë¬¸ì— í•´ì„ì— ì£¼ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤. 2ì°¨ í‘œê³¼ëŠ” í”¼ì³ì˜ ì£¼ íš¨ê³¼ë¥¼ ì„¤ëª…í•œ í›„ ì¶”ê°€ì ì¸ ìƒí˜¸ìž‘ìš© íš¨ê³¼ìž…ë‹ˆë‹¤. ë‘ ê°œì˜ í”¼ì³ê°€ ì„œë¡œ ìƒí˜¸ìž‘ìš©í•˜ì§€ ì•Šì§€ë§Œ ê°ê°ì´ ì˜ˆì¸¡ì¹˜ì— ì„ í˜•ì ì¸ ì˜í–¥ì„ ë¯¸ì¹œë‹¤ê³  ê°€ì •í•´ ë³´ê² ìŠµë‹ˆë‹¤. ê° í”¼ì³ì— ëŒ€í•œ 1D ALE plotì—ì„œëŠ” ì§ì„ ìœ¼ë¡œ ì˜ˆìƒ ALE curve ë¥¼ ë³¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ 2D ALE ì¶”ì •ì¹˜ë¥¼ ê·¸ë ¤ë³´ë©´ 2ì°¨ íš¨ê³¼ëŠ” ìƒí˜¸ìž‘ìš©ì˜ ì¶”ê°€ì ì¸ íš¨ê³¼ì¼ ë¿ì´ë¯€ë¡œ 0ì— ê°€ê¹Œì›Œì•¼ í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì ì—ì„œ ALE plotì´ PDPì™€ ë‹¤ë¥¸ ê²ƒìž…ë‹ˆë‹¤ : PDPëŠ” í•­ìƒ ì „ì²´ íš¨ê³¼ë¥¼ í‘œì‹œí•˜ê³ , ALE plot ì€ 1ì°¨ ë˜ëŠ” 2ì°¨ íš¨ê³¼ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤. PDPì—ì„œ í•˜ìœ„ íš¨ê³¼ë¥¼ ë¹¼ì„œ ì£¼íš¨ê³¼ ë˜ëŠ” 2ì°¨ íš¨ê³¼ë¥¼ ì–»ì„ ìˆ˜ë„ ìžˆê³ , í•˜ìœ„ íš¨ê³¼ë¥¼ ì°¨ê°í•˜ì§€ ì•Šê³  ì „ì²´ ALE plotì„ ì–»ì„ ìˆ˜ë„ ìžˆìŠµë‹ˆë‹¤. 

ALEëŠ” ìž„ì˜ë¡œ ë” ë†’ì€ ì°¨ìˆ˜ (3ê°œ ì´ìƒ í”¼ì³ ê°„ ìƒí˜¸ìž‘ìš©)ì— ëŒ€í•´ì„œë„ ê³„ì‚°ì´ ê°€ëŠ¥í•˜ì§€ë§Œ, ì•žì„œ ë§í•œ ê²ƒì²˜ëŸ¼ ì´ë¥¼ ì œëŒ€ë¡œ í•´ì„í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ìµœëŒ€ 2ê°œê¹Œì§€ë§Œ ì˜ë¯¸ë¥¼ ê°–ìŠµë‹ˆë‹¤. 

#### ALE for categorical features

ALE methodëŠ” íŠ¹ì •í•œ ë°©í–¥ìœ¼ë¡œ íš¨ê³¼ë¥¼ ëˆ„ì í•˜ê¸° ë•Œë¬¸ì— ì •ì˜ìƒ í”¼ì³ ê°’ì— ìˆœì„œê°€ ìžˆì–´ì•¼ í•©ë‹ˆë‹¤. ë²”ì£¼í˜• í”¼ì³ì—ëŠ” ìžì—°ìŠ¤ëŸ¬ìš´ ìˆœì„œê°€ ì—†ìŠµë‹ˆë‹¤. ì¦‰ ë²”ì£¼í˜• í”¼ì³ì— ëŒ€í•œ ALE plotì„ ê·¸ë¦¬ê¸° ìœ„í•´ì„  ì–´ë–»ê²Œë“  ìˆœì„œë¥¼ ë§Œë“¤ê±°ë‚˜ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤. ë²”ì£¼ì˜ ìˆœì„œëŠ” ALE ê³„ì‚°ê³¼ í•´ì„ì— ì˜í–¥ì„ ë¯¸ì¹©ë‹ˆë‹¤. 

í•œ ê°€ì§€ ë°©ë²•ì€ ë‹¤ë¥¸ í”¼ì³ë“¤ì„ ê¸°ì¤€ìœ¼ë¡œ ìœ ì‚¬ì„±(similarity)ì— ë”°ë¼ ë²”ì£¼ë“¤ì˜ ìˆœì„œë¥¼ ì •í•˜ëŠ” ê²ƒìž…ë‹ˆë‹¤. í”¼ì³ë³„ ê±°ë¦¬ëŠ” KS(Kolmogorov-Smirnov) distance (ìˆ«ìží˜• í”¼ì³) ë˜ëŠ” ìƒëŒ€ ë¹ˆë„ í…Œì´ë¸” (relative frequency tables, ë²”ì£¼í˜• í”¼ì³)ë¡œ ë¹„êµí•©ë‹ˆë‹¤. ëª¨ë“  ë²”ì£¼ ê°„ ê±°ë¦¬ë¥¼ íŒŒì•…í•œ í›„ ë‹¤ì°¨ì› ìŠ¤ì¼€ì¼ë§ (multi-dimensional scaling)ì„ ì‚¬ìš©í•´ ê±°ë¦¬ í–‰ë ¬ì„ 1ì°¨ì› ê±°ë¦¬ ì¸¡ì •ê°’ìœ¼ë¡œ ì¶•ì†Œí•©ë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ë²”ì£¼ ê°„ ìœ ì‚¬ì„± ê¸°ë°˜ ìˆœì„œë¥¼ ì•Œ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 

ì˜ˆë¥¼ ë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤ : "ê³„ì ˆ"ê³¼ "ë‚ ì”¨"ë¼ëŠ” 2ê°€ì§€ ë²”ì£¼í˜• í”¼ì³ì™€ "ì˜¨ë„"ë¼ëŠ” ìˆ«ìží˜• í”¼ì³ê°€ ìžˆë‹¤ê³  ê°€ì •í•´ ë³´ê² ìŠµë‹ˆë‹¤. ì²« ë²ˆì§¸ ë²”ì£¼í˜• í”¼ì³ (ê³„ì ˆ)ì— ëŒ€í•´ ALEë¥¼ ê³„ì‚°í•˜ë ¤ê³  í•©ë‹ˆë‹¤. ì´ í”¼ì³ì—ëŠ” "ë´„", "ì—¬ë¦„", "ê°€ì„", "ê²¨ìš¸" ë ˆë²¨ì´ ìžˆìŠµë‹ˆë‹¤. ìˆ˜ì¤€ "ë´„"ê³¼ "ì—¬ë¦„" ì‚¬ì´ì˜ ê±°ë¦¬ë¥¼ ê³„ì‚°í•´ ë³´ê² ìŠµë‹ˆë‹¤. ì´ ê±°ë¦¬ëŠ” í”¼ì³ì˜ ì˜¨ë„ì™€ ë‚ ì”¨ì— ëŒ€í•œ ê±°ë¦¬ì˜ í•©ìž…ë‹ˆë‹¤. ì˜¨ë„ì˜ ê²½ìš° "ë´„"ì¸ ëª¨ë“  ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê°€ì ¸ì™€ì„œ empirical cdfë¥¼ ê³„ì‚°í•˜ê³  "ì—¬ë¦„"ì¸ ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•´ì„œë„ ë™ì¼ ìž‘ì—…ì„ ìˆ˜í–‰í•œ ë‹¤ìŒ KS statisticsë¡œ ê±°ë¦¬ë¥¼ ì¸¡ì •í•©ë‹ˆë‹¤. ë‚ ì”¨ í”¼ì³ì˜ ê²½ìš° ëª¨ë“  "ë´„" ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•´ ê° ë‚ ì”¨ ë²”ì£¼ì— ëŒ€í•œ í™•ë¥ /ìƒëŒ€ ë¹ˆë„ë¥¼ ê³„ì‚°í•˜ê³ , "ì—¬ë¦„"ì— ëŒ€í•´ì„œë„ ë™ì¼ ìž‘ì—… ìˆ˜í–‰ í›„ í™•ë¥  ë¶„í¬ì˜ ì ˆëŒ€ ê±°ë¦¬ë¥¼ í•©ì‚°í•©ë‹ˆë‹¤. "ë´„"ê³¼ "ì—¬ë¦„"ì˜ ì˜¨ë„ì™€ ë‚ ì”¨ê°€ ë§¤ìš° ë‹¤ë¥´ë©´ ì´ ë ˆë²¨ ê±°ë¦¬ê°€ ì»¤ì§‘ë‹ˆë‹¤. ë‹¤ë¥¸ ê³„ì ˆ ìŒì— ëŒ€í•´ì„œë„ ì´ë¥¼ ë°˜ë³µí•˜ê³  ë‹¤ì°¨ì› ìŠ¤ì¼€ì¼ë§ì„ í†µí•´ ê±°ë¦¬ í–‰ë ¬ì„ 1ì°¨ì›ìœ¼ë¡œ ì¶•ì†Œí•©ë‹ˆë‹¤. 

## 4. Examples

ALE plot ì‹¤ìŠµì„ ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤. PDPê°€ ì‹¤íŒ¨í•˜ëŠ” ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì§œë³´ì•˜ìŠµë‹ˆë‹¤. ê°•í•œ ìƒê´€ê´€ê³„ê°€ ìžˆëŠ” ë‘ ê°œì˜ í”¼ì³ì™€ ì˜ˆì¸¡ ëª¨ë¸ë¡œ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤. ì˜ˆì¸¡ ëª¨ë¸ì€ ì„ í˜• íšŒê·€ ëª¨ë¸ì´ì§€ë§Œ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê´€ì°°í•œ ì ì´ ì—†ëŠ” ë‘ í”¼ì³ ì¡°í•©ì—ì„œ ì´ìƒí•œ ì¼ì´ ë°œìƒí•©ë‹ˆë‹¤ : 
![](Pasted%20image%2020240102142900.png) Figure 8.9 : ë‘ ê°€ì¹˜ í”¼ì³ì™€ ì˜ˆì¸¡ì¹˜. ì´ ëª¨ë¸ì€ ë‘ í”¼ì³ì˜ í•©ì„ ì˜ˆì¸¡í•˜ì§€ë§Œ, x1 > 0.7 & x2 < 0.3 ì´ë¨„ í•­ìƒ 2ë¥¼ ì˜ˆì¸¡í•©ë‹ˆë‹¤. ì´ ì˜ì—­ì€ ë°ì´í„° ë¶„í¬ì™€ ëŠ” ê±°ë¦¬ê°€ ë©€ê¸° ë•Œë¬¸ì— ëª¨ë¸ ì„±ëŠ¥ì— ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šìœ¼ë©°, í•´ì„ì— ì˜í–¥ì„ ë¯¸ì¹˜ë©´ ì•ˆë©ë‹ˆë‹¤. 

ëª¨ë¸ì„ í•™ìŠµí•  ë•Œ ì•Œê³ ë¦¬ì¦˜ì€ í•™ìŠµ ë°ì´í„° ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•œ ì†ì‹¤ì„ ìµœì†Œí™”í•©ë‹ˆë‹¤. í•™ìŠµ ë°ì´í„° ë¶„í¬ ì™¸ë¶€ì—ì„œëŠ” ì´ìƒí•œ ì¼ì´ ë°œìƒí•  ìˆ˜ ìžˆì§€ë§Œ, ì´ëŸ¬í•œ ì˜ì—­ì—ì„œ ì´ìƒí•œ ì¼ì´ ë°œìƒí•´ë„ ëª¨ë¸ì— ë¶ˆì´ìµì´ ê°€í•´ì§€ì§€ ì•Šê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤. ë°ì´í„° ë¶„í¬ì—ì„œ ë²—ì–´ë‚˜ëŠ” ê²ƒì„ ì™¸ì‚½(extrapolation)ì´ë¼ê³  í•˜ë©°, ì´ëŠ” 10.4 ì„¹ì…˜ì—ì„œ ë‹¤ë£¨ëŠ” ê²ƒì²˜ëŸ¼ ML ëª¨ë¸ì„ ì†ì´ëŠ” ë°ì—ë„ ì“°ì¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì•„ëž˜ ê·¸ë¦¼ì—ì„œ PDPì™€ ALE plotì´ ì–´ë–»ê²Œ ìž‘ë™í•˜ëŠ”ì§€ë¥¼ ë¹„êµí•´ ë³´ê² ìŠµë‹ˆë‹¤ : 
![](Pasted%20image%2020240102143815.png) Figure 8.10 : PDPì™€ ALEë¡œ ê³„ì‚°ëœ í”¼ì³íš¨ê³¼ì˜ ë¹„êµ. PDPëŠ” ë°ì´í„° ë¶„í¬ë¥¼ ë²—ì–´ë‚œ ëª¨ë¸ì˜ ì´ìƒí•œ ë™ìž‘(ì í”„)ì˜ ì˜í–¥ì„ ë°›ìŠµë‹ˆë‹¤. ALE plotì€ ML ëª¨ë¸ì´ ë°ì´í„°ê°€ ì—†ëŠ” ì˜ì—­ì„ ë¬´ì‹œí•˜ê³  í”¼ì³ì™€ ì˜ˆì¸¡ì¹˜ ê°„ ì„ í˜• ê´€ê³„ê°€ ìžˆìŒì„ ì •í™•ížˆ ì‹ë³„í•©ë‹ˆë‹¤. 

ì´ë ‡ê²Œ ê·¹ë‹¨ì ì¸ ì™¸ì‚½ì´ ë¹„í˜„ì‹¤ì ìœ¼ë¡œ ë³´ì¼ ìˆ˜ ìžˆì§€ë§Œ, test setì˜ ë¶„í¬ëŠ” ì•½ê°„ ë‹¤ë¥¼ ìˆ˜ ìžˆê³  ì¼ë¶€ ì¸ìŠ¤í„´ìŠ¤ê°€ ì‹¤ì œë¡œ ì´ìƒí•œ ë²”ìœ„ì— í¬í•¨ë  ìˆ˜ ìžˆê¸° ë•Œë¬¸ì— í”¼ì³ íš¨ê³¼ ê³„ì‚°ì— í”¼ì³ íš¨ê³¼ ê³„ì‚°ì— ì´ëŸ¬í•œ ì˜ì—­ì„ í¬í•¨ì‹œí‚¤ëŠ” ê²ƒì´ ì˜³ì€ ê²ƒìœ¼ë¡œ ë³´ì¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì•„ì§ ê´€ì°°í•˜ì§€ ì•Šì€ ì˜ì—­ì„ í¬í•¨ì‹œí‚¤ëŠ” ê²ƒì€ ì‹ ì¤‘í•´ì•¼ í•˜ë©°, PDPì™€ ê°™ì´ í•˜ë©´ ì•ˆë©ë‹ˆë‹¤. ëª¨ë¸ì´ ë‹¤ë¥¸ ë¶„í¬ë¥¼ ê°–ëŠ” ë°ì´í„°ì™€ ì‚¬ìš©ë  ê²½ìš° ALE plotì„ ì‚¬ìš©í•˜ì—¬ ì˜ˆìƒë˜ëŠ” ë°ì´í„°ì˜ ë¶„í¬ë¥¼ ì‹œë®¬ë ˆì´ì…˜í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. 

ì´ì œ ì‹¤ì œ ë°ì´í„°ì…‹ìœ¼ë¡œ ì „í™˜í•´ì„œ, ë‚ ì”¨ì™€ ìš”ì¼ì— ë”°ë¼ ìžì „ê±° ëŒ€ì—¬ ìˆ˜ë¥¼ ì˜ˆì¸¡í•˜ê³  ALE plotì´ ìž˜ ìž‘ë™í•˜ëŠ”ì§€ í™•ì¸í•´ ë³´ê² ìŠµë‹ˆë‹¤. CARTë¥¼ í›ˆë ¨í•˜ì—¬ ì£¼ì–´ì§„ ë‚ ì§œì— ëŒ€ì—¬ ìˆ˜ë¥¼ ì˜ˆì¸¡í•˜ê³ , ì˜¨ë„, ìƒëŒ€ ìŠµë„ ë° í’ì†ì´ ì˜ˆì¸¡ì¹˜ì— ì–´ë–¤ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ”ì§€ ë¶„ì„í•´ ë³´ê² ìŠµë‹ˆë‹¤ : 

![](Pasted%20image%2020240102152957.png) Figure 8.11 : ì˜¨ë„ëŠ” ì˜ˆì¸¡ì¹˜ì— í° ì˜í–¥ì„ ë¯¸ì¹©ë‹ˆë‹¤. í‰ê·  ì˜ˆì¸¡ì¹˜ëŠ” ì˜¨ë„ê°€ ìƒìŠ¹í•¨ì— ë”°ë¼ ì¦ê°€í•˜ì§€ë§Œ ì„­ì”¨ 25ë„ ì´ìƒì—ì„œëŠ” ë‹¤ì‹œ í•˜ë½í•©ë‹ˆë‹¤. ìŠµë„ëŠ” ë¶€ì •ì ì¸ ì˜í–¥ì„ ë¯¸ì¹©ë‹ˆë‹¤ : 60% ì´ìƒì¼ ë•Œ ìƒëŒ€ ìŠµë„ê°€ ë†’ì„ìˆ˜ë¡ ì˜ˆì¸¡ì¹˜ê°€ ë‚®ì•„ì§‘ë‹ˆë‹¤. í’ì†ì€ ì˜ˆì¸¡ì¹˜ì— í° ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•ŠìŠµë‹ˆë‹¤. 

ì˜¨ë„, ìŠµë„, í’ì†ê³¼ ë‹¤ë¥¸ ëª¨ë“  í”¼ì³ ê°„ ìƒê´€ê´€ê³„ë¥¼ ì‚´íŽ´ë³´ê² ìŠµë‹ˆë‹¤. ë°ì´í„°ì—ëŠ” ë²”ì£¼í˜• í”¼ì³ë„ ìžˆìœ¼ë¯€ë¡œ í”¼ì–´ìŠ¨ ìƒê´€ ê³„ìˆ˜ë§Œì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ëŒ€ì‹  ë‹¤ë¥¸ í”¼ì³ ì¤‘ í•˜ë‚˜ë¥¼ ìž…ë ¥ìœ¼ë¡œ í•˜ì—¬ ì˜¨ë„ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ì„ í˜• ëª¨ë¸ì„ í›ˆë µì‹œí‚¨ ë‹¤ìŒ ì„ í˜• ëª¨ë¸ì—ì„œ ë‹¤ë¥¸ í”¼ì³ê°€ ì„¤ëª…í•˜ëŠ” ë¶„ì‚°ì´ ì–¼ë§ˆë‚˜ ë˜ëŠ”ì§€ ì¸¡ì •í•˜ê³  ì œê³±ê·¼ì„ êµ¬í•©ë‹ˆë‹¤. ì´ëŠ” ìˆ«ìží˜• í”¼ì³ë¥¼ ìž…ë ¥ìœ¼ë¡œ í•  ì‹œ í‘œì¤€ í”¼ì–´ìŠ¨ ìƒê´€ ê³„ìˆ˜ì˜ ì ˆëŒ€ê°’ê³¼ ë™ì¼í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ model-based  ë°©ì‹ì˜ ë¶„ì‚° ì„¤ëª…(ANOVA)ì€ ë‹¤ë¥¸ í”¼ì³ê°€ ë²”ì£¼í˜•ì¼ ë•Œë„ ìž‘ë™í•©ë‹ˆë‹¤. ë‹¤ë¥¸ ëª¨ë“  í”¼ì³ë“¤ê³¼ í•¨ê»˜ ì˜¨ë„, ìŠµë„, í’ì†ì˜ ì„¤ëª… ë¶„ì‚°ëŸ‰ì„ ê³„ì‚°í•˜ê² ìŠµë‹ˆë‹¤. ì„¤ëª… ë¶„ì‚°(ìƒê´€ê´€ê³„)ì´ ë†’ì„ìˆ˜ë¡ PDP ì‚¬ìš© ì‹œ ë¬¸ì œê°€ ì»¤ì§ì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ì•„ëž˜ ê·¸ë¦¼ì€ ë‚ ì”¨ê°€ ë‹¤ë¥¸ í”¼ì³ë“¤ê³¼ ì–¼ë§ˆë‚˜ ê°•í•œ ìƒê´€ê´€ê³„ë¥¼ ê°–ëŠ”ì§€ë¥¼ ì‹œê°í™”í•œ ê²ƒìž…ë‹ˆë‹¤. 
![](Pasted%20image%2020240102153155.png) Figure 8.12 : ì˜¨ë„, ìŠµë„ ë° í’ì†ê³¼ ëª¨ë“  í”¼ì³ ê°„ ìƒê´€ê´€ê³„ì˜ ê°•ë„ë¥¼ ì„¤ëª… ë¶„ì‚°ëŸ‰ìœ¼ë¡œ ì¸¡ì •í•œ ê²ƒìž…ë‹ˆë‹¤. 

ì´ëŸ¬í•œ ìƒê´€ê´€ê³„ ë¶„ì„ì„ í†µí•´ íŠ¹ížˆ ì˜¨ë„ì˜ ê²½ìš° PDPì— ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìžˆìŒì„ ì•Œ ìˆ˜ ìžˆìŠµë‹ˆë‹¤ : 
![](Pasted%20image%2020240102153216.png) Figure 8.13 : ì˜¨ë„, ìŠµë„, í’ì†ì— ëŒ€í•œ PDP. ALE plotê³¼ ë¹„êµí–ˆì„ ë•Œ, PDPëŠ” ê³ ì˜¨ ë˜ëŠ” ê³ ìŠµë„ì—ì„œ ì˜ˆì¸¡ ëŒ€ì—¬ ìˆ˜ê°€ ë” ì ê²Œ ê°ì†Œí•˜ëŠ” ê²ƒì„ ë³´ì—¬ì¤ë‹ˆë‹¤. PDPëŠ” ì˜ˆë¥¼ ë“¤ì–´ ê³„ì ˆì´ "ê²¨ìš¸"ì¸ ì¸ìŠ¤í„´ìŠ¤ì¼ì§€ë¼ê³  ê³ ì˜¨, ê³ ìŠµë„ì˜ ì˜í–¥ì„ ê³„ì‚°í•˜ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤. ALE plotì´ ë” ì‹ ë¢°ì„±ì´ ìžˆìŠµë‹ˆë‹¤. 

ë‹¤ìŒìœ¼ë¡œ ë²”ì£¼í˜• í”¼ì³ì— ëŒ€í•œ ALE plotì„ ì‚´íŽ´ë³´ê² ìŠµë‹ˆë‹¤. ì›”(`mnth`)ì´ ì˜ˆì¸¡ ëŒ€ì—¬ ìˆ˜ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ ë³´ê² ìŠµë‹ˆë‹¤. `mnth`ëŠ” ì´ë¯¸ í”¼ì³ ìˆœì„œë¡œ ì •ë ¬ë˜ì–´ ìžˆì§€ë§Œ, ë¨¼ì € ìœ ì‚¬ì„±ë³„ë¡œ ë‹¤ì‹œ ì •ë ¬í•œ ë‹¤ìŒ íš¨ê³¼ë¥¼ ê³„ì‚°í•˜ë©´ ì–´ë–¤ì§€ ë³´ê² ìŠµë‹ˆë‹¤. `mnth`ì„ ì˜¨ë„ ë˜ëŠ” íœ´ì¼ ì—¬ë¶€ì™€ ê°™ì€ ë‹¤ë¥¸ í”¼ì³ë“¤ì„ ê¸°ì¤€ìœ¼ë¡œ ê° ì›”ì˜ ìœ ì‚¬ë„ì— ë”°ë¼ ì •ë ¬ë©ë‹ˆë‹¤. 
![](Pasted%20image%2020240102153944.png) Figure 8.14 : ì›”ë³„ ë‹¤ë¥¸ í”¼ì³ ë¶„í¬ë¥¼ ê¸°ì¤€ìœ¼ë¡œ `mnth`ëŠ” ì„œë¡œì˜ ìœ ì‚¬ì„±ì— ë”°ë¼ ì •ë ¬ë©ë‹ˆë‹¤. 1ì›”, 3ì›”, 4ì›”, ê·¸ë¦¬ê³  íŠ¹ížˆ 11ì›”, 12ì›”ì€ ë‹¤ë¥¸ ì›”ì— ë¹„í•´ ì˜ˆì¸¡ì¹˜ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì´ ë” ë‚®ìŠµë‹ˆë‹¤. 

ë§Žì€ í”¼ì³ê°€ ë‚ ì”¨ì™€ ê´€ë ¨ì´ ìžˆê¸° ë•Œë¬¸ì— ì›”ë³„ ìˆœì„œëŠ” í•´ë‹¹ ì›”ì˜ ë‚ ì”¨ê°€ ì–¼ë§ˆë‚˜ ë¹„ìŠ·í•œì§€ë¥¼ ê°•í•˜ê²Œ ë°˜ì˜í•˜ê³  ìžˆìŠµë‹ˆë‹¤. ì¶”ìš´ ë‹¬ì€ ì™¼ìª½(2~4ì›”)ì—, ë”°ë“¯í•œ ë‹¬ì€ ì˜¤ë¥¸ìª½(10ì›” ~ 8ì›”)ì— í‘œì‹œë©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ê³µíœ´ì¼ì˜ ìƒëŒ€ì  ë¹ˆë„ëŠ” ì›”ë³„ ìœ ì‚¬ì„± ê³„ì‚° ì‹œ ì˜¨ë„ì™€ ë™ì¼í•œ ê°€ì¤‘ì¹˜ë¥¼ ê°–ëŠ” ë“± ë‚ ì”¨ ì™¸ì ì¸ ìš”ì†Œë„ ìœ ì‚¬ì„± ê³„ì‚°ì— í¬í•¨ë¨ì„ ìœ ë…í•˜ì„¸ìš”.

ë‹¤ìŒìœ¼ë¡œ ìŠµë„ì™€ ì˜¨ë„ê°€ ì˜ˆì¸¡ ëŒ€ì—¬ ìˆ˜ì— ë¯¸ì¹˜ëŠ” 2ì°¨ íš¨ê³¼ë¥¼ ê³ ë ¤í•´ ë³´ê² ìŠµë‹ˆë‹¤. 2ì°¨ íš¨ê³¼ëŠ” ë‘ í”¼ì³ì˜ ì¶”ê°€ì ì¸ ìƒí˜¸ìž‘ìš© íš¨ê³¼ì´ë©°, ì£¼íš¨ê³¼ëŠ” í¬í•¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¦‰, ì˜ˆë¥¼ ë“¤ì–´ ìŠµë„ê°€ ë†’ìœ¼ë©´ í‰ê· ì ìœ¼ë¡œ ì˜ˆì¸¡ ëŒ€ì—¬ ìˆ˜ê°€ ì¤„ì–´ë“ ë‹¤ëŠ” ì£¼íš¨ê³¼ëŠ” 2ì°¨ ALE plotì—ì„œ ë³¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. 
![](Pasted%20image%2020240102155200.png) Figure 8.15 : ë°ì€ ìƒ‰ì€ ì£¼ íš¨ê³¼ë¥¼ ì´ë¯¸ ê³ ë ¤í–ˆì„ ë•Œ í‰ê· ë³´ë‹¤ ë†’ì€ ì˜ˆì¸¡ì¹˜ë¥¼, ì–´ë‘ìš´ ìƒ‰ì€ í‰ê· ë³´ë‹¤ ë‚®ì€ ì˜ˆì¸¡ì¹˜ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ë¥ê³  ìŠµí•œ ë‚ ì”¨ ì˜ˆì¸¡ì„ ì¦ê°€ì‹œí‚¤ê³ , ì¶¥ê³  ìŠµí•œ ë‚ ì”¨ëŠ” ì˜ˆì¸¡ ëŒ€ì—¬ ìˆ˜ì— ì¶”ê°€ì ì¸ ìŒì˜ ì˜í–¥ì„ ë¼ì¹©ë‹ˆë‹¤.


ìŠµë„ì™€ ì˜¨ë„ì˜ ì£¼íš¨ê³¼ëŠ” ëª¨ë‘ ë§¤ìš° ë¥ê³  ìŠµí•œ ë‚ ì”¨ì—ì„œ ì˜ˆì¸¡ ëŒ€ì—¬ ìˆ˜ê°€ ê°ì†Œí–ˆë‹¤ëŠ” ê²ƒì„ ìœ ì˜í•˜ì„¸ìš”. ë¥ê³  ìŠµí•œ ë‚ ì”¨ì— ì˜¨ë„ì™€ ìŠµë„ì˜ (ì£¼íš¨ê³¼ì˜ í•©ì´ ì•„ë‹ˆë¼ ) ìƒí˜¸ìž‘ìš© íš¨ê³¼ëŠ” ì£¼íš¨ê³¼ í•©ë³´ë‹¤ í½ë‹ˆë‹¤. ìˆœìˆ˜í•œ 2ì°¨ íš¨ê³¼(2D ALE plot)ì™€ ì´ íš¨ê³¼ì˜ ì°¨ì´ë¥¼ ê°•ì¡°í•˜ê¸° ìœ„í•´ PDPë¥¼ ì‚´íŽ´ë³´ê² ìŠµë‹ˆë‹¤. PDPëŠ” í‰ê·  ì˜ˆì¸¡ì¹˜ì™€ ë‘ ê°œì˜ ì£¼ íš¨ê³¼ ë° 2ì°¨ (ìƒí˜¸ìž‘ìš©)íš¨ê³¼ë¥¼ ê²°í•©í•œ ì´ íš¨ê³¼ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤. 
![](Pasted%20image%2020240102155815.png) Figure 8.16 : ì˜¨ë„ì™€ ìŠµë„ê°€ ì˜ˆì¸¡ ëŒ€ì—¬ ìˆ˜ì— ë¯¸ì¹˜ëŠ” ì´ íš¨ê³¼(total effect)ì˜ PDPìž…ë‹ˆë‹¤. ì´ í”Œë¡¯ì€ ìƒí˜¸ìž‘ìš© íš¨ê³¼ë§Œ ë³´ì—¬ì£¼ëŠ” 2D-ALE plotê³¼ ë‹¬ë¦¬ ê° í”¼ì³ì˜ ì£¼íš¨ê³¼ì™€ ìƒí˜¸ìž‘ìš© íš¨ê³¼ë¥¼ ê²°í•©í•©ë‹ˆë‹¤. 

ìƒí˜¸ìž‘ìš©ì—ë§Œ ê´€ì‹¬ì´ ìžˆëŠ” ê²½ìš°, ì´ íš¨ê³¼ëŠ” ì£¼ íš¨ê³¼ë¥¼ í˜¼í•©í•´ í”Œë¡¯ì— í¬í•¨í•˜ë¯€ë¡œ 2ì°¨íš¨ê³¼ë¥¼ ì‚´íŽ´ë³´ì•„ì•¼ í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ í”¼ì³ì˜ ê²°í•© íš¨ê³¼(combined effect)ë¥¼ ì•Œê³  ì‹¶ë‹¤ë©´ ì´ íš¨ê³¼(PDP)ë¥¼ ì‚´íŽ´ë´ì•¼ í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì„­ì”¨ 30ë„, ìŠµë„ 80%ì—ì„œ ì˜ˆìƒë˜ëŠ” ìžì „ê±° ëŒ€ì—¬ ìˆ˜ë¥¼ ì•Œê³  ì‹¶ë‹¤ë©´ 2D-PDPì—ì„œ ì§ì ‘ ì½ì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ALE plot ì—ì„œ ë™ì¼í•œ ì •ë³´ë¥¼ ì½ìœ¼ë ¤ë©´ 3ê°€ì§€ í”Œë¡¯ì„ ì‚´íŽ´ë³´ì•„ì•¼ í•©ë‹ˆë‹¤ : ì˜¨ë„, ìŠµë„, ì˜¨ë„ + ìŠµë„ì— ëŒ€í•œ ALE plot & ì „ì²´ í‰ê·  ì˜ˆì¸¡ì¹˜. 

ì´ì œ ë¶„ë¥˜ ìž‘ì—…ì„ ìœ„í•´ ìžê¶ê²½ë¶€ì•” ë°œìƒ í™•ë¥ ì„ ì˜ˆì¸¡í•˜ê¸° ìœ„í•´ random forestë¥¼ í•™ìŠµì‹œí‚¤ê² ìŠµë‹ˆë‹¤. 2ê°€ì§€ í”¼ì³ì— ëŒ€í•˜ ALE plotì„ ê·¸ë ¤ë³´ê² ìŠµë‹ˆë‹¤ : 
![](Pasted%20image%2020240102160714.png) Figure 8.17 : ìžê¶ê²½ë¶€ì•” ì˜ˆì¸¡ í™•ë¥ ì— ëŒ€í•œ ë‚˜ì´ì™€ í˜¸ë¥´ëª¬ í”¼ìž„ì•½ ë³µìš© ê¸°ê°„ì´ ë¯¸ì¹˜ëŠ” ì˜í–¥ì— ëŒ€í•œ ALE plotìž…ë‹ˆë‹¤. ë‚˜ì´ì˜ ALE plotì€ ì˜ˆì¸¡ ì•” í™•ë¥ ì´ í‰ê· ì ìœ¼ë¡œ 40ì„¸ê¹Œì§€ ë‚®ê³  ê·¸ ì´í›„ì—ëŠ” ì¦ê°€í•¨ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. í˜¸ë¥´ëª¬ í”¼ìž„ì•½ ë³µìš©ê¸°ê°„ì´ ê¸¸ìˆ˜ë¡ 8ë…„ í›„ ì˜ˆì¸¡ ì•” ìœ„í—˜ì´ ë†’ì•„ì§€ëŠ” ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚©ë‹ˆë‹¤. 

ë‹¤ìŒìœ¼ë¡œ ìž„ì‹  íšŸìˆ˜ì™€ ì—°ë ¹ ê°„ ìƒí˜¸ìž‘ìš©ì„ ì‚´íŽ´ë³´ê² ìŠµë‹ˆë‹¤ : 
![](Pasted%20image%2020240102161311.png) Figure 8.18 : ìž„ì‹  íšŸìˆ˜ì™€ ì—°ë ¹ì˜ 2ì°¨ íš¨ê³¼ì— ëŒ€í•œ ALE plotìž…ë‹ˆë‹¤. ì´ í”Œë¡¯ì˜ í•´ì„ì€ ê³¼ì í•©ëœ ê²ƒìœ¼ë¡œ ë³´ìž…ë‹ˆë‹¤. 18~20ì„¸ì˜ ë‚˜ì´ì™€ 3íšŒ ì´ìƒì˜ ìž„ì‹ íšŸìˆ˜ì—ì„œ ì´ìƒí•œ ëª¨ë¸ ë™ìž‘(ì•” í™•ë¥ ì´ ìµœëŒ€ 5% ì¦ê°€)ì„ ë³´ìž…ë‹ˆë‹¤. ë°ì´í„°ì—ëŠ” ì´ëŸ¬í•œ ì—°ë ¹ê³¼ ìž„ì‹ íšŸìˆ˜ë¥¼ ê°€ì§„ ì—¬ì„±ì´ ë§Žì§€ ì•Šìœ¼ë¯€ë¡œ, í•™ìŠµ ì¤‘ì— ì´ëŸ¬í•œ ì—¬ì„±ì— ëŒ€í•´ ì‹¤ìˆ˜ë¥¼ í•´ë„ ëª¨ë¸ì´ ì‹¬ê°í•œ ë¶ˆì´ìµì„ ë°›ì§€ ì•ŠìŠµë‹ˆë‹¤. 

## 5. Advantages

- **ALE plot are unbiased** : ALE plotì€ ë¹„íŽ¸í–¥ì´ë¯€ë¡œ í”¼ì³ê°„ ìƒí˜¸ ì—°ê´€ëœ ê²½ìš°ì—ë„ ìž˜ ìž‘ë™í•©ë‹ˆë‹¤. PDPëŠ” ë¹„í˜„ì‹¤ì ì¸ ì™¸ì‚½ì„ ë¬´ì‹œí•˜ê³  ì´ ì¡°ì°¨ë„ ì´ìš©í•˜ê¸° ë•Œë¬¸ì— ì‹¤íŒ¨í•˜ëŠ” ì¼€ì´ìŠ¤ìž…ë‹ˆë‹¤. 
- **ALE plots are faster to compute** : ALE plotì€ ê°€ëŠ¥í•œ ìµœëŒ€ ê°„ê²©ì˜ ìˆ˜ê°€ ì¸ìŠ¤í„´ìŠ¤ ë‹¹ í•˜ë‚˜ì˜ ê°„ê²©ì´ ìžˆëŠ” ìˆ˜ ì´ê¸° ë•Œë¬¸ì— PDPë³´ë‹¤ ê³„ì‚° ì†ë„ê°€ ë¹ ë¥´ë©° $O(n)$ ìœ¼ë¡œ í™•ìž¥í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. PDPëŠ” grid point ì¶”ì • íšŸìˆ˜ì˜ $n$ ë°°ê°€ í•„ìš”í•©ë‹ˆë‹¤. Grid points ê°€ 20ê°œì¸ ê²½ìš°, PDPëŠ” ì¸ìŠ¤í„´ìŠ¤ ìˆ˜ë§Œí¼ì˜ ê°„ê²©ì´ ì‚¬ìš©ë˜ëŠ” ìµœì•…ì˜ ê²½ìš°ì¸ ALE plotë³´ë‹¤ 20ë°° ë” ë§Žì€ ì˜ˆì¸¡ì¹˜ê°€ í•„ìš”í•©ë‹ˆë‹¤. 
- **The interpretation of ALE plots is clear** : ì£¼ì–´ì§„ ê°’ì— ì¡°ê±´ë¶€ë¡œ í”¼ì³ê°’ì„ ë³€ê²½í•˜ëŠ” ê²ƒì´ ì˜ˆì¸¡ì— ë¯¸ì¹˜ëŠ” ìƒëŒ€ì ì¸ ì˜í–¥ì„ ALE plotì—ì„œ ì½ì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ALE plotì˜ ì¤‘ì•™ì€ 0ìž…ë‹ˆë‹¤. ALE curveì˜ ê° ì§€ì ì—ì„œì˜ ê°’ì´ í‰ê·  ì˜ˆì¸¡ì¹˜ì™€ì˜ ì°¨ì´ì´ê¸° ë•Œë¬¸ì— í•´ì„ì´ ìš©ì´í•©ë‹ˆë‹¤. 2D-ALE plotì€ ìƒí˜¸ìž‘ìš©ë§Œ ë³´ì—¬ì¤ë‹ˆë‹¤ : ë‘ í”¼ì³ê°€ ìƒí˜¸ìž‘ìš©í•˜ì§€ ì•Šìœ¼ë©´ í”Œë¡¯ì— ì•„ë¬´ê²ƒë„ í‘œì‹œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. 
- Functional decomposition ì±•í„°ì—ì„œ ì„¤ëª…í•  ê²ƒ ë‚´ìš©ìœ¼ë¡œ, ì „ì²´ ì˜ˆì¸¡ í•¨ìˆ˜ëŠ” ì €ì°¨ì› ALE í•¨ìˆ˜ì˜ í•©ìœ¼ë¡œ ë¶„í•´í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 
- ëŒ€ì²´ë¡œ í”¼ì³ë“¤ ê°„ì—ëŠ” ì–´ëŠì •ë„ì˜ ìƒê´€ê´€ê³„ê°€ ìžˆê¸° ë•Œë¬¸ì— PDPë³´ë‹¤ëŠ” ALE plotì„ ë” ì„ í˜¸í•©ë‹ˆë‹¤. 

## 6. Disadvantages

- í”¼ì³ ê°„ ìƒê´€ê´€ê³„ê°€ ê°•í•  ê²½ìš° **êµ¬ê°„ ì‚¬ì´ì˜ íš¨ê³¼ë¥¼ í•´ì„í•˜ëŠ” ê²ƒì€ ì•ˆë©ë‹ˆë‹¤**. í”¼ì³ ê°„ ìƒê´€ê´€ê³„ê°€ ë†’ê³  1D-ALE plotì˜ ì™¼ìª½ ëì„ ë³´ê³  ìžˆëŠ” ê²½ìš°ë¥¼ ê³ ë ¤í•´ ë³´ê² ìŠµë‹ˆë‹¤. ALE plotì€ ë‹¤ìŒê³¼ ê°™ì€ ì˜¤í•´ë¥¼ ë¶€ë¥¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤ : "ALE curveëŠ” ë°ì´í„° ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•œ ê° í”¼ì³ ê°’ì„ ì ì§„ì ìœ¼ë¡œ ë³€ê²½í•˜ê³  ë‹¤ë¥¸ í”¼ì³ ê°’ì„ ê³ ì •ì‹œí‚¬ ë•Œ ì˜ˆì¸¡ì¹˜ê°€ í‰ê· ì ìœ¼ë¡œ ì–´ë–»ê²Œ ë³€í•˜ëŠ”ì§€ë¥¼ ë³´ì—¬ì¤€ë‹¤." íš¨ê³¼ëŠ” êµ¬ê°„(local)ë³„ë¡œ ê³„ì‚°ë˜ë¯€ë¡œ íš¨ê³¼ì˜ í•´ì„ì€ ë¡œì»¬ì—ì„œë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤. 
- í”¼ì³ê°„ ìƒê´€ê´€ê³„ê°€ ìžˆì„ ë•Œ ALE effectëŠ” ì„ í˜• íšŒê·€ ëª¨ë¸ì— ì§€ì •ëœ ê³„ìˆ˜ì™€ ë‹¤ë¥¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. GrÃ¶mping (2020)ëŠ” 2ê°œì˜ ìƒí˜¸ ì—°ê´€ëœ í”¼ì³ì™€ ì¶”ê°€ì ì¸ ìƒí˜¸ ìž‘ìš© í•­ ($\hat{f}(x)=\beta_0+\beta_1 x_1+\beta_2 x_2+\beta_3 x_1 x_2$)ì´ ìžˆëŠ” ì„ í˜• ëª¨ë¸ì—ì„œ 1ì°¨ ALE plotì´ ì§ì„ ì„ ë‚˜íƒ€ë‚´ì§€ ì•ŠìŒì„ ë³´ì˜€ìŠµë‹ˆë‹¤. ëŒ€ì‹ , í”¼ì³ì˜ ê³±ì…ˆ ìƒí˜¸ ìž‘ìš©ì„ í¬í•¨í•˜ê¸° ë•Œë¬¸ì— ì•½ê°„ ê³¡ì„ ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤. ì—¬ê¸°ì„œ ì¼ì–´ë‚˜ëŠ” ì¼ì— ëŒ€í•´ ìžì„¸ížˆ ì•Œê³  ì‹¶ë‹¤ë©´ Function decomposition ì±•í„°ì—ì„œ ì•Œ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì§§ê²Œ ë§í•˜ìžë©´, ALEëŠ” ì„ í˜• ê³µì‹ì´ ì„¤ëª…í•˜ëŠ” ê²ƒê³¼ëŠ” ë‹¤ë¥´ê²Œ 1ì°¨ íš¨ê³¼ë¥¼ ì •ì˜í•©ë‹ˆë‹¤. ì´ëŠ” ìž˜ëª»ëœ ê²ƒì€ ì•„ë‹ˆì§€ë§Œ í™•ì‹¤ížˆ ì§ê´€ì— ë²—ì–´ë‚©ë‹ˆë‹¤.
- ALE plotì€ ê°„ê²©ì´ ë§Žìœ¼ë©´ **ì•½ê°„ í”ë“¤ë¦´ ìˆ˜ ìžˆìŠµë‹ˆë‹¤ (ìž‘ì€ ê¸°ë³µì´ ë§ŽìŒ)**. ì´ ê²½ìš° ê°„ê²© ìˆ˜ë¥¼ ì¤„ì´ë©´ ì¶”ì •ì¹˜ëŠ” ì•ˆì •ì ì´ê²Œ ë˜ì§€ë§Œ, ì˜ˆì¸¡ ëª¨ë¸ì˜ ì‹¤ì œ ë³µìž¡ì„±ì„ ë‚®ì¶°ì„œ ë³´ì¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ê°„ê²© ìˆ˜ë¥¼ ì •í•˜ëŠ” ë° ì™„ë²½í•œ í•´ê²°ì±…ì€ ì—†ìŠµë‹ˆë‹¤. ê°„ê²©ì˜ ìˆ˜ê°€ ë„ˆë¬´ ìž‘ìœ¼ë©´ ALE plotì´ ì •í™•í•˜ì§€ ì•Šì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ë°˜ëŒ€ë¡œ ë„ˆë¬´ ë§Žìœ¼ë©´ ê³¡ì„ ì´ í”ë“¤ë¦´ ìœ„í—˜ì´ ìžˆìŠµë‹ˆë‹¤. 
- PDPì™€ ë‹¬ë¦¬ **ALE plotì—ëŠ” ICE curves ê°€ ë™ë°˜ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤**. PDPì˜ ê²½ìš° ICE curveëŠ” í”¼ì³ íš¨ê³¼ì˜ ì´ì§ˆì„±(heterogeneity), ì¦‰ í”¼ì³ íš¨ê³¼ê°€ ë°ì´í„° í•˜ìœ„ì§‘í•©ì— ë”°ë¼ ë‹¤ë¥´ê²Œ ë‚˜íƒ€ë‚˜ëŠ” ê²ƒì„ í‘œí˜„í•  ìˆ˜ ìžˆê¸° ë•Œë¬¸ì— ìœ ìš©í•©ë‹ˆë‹¤. ALE plotì€ ì¸ìŠ¤í„´ìŠ¤ ê°„ íš¨ê³¼ê°€ ë‹¤ë¥¸ì§€ ì—¬ë¶€ëŠ” êµ¬ê°„ë³„ë¡œë§Œ í™•ì¸í•  ìˆ˜ ìžˆì§€, ê° êµ¬ê°„ë§ˆë‹¤ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ê°€ ìžˆìœ¼ë¯€ë¡œ ICE curveì™€ ê°™ì§€ ì•ŠìŠµë‹ˆë‹¤. 
- **2ì°¨ ALE ì¶”ì •ì¹˜ëŠ” í”¼ì³ ê³µê°„ ì „ì²´ì— ê±¸ì³ ë‹¤ì–‘í•œ ì•ˆì •ì„±ì„ ê°€ì§€ë©°, ì´ëŠ” ì–´ë–¤ ë°©ì‹ìœ¼ë¡œë„ ì‹œê°í™”ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤**. ê·¸ ì´ìœ ëŠ” ì…€ì˜ ë¡œì»¬ íš¨ê³¼ì— ëŒ€í•œ ê° ì¶”ì •ì¹˜ê°€ ì„œë¡œ ë‹¤ë¥¸ ìˆ˜ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤. ê²°ê³¼ì ìœ¼ë¡œ ëª¨ë“  ì¶”ì •ì¹˜ì˜ ì •í™•ë„ê°€ ë‹¬ë¦¬ì§‘ë‹ˆë‹¤(í•˜ì§€ë§Œ ì—¬ì „ížˆ ìµœê³ ì˜ ì¶”ì •ì¹˜ìž„). ì´ ë¬¸ì œëŠ” ì£¼íš¨ê³¼ ALE plotì˜ ê²½ìš° ëœí•©ë‹ˆë‹¤. ì‚¬ë¶„ìœ„ìˆ˜ gridë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ëª¨ë“  êµ¬ê°„ì˜ ì¸ìŠ¤í„´ìŠ¤ ìˆ˜ëŠ” ë™ì¼í•˜ì§€ë§Œ, ì¼ë¶€ ì˜ì—­ì—ì„œëŠ” ì§§ì€ êµ¬ê°„ì´ ë§Žì•„ì„œ ALE curveê°€ ë” ë§Žì€ ì¶”ì •ì¹˜ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì „ì²´ ê³¡ì„ ì˜ í° ë¶€ë¶„ì„ ì°¨ì§€í•  ìˆ˜ ìžˆëŠ” ê¸´ ê°ê²©ì€ ìƒëŒ€ì ìœ¼ë¡œ ê·¸ ìˆ˜ê°€ ì ìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ê³ ì—°ë ¹ì— ëŒ€í•œ ìžê¶ê²½ë¶€ì•” ì˜ˆì¸¡ ALE plotì—ì„œ ì´ëŸ° ì¼ì´ ë°œìƒí•©ë‹ˆë‹¤. 
- **2ì°¨ íš¨ê³¼ í”Œë¡¯ì€ í•­ìƒ ì£¼ íš¨ê³¼ë¥¼ ì—¼ë‘ì— ë‘ì–´ì•¼ í•˜ë¯€ë¡œ í•´ì„ì´ ë‹¤ì†Œ ë²ˆê±°ë¡œìš¸ ìˆ˜ ìžˆìŠµë‹ˆë‹¤**. ížˆíŠ¸ë§µì€ ìƒí˜¸ìž‘ìš©ì˜ ì¶”ê°€ì ì¸ íš¨ê³¼ì¼ ë¿ìž…ë‹ˆë‹¤. ìˆœìˆ˜í•œ 2ì°¨ íš¨ê³¼ëŠ” ìƒí˜¸ìž‘ìš©ì„ ë°œê²¬í•˜ê³  íƒìƒ‰í•˜ëŠ” ë°ëŠ” ì¢‹ì§€ë§Œ, íš¨ê³¼ê°€ ì–´ë–»ê²Œ ë‚˜íƒ€ë‚˜ëŠ”ì§€ í•´ì„í•  ë•ŒëŠ” ì£¼íš¨ê³¼ í”Œë¡¯ì„ ë™ë°˜í•˜ëŠ” ê²ƒì´ í•©ë¦¬ì ìž…ë‹ˆë‹¤. 
- ALE plotì˜ êµ¬í˜„ì€ PDPì— ë¹„í•´ í›¨ì”¬ ë³µìž¡í•˜ê³  ì§ê´€ì ì´ì§€ ì•ŠìŠµë‹ˆë‹¤. 
- ìƒê´€ê´€ê³„ê°€ ìžˆëŠ” í”¼ì³ë“¤ì˜ ê²½ìš° ALE plotì€ ë¹„íŽ¸í–¥ì´ì§€ë§Œ, ê·¸ ìƒê´€ê´€ê³„ê°€ ê°•í•œ ê²½ìš° í•´ì„ì€ ì—¬ì „ížˆ ì–´ë µìŠµë‹ˆë‹¤. ê°•í•œ ìƒê´€ê´€ê³„ì¼ ê²½ìš° ë‘ í”¼ì³ë¥¼ ë”°ë¡œ ë¶„ë¦¬í•˜ì§€ ì•Šê³  í•¨ê»˜ ë³€ê²½í–ˆì„ ë•Œ íš¨ê³¼ë§Œ ë¶„ì„í•˜ëŠ” ê²ƒì´ í•©ë¦¬ì ì´ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤. ì´ ë‹¨ì ì€ ALE plot ë¿ì•„ë‹ˆë¼ ìƒê´€ê´€ê²Œê°€ ê°•í•œ í”¼ì³ì˜ ì¼ë°˜ì ì¸ ë¬¸ì œìž…ë‹ˆë‹¤. 
- í”¼ì³ ê°„ ìƒê´€ê´€ê³„ê°€ ì—†ê³  ê³„ì‚° ì‹œê°„ì´ ë¬¸ì œë˜ì§€ ì•Šì„ ê²½ìš°, ì´í•´ê°€ ì‰½ê³  ICE curveì™€ í•¨ê»˜ ê·¸ë¦´ ìˆ˜ ìžˆëŠ” PDPê°€ ë” ë°”ëžŒì§í•©ë‹ˆë‹¤. 

## 7. Implementation and Alternatives

ëŒ€ì•ˆì€ PDP ë˜ëŠ” ICEê°€ ë©ë‹ˆë‹¤.

ALE plotì€  [`ALEPlot`](https://cran.r-project.org/web/packages/ALEPlot/index.html)íŒ¨í‚¤ì§€ì—ì„œ ê°€ëŠ¥í•˜ë©° [`iml`](https://cran.r-project.org/web/packages/iml/index.html) íŒ¨í‚¤ì§€ì—ì„œë„ ê°€ëŠ¥í•©ë‹ˆë‹¤. Pythonì—ì„œëŠ” [`ALEPython`](https://github.com/blent-ai/ALEPython)ê³¼ [`Alibi`](https://docs.seldon.io/projects/alibi/en/stable/index.html)ê°€ ìžˆìŠµë‹ˆë‹¤. 

---

# ðŸ“• 08-03. Feature Interaction

ì˜ˆì¸¡ ëª¨ë¸ë§ì—ì„œ í”¼ì³ë¼ë¦¬ ì„œë¡œ ìƒí˜¸ìž‘ìš©í•˜ëŠ” ê²½ìš°, í•˜ë‚˜ì˜ í”¼ì³ íš¨ê³¼ëŠ” ë‹¤ë¥¸ í”¼ì³ ê°’ì— ë”°ë¼ ë‹¬ë¼ì§€ê¸° ë•Œë¬¸ì— ì˜ˆì¸¡ì¹˜ë¥¼ í”¼ì³ íš¨ê³¼ì˜ í•©ìœ¼ë¡œ í‘œí˜„í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. 

## 1. Feature Interaction ?

ML ëª¨ë¸ì´ ë‘ ê°€ì§€ í”¼ì³ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì˜ˆì¸¡í•˜ëŠ” ê²½ìš°, ì˜ˆì¸¡ì¹˜ë¥¼ ìƒìˆ˜í•­, 1st í•­, 2nd í•­, ë‘ í”¼ì³ ê°„ ìƒí˜¸ìž‘ìš©ì— ëŒ€í•œ í•­ ì´ë ‡ê²Œ 4ê°€ì§€ í•­ìœ¼ë¡œ ë¶„í•´í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 

ë‘ í”¼ì³ ê°„ì˜ ìƒí˜¸ìž‘ìš©ì€ ê°œë³„ í”¼ì³ íš¨ê³¼ë¥¼ ê³ ë ¤í•œ í›„ í”¼ì³ë¥¼ ë³€ê²½ì‹œí‚´ìœ¼ë¡œì¨ ë°œìƒí•˜ëŠ” ì˜ˆì¸¡ì¹˜ì˜ ë³€í™”ë¥¼ ë§í•©ë‹ˆë‹¤. 

ì˜ˆë¥¼ ë“¤ì–´, ì–´ë–¤ ëª¨ë¸ì´ ì§‘ì˜ í¬ê¸°ì™€ ìœ„ì¹˜ë¥¼ í”¼ì³ë¡œ ì‚¬ìš©í•´ ì£¼íƒ ê°€ì¹˜ë¥¼ ì˜ˆì¸¡í•˜ë©´ ê°€ëŠ¥í•œ ì˜ˆì¸¡ì€ 4ê°€ì§€ê°€ ë‚˜ì˜µë‹ˆë‹¤:

| Location | Size | Prediction |
| ---: | ---: | ---: |
| good | big | 300,000 |
| good | small | 200,000 |
| bad | big | 250,000 |
| bad | small | 150,000 |
ì˜ˆì¸¡ì¹˜ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë¶„í•´ë©ë‹ˆë‹¤ : ìƒìˆ˜ í•­(150,000), í¬ê¸°ì— ëŒ€í•œ íš¨ê³¼(+100,000 if big; +0 if small), ìœ„ì¹˜ì— ëŒ€í•œ íš¨ê³¼(+50,000 if good; +0 if bad). ì´ëŸ¬í•œ ë¶„í•´(decomposition)ëŠ” ì˜ˆì¸¡ì¹˜ë¥¼ ì™„ë²½í•˜ê²Œ ì„¤ëª…í•©ë‹ˆë‹¤. ì´ëŠ” í¬ê¸°ì™€ ìœ„ì¹˜ì— ëŒ€í•œ ë‹¨ì¼ í”¼ì³ íš¨ê³¼ì˜ í•©ì¸ë°, ìƒí˜¸ìž‘ìš© íš¨ê³¼ê°€ ì—†ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤. 

ìƒí˜¸ìž‘ìš©ì´ ìžˆëŠ” ì˜ˆì‹œë¥¼ ë³´ê² ìŠµë‹ˆë‹¤ :

| Location |  Size | Prediction |
| --------:| -----:| ----------:|
|     good |   big |    400,000 |
|     good | small |    200,000 |
|      bad |   big |    250,000 |
|      bad | small |    150,000 |


ìƒìˆ˜í•­(150,000), í¬ê¸°ì— ëŒ€í•œ íš¨ê³¼(+100,000 if big; +0 if small), ìœ„ì¹˜ì— ëŒ€í•œ íš¨ê³¼(+50,000 if good; +0 if bad). ì´ í…Œì´ë¸”ì—ëŠ” ìƒí˜¸ìž‘ìš©ì— ëŒ€í•œ ì¶”ê°€ì ì¸ termì´ í•„ìš”í•©ë‹ˆë‹¤ : +100,000 if the house if big and in a good location. ì´ ê²½ìš° í° ì§‘ê³¼ ìž‘ì€ ì§‘ì˜ ì˜ˆì¸¡ì¹˜ ì°¨ì´ê°€ ìœ„ì¹˜ì— ë”°ë¼ ë‹¬ë¼ì§€ê¸° ë•Œë¬¸ì— ì´ëŠ” í¬ê¸°ì™€ ìœ„ì¹˜ ê°„ ìƒí˜¸ìž‘ìš©ìž…ë‹ˆë‹¤. 

ìƒí˜¸ìž‘ìš©ì˜ ê°•ë„ë¥¼ ì¶”ì •í•˜ëŠ” ë°©ë²•ì€ í”¼ì³ì˜ ìƒí˜¸ìž‘ìš©ì— ë”°ë¼ ì˜ˆì¸¡ì¹˜ì˜ ë³€ë™ì´ ì–¼ë§ˆë‚˜ ë‹¬ë¼ì§€ëŠ”ì§€ë¥¼ ì¸¡ì •í•˜ëŠ” ê²ƒìž…ë‹ˆë‹¤. ì´ë¥¼ H-statisticì´ë¼ê³  í•˜ë©° Friedmanê³¼ Popescu(2008)ê°€ ì œì•ˆí–ˆìŠµë‹ˆë‹¤.

## 2. Theory : Friedman's H-statistic

ë‘ ê°€ì§€ ê²½ìš°ë¥¼ ë‹¤ë¤„ ë³´ê² ìŠµë‹ˆë‹¤ : 1) ëª¨ë¸ì—ì„œ ë‘ í”¼ì³ê°€ ì„œë¡œ ìƒí˜¸ìž‘ìš©í•˜ëŠ”ì§€ ì—¬ë¶€ì™€ ê·¸ ì •ë„ë¥¼ ì•Œë ¤ì£¼ëŠ” ì–‘ë°©í–¥(two-way) ìƒí˜¸ìž‘ìš© ì¸¡ì •ê°’, 2) ëª¨ë¸ì—ì„œ í•œ í”¼ì³ê°€ ë‹¤ë¥¸ ëª¨ë“  í”¼ì³ì™€ ìƒí˜¸ìž‘ìš©í•˜ëŠ”ì§€ ì—¬ë¶€ì™€ ê·¸ ì •ë„ë¥¼ ì•Œë ¤ì£¼ëŠ” ì „ì²´ ìƒí˜¸ìž‘ìš© ì¸¡ì •ê°’. ì´ë¡ ì ìœ¼ë¡œëŠ” ì—¬ëŸ¬ í”¼ì³ ê°„ì˜ ìž„ì˜ì˜ ìƒí˜¸ìž‘ìš©ì„ ì¸¡ì •í•  ìˆ˜ ìžˆì§€ë§Œ, ì´ ë‘ ê°€ì§€ê°€ ê°€ìž¥ ê´€ì‹¬ì´ ê°€ëŠ” ê²ƒìž…ë‹ˆë‹¤. 

ë‘ í”¼ì³ê°€ ìƒí˜¸ìž‘ìš©í•˜ì§€ ì•Šì€ ê²½ìš° PD í•¨ìˆ˜ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ë¶„í•´í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤(PD í•¨ìˆ˜ì˜ ì¤‘ì‹¬ì´ 0ì´ë¼ê³  ê°€ì •) : 
$$
P D_{j k}\left(x_j, x_k\right)=P D_j\left(x_j\right)+P D_k\left(x_k\right)
$$

ë§ˆì°¬ê°€ì§€ë¡œ, í•˜ë‚˜ì˜ í”¼ì³ê°€ ë‹¤ë¥¸ í”¼ì³ë“¤ê³¼ ìƒí˜¸ìž‘ìš©í•˜ì§€ ì•ŠëŠ” ê²½ìš° ì˜ˆì¸¡ í•¨ìˆ˜ $\hat{f}(x)$ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ PD í•¨ìˆ˜ì˜ í•©ìœ¼ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì²« ë²ˆì§¸ëŠ” $j$ì—ë§Œ ì¢…ì†ë˜ê³  ë‘ ë²ˆì§¸ëŠ” $j$ë¥¼ ì œì™¸í•œ ë‹¤ë¥¸ ëª¨ë“  í”¼ì³ë“¤ì— ì¢…ì†ë©ë‹ˆë‹¤ : 
$$
\hat{f}(x)=P D_j\left(x_j\right)+P D_{-j}\left(x_{-j}\right)
$$
ì—¬ê¸°ì„œ $PD_{-j}(x_{-j})$ëŠ” $j$ë²ˆì§¸ í”¼ì³ë¥¼ ì œì™¸í•œ ë‹¤ë¥¸ ëª¨ë“  í”¼ì³ë“¤ì— ëŒ€í•œ PD í•¨ìˆ˜ìž…ë‹ˆë‹¤. 

ì´ëŸ¬í•œ ë¶„í•´ëŠ” ìƒí˜¸ìž‘ìš©ì´ ì—†ëŠ” PD í•¨ìˆ˜ë¥¼ í‘œí˜„í•©ë‹ˆë‹¤ (jì™€ k, ë˜ëŠ” ê° jì™€ ë‹¤ë¥¸ ëª¨ë“  í”¼ì³ ê°„). ë‹¤ìŒ ë‹¨ê³„ëŠ” ê´€ì°°ëœ PD í•¨ìˆ˜ì™€ ìƒí˜¸ìž‘ìš© ì—†ì´ ë¶„í•´ëœ PD í•¨ìˆ˜ì˜ ì°¨ì´ê°’ì„ ì¸¡ì •í•©ë‹ˆë‹¤. PD(ë‘ í”¼ì³ ê°„ ìƒí˜¸ìž‘ìš© ì¸¡ì •) ë˜ëŠ” ì „ì²´ í•¨ìˆ˜(í•œ í”¼ì³ì™€ ë‹¤ë¥¸ ëª¨ë“  í”¼ì³ê°„ ìƒí˜¸ìž‘ìš© ì¸¡ì •)ì˜ ì¶œë ¥ì˜ ë¶„ì‚°ì„ ê³„ì‚°í•©ë‹ˆë‹¤. ìƒí˜¸ìž‘ìš©ì— ì˜í•´ ì„¤ëª…ë˜ëŠ” ë¶„ì‚°ëŸ‰ (ê´€ì°°ëœ PDì™€ ìƒí˜¸ìž‘ìš©ì´ ì—†ëŠ” PDì˜ ì°¨ì´)ì€ ìƒí˜¸ìž‘ìš© ê°•ë„ì— ëŒ€í•œ í†µê³„ì¹˜ë¡œ ì“°ìž…ë‹ˆë‹¤. ìƒí˜¸ìž‘ìš©ì´ ì—†ëŠ” ê²½ìš° ì´ ê°’ì€ 0ì´ê³ , $PD_{jk}$ ë˜ëŠ” $\hat{f}$ ì˜ ëª¨ë“  ë¶„ì‚°ì´ PD í•¨ìˆ˜ì˜ í•©ìœ¼ë¡œ ì„¤ëª…ë˜ëŠ” ê²½ìš° ì´ ê°’ì¸ 1ìž…ë‹ˆë‹¤. ë‘ í”¼ì³ ê°„ ìƒí˜¸ìž‘ìš© í†µê³„ì¹˜ê°€ 1ì´ë©´ ê°ê°ì˜ ë‹¨ì¼ PD í•¨ìˆ˜ê°€ ì¼ì •í•˜ê³  ì˜ˆì¸¡ì¹˜ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì€ ìƒí˜¸ìž‘ìš©ì„ í†µí•´ì„œë§Œ ë°œìƒí•¨ì„ ì˜ë¯¸í•©ë‹ˆë‹¤. H-stat ì€ 1ë³´ë‹¤ í´ ìˆ˜ ìžˆëŠ”ë°, ì´ëŠ” í•´ì„ì´ ë” ì–´ë µìŠµë‹ˆë‹¤. ì´ëŠ” 2-way ìƒí˜¸ìž‘ìš©ì˜ ë¶„ì‚°ì´ 2D-PDP ì˜ ë¶„ì‚°ë³´ë‹¤ í´ ë•Œ ë°œìƒí•©ë‹ˆë‹¤.

ìˆ˜í•™ì ìœ¼ë¡œ Friedman and Popescuê°€ í”¼ì³ $j$ ì™€ $k$ ê°„ ìƒí˜¸ìž‘ìš©ì— ëŒ€í•´ ì œì•ˆí•œ H-statì€ ì•„ëž˜ì™€ ê°™ìŠµë‹ˆë‹¤ : 
$$
H_{j k}^2=\frac{\sum_{i=1}^n\left[P D_{j k}\left(x_j^{(i)}, x_k^{(i)}\right)-P D_j\left(x_j^{(i)}\right)-P D_k\left(x_k^{(i)}\right)\right]^2}{\sum_{i=1}^n P D_{j k}^2\left(x_j^{(i)}, x_k^{(i)}\right)}
$$
í”¼ì³ $j$ ê°€ ë‹¤ë¥¸ í”¼ì³ì™€ ìƒí˜¸ìž‘ìš©í•˜ëŠ”ì§€ ì—¬ë¶€ë¥¼ ì¸¡ì •í•  ë•Œë„ ë™ì¼í•˜ê²Œ ì ìš©ë©ë‹ˆë‹¤ : 
$$
H_j^2=\frac{\sum_{i=1}^n\left[\hat{f}\left(x^{(i)}\right)-P D_j\left(x_j^{(i)}\right)-P D_{-j}\left(x_{-j}^{(i)}\right)\right]^2}{\sum_{i=1}^n \hat{f}^2\left(x^{(i)}\right)}
$$
H-statì€ ëª¨ë“  ë°ì´í„° í¬ì¸íŠ¸ì— ëŒ€í•´ ë°˜ë³µí•˜ê³  ê° í¬ì¸íŠ¸ì—ì„œ PD ë¥¼ í‰ê°€í•˜ë©°, ì´ëŠ” ë‹¤ì‹œ ëª¨ë“  nê°œì˜ í¬ì¸íŠ¸ë¡œ ìˆ˜í–‰ë˜ê¸° ë•Œë¬¸ì— ê³„ì‚° ë¹„ìš©ì´ ë§Žì´ ë“­ë‹ˆë‹¤. ìµœì•…ì˜ ê²½ìš°, 2-way H-stat ($j$ ëŒ€ $k$)ë¥¼ ê³„ì‚°í•˜ë ¤ë©´ ML ëª¨ë¸ ì˜ˆì¸¡ í•¨ìˆ˜ë¥¼ $2n^2$ ë²ˆ í˜¸ì¶œí•´ì•¼ í•˜ê³ , ì „ì²´ H-stat ($j$ ëŒ€ ì „ì²´)ë¥¼ ê³„ì‚°í•˜ë ¤ë©´ $3n^2$ ë²ˆ í˜¸ì¶œí•´ì•¼ í•©ë‹ˆë‹¤. ê³„ì‚° ì†ë„ë¥¼ ë†’ì´ê¸° ìœ„í•´ nê°œì˜ ë°ì´í„° í¬ì¸íŠ¸ì—ì„œ ìƒ˜í”Œë§ì„ í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ PD ì¶”ì •ì¹˜ì˜ ë¶„ì‚°ì´ ì¦ê°€í•´ì„œ H-statê°€ ë¶ˆì•ˆì •í•´ì§„ë‹¤ëŠ” ë‹¨ì ì´ ìžˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ê³„ì‚° ë¶€ë‹´ì„ ì¤„ì´ê¸° ìœ„í•´ ìƒ˜í”Œë§ì„ í•  ë•ŒëŠ” ê½¤ ë§Žì€ ìˆ˜ë¥¼ í•´ì•¼ í•©ë‹ˆë‹¤. 

Friedman and PopescuëŠ” H-stat ì´ 0ê³¼ ìœ ì˜í•˜ê²Œ ë‹¤ë¥¸ì§€ í‰ê°€íž‰ ìœ„í•œ ê²€ì • í†µê³„ëŸ‰ë„ ì œì•ˆí–ˆìŠµë‹ˆë‹¤. $H_0$ì€ ìƒí˜¸ìž‘ìš©ì´ ì—†ë‹¤ëŠ” ê°€ì„¤ìž…ë‹ˆë‹¤. $H_0$ í•˜ì—ì„œ ìƒí˜¸ìž‘ìš© í†µê³„ëŸ‰ì„ êµ¬í•˜ë ¤ë©´ í”¼ì³ $j$ì™€ $k$ ë˜ëŠ” ë‹¤ë¥¸ ëª¨ë“  í”¼ì³ ê°„ ìƒí˜¸ìž‘ìš©ì´ ì—†ë„ë¡ ëª¨ë¸ì„ ì¡°ì •í•  ìˆ˜ ìžˆì–´ì•¼ í•©ë‹ˆë‹¤. ì´ëŠ” ëª¨ë“  ìœ í˜•ì˜ ëª¨ë¸ì—ì„œ ê°€ëŠ¥í•˜ì§„ ì•ŠìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì´ ê²€ì •ì€ model-agnostic methodê°€ ì•„ë‹ˆë¯€ë¡œ ì—¬ê¸°ì„œ ë‹¤ë£¨ì§„ ì•Šê² ìŠµë‹ˆë‹¤.

ì˜ˆì¸¡ì¹˜ê°€ í™•ë¥ ì¸ ê²½ìš° ë¶„ë¥˜ ë¬¸ì œì—ì„œë„ ìƒí˜¸ìž‘ìš©ì˜ ê°•ë„ í†µê³„ì¹˜ë¥¼ ì ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

## 3. Examples

ì´ì œ í”¼ì³ ê°„ ìƒí˜¸ìž‘ìš©ì´ ì‹¤ì œë¡œ ì–´ë–»ê²Œ ì´ë£¨ì–´ì§€ëŠ”ì§€ ì˜ˆì œë¥¼ í†µí•´ ì‚´íŽ´ë³´ê² ìŠµë‹ˆë‹¤. ë‚ ì”¨ì™€ ì—¬ëŸ¬ í”¼ì³ë“¤ì„ ê¸°ë°˜ìœ¼ë¡œ ìžì „ê±° ëŒ€ì—¬ ìˆ˜ë¥¼ ì˜ˆì¸¡í•˜ëŠ” SVMì—ì„œ í”¼ì³ì˜ ìƒí˜¸ìž‘ìš©ì˜ ê°•ë„ë¥¼ ì¸¡ì •í•˜ê² ìŠµë‹ˆë‹¤. ì•„ëž˜ ê·¸ë¦¼ì€ í”¼ì³ ê°„ ìƒí˜¸ìž‘ìš©ì˜ H-stat ê°’ì„ ë³´ì—¬ì¤ë‹ˆë‹¤ : 
![](Pasted%20image%2020240102193354.png) Figure 8.19 : ìžì „ê±° ëŒ€ì—¬ ìˆ˜ë¥¼ ì˜ˆì¸¡í•˜ëŠ” SVMì— ëŒ€í•´ì„œ ê° í”¼ì³ë¥¼ ë‚˜ë¨¸ì§€ í”¼ì³ë“¤ê³¼ì˜ ìƒí˜¸ìž‘ìš© ê°•ë„(H-stat)ë¥¼ ì¸¡ì •í•œ ê²ƒìž…ë‹ˆë‹¤. ì „ë°˜ì ìœ¼ë¡œ í”¼ì³ ê°„ ìƒí˜¸ìž‘ìš© íš¨ê³¼ëŠ” ë§¤ìš° ì•½í•©ë‹ˆë‹¤ (í”¼ì³ë‹¹ ë¶„ì‚° ì„¤ëª…ì´ 10% ë¯¸ë§Œ ì´ë¯€ë¡œ).

ë‹¤ìŒìœ¼ë¡œëŠ” ë¶„ë¥˜ ë¬¸ì œì— ëŒ€í•œ ìƒí˜¸ìž‘ìš© H-stat ì„ ê³„ì‚°í•´ ë³´ê² ìŠµë‹ˆë‹¤. ëª‡ ê°€ì§€ ìœ„í—˜ ìš”ì†Œ(features)ê°€ ì£¼ì–´ì¡Œì„ ë•Œ, ìžê¶ê²½ë¶€ì•”ì„ ì˜ˆì¸¡í•˜ëŠ” Random Forest ì—ì„œ í”¼ì³ ê°„ ìƒí˜¸ìž‘ìš©ì„ ë¶„ì„í–ˆìŠµë‹ˆë‹¤ :
![](Pasted%20image%2020240102194432.png) Figure 8.20 : ìžê¶ê²½ë¶€ì•” í™•ë¥ ì„ ì˜ˆì¸¡í•˜ëŠ” Random Forestì—ì„œ ê° í”¼ì³ì™€ ë‚˜ë¨¸ì§€ í”¼ì³ ê°„ ìƒí˜¸ìž‘ìš© ê°•ë„ (H-stat)ë¥¼ ì¸¡ì •í•œ ê²ƒìž…ë‹ˆë‹¤. í˜¸ë¥´ëª¬ í”¼ìž„ì•½ ë³µìš© ê¸°ê°„ì´ ë‹¤ë¥¸ ëª¨ë“  í”¼ì³ë“¤ê³¼ì˜ ìƒëŒ€ì ì¸ ìƒí˜¸ìž‘ìš© íš¨ê³¼ê°€ ê°€ìž¥ ë†’ê³ , ê·¸ ë‹¤ìŒì€ ìž„ì‹  íšŸìˆ˜ìž…ë‹ˆë‹¤. 


## 4. Advantages

ìƒí˜¸ìž‘ìš© H-statì€ PD ë¶„í•´(decomposition)ë¥¼ í†µí•œ ê¸°ì € ì´ë¡ ì„ ê°–ìŠµë‹ˆë‹¤. 

H-statì€ ì˜ë¯¸ê°€ ìžˆëŠ” í•´ì„ë²•ìž…ë‹ˆë‹¤ : ìƒí˜¸ìž‘ìš©ì€ ì„¤ëª…ë˜ëŠ” ë¶„ì‚°ì˜ ì ìœ ìœ¨ë¡œ ì •ì˜ë©ë‹ˆë‹¤.

ì´ í†µê³„ì¹˜ëŠ” ì°¨ì›ì´ ì—†ìœ¼ë¯€ë¡œ í”¼ì³ ê°„, ì‹¬ì§€ì–´ ëª¨ë¸ ê°„ì—ë„ ë¹„êµí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

ì´ í†µê³„ì¹˜ëŠ” íŠ¹ì •í•œ í˜•íƒœì— ê´€ê³„ì—†ì´ ëª¨ë“  ì¢…ë¥˜ì˜ ìƒí˜¸ìž‘ìš©ì„ ê°ì§€í•©ë‹ˆë‹¤.

H-statì„ ì‚¬ìš©í•˜ë©´ 3ê°œ ì´ìƒì˜ í”¼ì³ ê°„ì˜ ìƒí˜¸ìž‘ìš© ê°•ë„ ê°™ì€ ëª¨ë“  ë†’ì€ ì°¨ìˆ˜ì˜ ìƒí˜¸ìž‘ìš©ë„ ë¶„ì„í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 

## 5. Disadvantages

ìƒí˜¸ìž‘ìš© H-statì€ ê³„ì‚° ë¹„ìš©ì´ ë§Žì´ ë“­ë‹ˆë‹¤. 

ì´ ê³„ì‚°ì—ëŠ” ì£¼ë³€ ë¶„í¬ë¥¼ ì¶”ì •í•˜ëŠ” ìž‘ì—…ì´ í¬í•¨ë©ë‹ˆë‹¤. ëª¨ë“  ë°ì´í„° í¬ì¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²½ìš° ì´ëŸ¬í•œ ì¶”ì •ì¹˜ì—ë„ ì¼ì •í•œ ë¶„ì‚°ì´ ìžˆìŠµë‹ˆë‹¤. ì¦‰, í¬ì¸íŠ¸ë¥¼ ìƒ˜í”Œë§í•  ë•Œë§ˆë‹¤ ì¶”ì •ì¹˜ë„ ë‹¬ë¼ì§€ê³  ê²°ê³¼ê°€ ë¶ˆì•ˆì •í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì•ˆì •ì ì¸ ê²°ê³¼ë¥¼ ì–»ê¸°ì— ì¶©ë¶„í•œ ë°ì´í„°ê°€ ìžˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ H-stat ê³„ì‚°ì„ ëª‡ ë²ˆ ë°˜ë³µí•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

ìƒí˜¸ìž‘ìš©ì´ 0ë³´ë‹¤ ìœ ì˜í•˜ê²Œ í°ì§€ëŠ” ë¶ˆë¶„ëª…í•©ë‹ˆë‹¤. í†µê³„ì  í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•´ì•¼ í•˜ì§€ë§Œ ì´ í…ŒìŠ¤íŠ¸ëŠ” mode-agnostic versionì—ì„œëŠ” ì•„ì§ ì œê³µë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

ê²€ì • ë¬¸ì œì— ìžˆì–´ì„œ, H-statì´ ì–¸ì œ ìƒí˜¸ìž‘ìš©ì´ "ê°•í•œ" ê²ƒìœ¼ë¡œ íŒë‹¨í•  ìˆ˜ ìžˆëŠ”ì§€ ëª…í™•ížˆ ë§í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤.

ë˜í•œ H-statì´ 1ë³´ë‹¤ í´ ìˆ˜ ìžˆì–´ì„œ í•´ì„ì´ ì–´ë ¤ìš¸ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

ë‘ í”¼ì³ì˜ ì´ íš¨ê³¼ëŠ” ì•½í•˜ì§€ë§Œ ëŒ€ë¶€ë¶„ì´ ìƒí˜¸ìž‘ìš©ìœ¼ë¡œ êµ¬ì„±ëœ ê²½ìš°, H-statì´ ë§¤ìš° ì»¤ì§ˆìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ìƒí˜¸ìž‘ìš©ì˜ H-stat ì€ ë¶„ëª¨ê°€ ìž‘ì•„ì•¼ í•˜ë©°, í”¼ì³ê°€ ì„œë¡œ ìƒê´€ê´€ê³„ê°€ ìžˆì„ ë•Œ ë” ì‹¬í•´ì§‘ë‹ˆë‹¤. ì‹¤ì œë¡œëŠ” ë‘ í”¼ì³ê°€ ëª¨ë¸ì— ë³„ ì—­í• ì„ í•˜ì§€ ì•ŠëŠ”ë°ë„ ê°€ì§œ ìƒí˜¸ìž‘ìš©ì´ ê°•ë ¥í•œ ìƒí˜¸ìž‘ìš© íš¨ê³¼ë¡œ ì‰½ê²Œ ê³¼ëŒ€ í•´ì„ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ë°©ë²•ì€ ì •ê·œí™”ë˜ì§€ ì•Šì€(unnormalized) H-stat, ì¦‰ H-stat ë¶„ìžì˜ ì œê³±ê·¼ì„ ì‹œê°í™”í•˜ëŠ” ê²ƒìž…ë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ì ì–´ë„ íšŒê·€ ë¬¸ì œì˜ ê²½ìš° H-statì„ targetê³¼ ë™ì¼í•œ ìˆ˜ì¤€ìœ¼ë¡œ í™•ìž¥í•˜ê³  ê°€ì§œ ìƒí˜¸ìž‘ìš©ì„ ëœ ê°•ì¡°í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 

$$
H_{j k}^*=\sqrt{\sum_{i=1}^n\left[P D_{j k}\left(x_j^{(i)}, x_k^{(i)}\right)-P D_j\left(x_j^{(i)}\right)-P D_k\left(x_k^{(i)}\right)\right]^2}
$$

H-statì€ ìƒí˜¸ìž‘ìš©ì˜ ê°•ë„ë¥¼ ì•Œë ¤ì£¼ì§€ë§Œ, ìƒí˜¸ìž‘ìš©ì´ ì–´ë–»ê²Œ ë‚˜íƒ€ë‚˜ëŠ”ì§€ëŠ” ì•Œë ¤ì£¼ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ ì ì´ ë°”ë¡œ PDPì˜ ëª©ì ìž…ë‹ˆë‹¤. ìš°ì„  ìƒí˜¸ìž‘ìš©ì˜ ê°•ë„ë¥¼ ì¸¡ì •í•œ ë‹¤ìŒ ê´€ì‹¬ ìžˆëŠ” ìƒí˜¸ìž‘ìš©ì— ëŒ€í•œ 2D-PDPë¥¼ ë§Œë“¤ë©´ ë©ë‹ˆë‹¤. 

ìž…ë ¥ì´ pixelsì¸ ê²½ìš° H-statì€ ì œëŒ€ë¡œ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì´ ê¸°ë²•ì€ image classifierì—ëŠ” ìœ ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. 

ìƒí˜¸ìž‘ìš© í†µê³„ì¹˜ëŠ” í”¼ì³ë¥¼ ë…ë¦½ì ìœ¼ë¡œ shuffleí•  ìˆ˜ ìžˆë‹¤ëŠ” ê°€ì • í•˜ì— ìž‘ë™í•©ë‹ˆë‹¤. í”¼ì³ ê°„ ìƒê´€ê´€ê³„ê°€ ê°•í•˜ë©´ ì´ ê°€ì •ì´ ê¹¨ì§€ê³  ì‹¤ì œë¡œëŠ” ê°€ëŠ¥ì„±ì´ ê±°ì˜ ì—†ëŠ” í”¼ì³ ì¡°í•©ì„ í†µí•©í•˜ê²Œ ë©ë‹ˆë‹¤. ì´ëŠ” PDPì—ì„œ ë°œìƒí•˜ëŠ” ë¬¸ì œì™€ ë™ì¼í•œ ë¬¸ì œìž…ë‹ˆë‹¤. ìƒí˜¸ ì—°ê´€ëœ í”¼ì³ë“¤ì€ H-statì˜ í°ê°’ìœ¼ë¡œ ì´ì–´ì§‘ë‹ˆë‹¤.

## 6. Implementations

ì´ ì„¹ì…˜ì˜ ì˜ˆì œëŠ” CRANì—ì„œ ì œê³µë˜ëŠ” íŒ¨í‚¤ì§€ [`iml`](https://cran.r-project.org/web/packages/iml/)ì˜ dev versionì„ ì´ìš©í–ˆìŠµë‹ˆë‹¤. íŠ¹ì •í•œ ëª¨ë¸ì— ì´ˆì ì„ ë§žì¶˜ ê²ƒë„ ìžˆìŠµë‹ˆë‹¤. `RulFit` íŒ¨í‚¤ì§€ì™€ `pre` íŒ¨í‚¤ì§€ëŠ” H-statì„ êµ¬í˜„í•©ë‹ˆë‹¤. ë˜í•œ `gbm` íŒ¨í‚¤ì§€ëŠ” ë¶€ìŠ¤íŒ… ëª¨ë¸ë“¤ê³¼ H-statì„ êµ¬í˜„í•©ë‹ˆë‹¤. 

## 7. Alternatives

H-stat ë§ê³ ë„ ìƒí˜¸ìž‘ìš©ì„ ì¸¡ì •í•  ìˆ˜ ìžˆëŠ” ë°©ë²•ì€ ìžˆìŠµë‹ˆë‹¤ : 

- Hooker (2004)ì˜ Variable Interation Networks; VIN ëŠ” ì˜ˆì¸¡ í•¨ìˆ˜ë¥¼ ì£¼ íš¨ê³¼ì™€ ìƒí˜¸ìž‘ìš© íš¨ê³¼ë¡œ ë¶„í•´í•˜ëŠ” ì ‘ê·¼ë²•ìž…ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ í”¼ì³ ê°„ ìƒí˜¸ìž‘ìš©ì„ ì—°ê²°ë§ìœ¼ë¡œ ì‹œê°í™”í•©ë‹ˆë‹¤. ì•ˆíƒ€ê¹ê²Œë„ ì•„ì§ ì‚¬ìš©í•  ìˆ˜ ìžˆëŠ” SWëŠ” ì—†ìŠµë‹ˆë‹¤.
- Greenwell et al. (2018)ì˜ Partial dependence based feature interactionì€ í”¼ì³ ê°„ ìƒí˜¸ìž‘ìš©ì„ ì¸¡ì •í•©ë‹ˆë‹¤. ì´ ë°©ì‹ì€ ë‹¤ë¥¸ í”¼ì³ë“¤ì˜ fixed pointsì— ë”°ë¼ í•˜ë‚˜ì˜ í”¼ì³ì˜ ë³€ìˆ˜ ì¤‘ìš”ë„(PDP í•¨ìˆ˜ì˜ ë¶„ì‚°ìœ¼ë¡œ ì •ì˜)ë¥¼ ì¸¡ì •í•©ë‹ˆë‹¤. ë¶„ì‚°ì´ í¬ë©´ ë‘ í”¼ì³ê°€ ì„œë¡œ ìƒí˜¸ìž‘ìš©í•˜ëŠ” ê²ƒì´ê³ , 0ì´ë©´ ìƒí˜¸ìž‘ìš©í•˜ì§€ ì•ŠëŠ” ê²ƒìž…ë‹ˆë‹¤. ì´ëŠ” `vip` íŒ¨í‚¤ì§€ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì´ íŒ¨í‚¤ì§€ëŠ” PDPì™€ ë³€ìˆ˜ ì¤‘ìš”ë„ì— ëŒ€í•´ì„œë„ ë‹¤ë£¹ë‹ˆë‹¤.
---

# ðŸ“• 08-04. Functional Decomposition

Supervised ML ëª¨ë¸ì€ ê³ ì°¨ì› í”¼ì³ë¥¼ inputìœ¼ë¡œ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡ ë˜ëŠ” ë¶„ë¥˜ë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜ë¡œ ë³¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. í•¨ìˆ˜ ë¶„í•´(Functional decomposition)ëŠ” ê³ ì°¨ì› í•¨ìˆ˜ë¥¼ ë¶„í•´í•˜ì—¬ ì‹œê°í™”í•  ìˆ˜ ìžˆëŠ” ê°œë³„ í”¼ì³ íš¨ê³¼ (individual feature effects)ì™€ ìƒí˜¸ìž‘ìš© íš¨ê³¼ì˜ í•©ìœ¼ë¡œ í‘œí˜„í•˜ëŠ” í•´ì„ ê¸°ë²•ìž…ë‹ˆë‹¤. ë˜í•œ í•¨ìˆ˜ ë¶„í•´ëŠ” ë§Žì€ í•´ì„ ê¸°ë²•ì˜ ê¸°ë³¸ ì›ë¦¬ë¡œ, ë‹¤ë¥¸ í•´ì„ ê¸°ë²•ì„ ë³´ë‹¤ ë” ìž˜ ì´í•´í•  ìˆ˜ ìžˆë„ë¡ ë„ì™€ì¤ë‹ˆë‹¤.

íŠ¹ì • í•¨ìˆ˜ë¥¼ ì‚´íŽ´ë³´ê² ìŠµë‹ˆë‹¤. ì´ í•¨ìˆ˜ëŠ” 2ê°œì˜ í”¼ì³ë¥¼ inputìœ¼ë¡œ ë°›ì•„ 1ì°¨ì› outputì„ ìƒì„±í•©ë‹ˆë‹¤: 
$$
y=\hat{f}\left(x_1, x_2\right)=2+e^{x_1}-x_2+x_1 \cdot x_2
$$
ì´ í•¨ìˆ˜ë¥¼ ML ëª¨ë¸ì´ë¡œ ìƒê°í•˜ë©´ ë©ë‹ˆë‹¤. ì´ í•¨ìˆ˜ë¥¼ 3D plotì´ë‚˜ ë“±ê³ ì„ (contour)ì´ ìžˆëŠ” ížˆíŠ¸ë§µìœ¼ë¡œ ì‹œê°í™”í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤ : 
![](Pasted%20image%2020240102201444.png) Figure 8.22 : ë‘ í”¼ì³ $X_1$, $X_2$ ì˜ í•¨ìˆ˜ì˜ ì˜ˆì¸¡ í‘œë©´

ì´ í•¨ìˆ˜ëŠ” $X_1$ì´ í¬ê³  $X_2$ê°€ ìž‘ì„ ë•Œ í° ê°’ì„ ì·¨í•˜ê³ , $X_2$ê°€ í¬ê³  $X_1$ì´ ìž‘ì„ ë•ŒëŠ” ìž‘ì€ ê°’ì„ ì·¨í•©ë‹ˆë‹¤. ì˜ˆì¸¡ í•¨ìˆ˜ëŠ” ë‹¨ìˆœížˆ ë‘ í”¼ì³ ê°„ ë§ì…ˆ íš¨ê³¼ê°€ ì•„ë‹ˆë¼ ë‘ í”¼ì³ ì‚¬ì´ì˜ ìƒí˜¸ìž‘ìš©ìž…ë‹ˆë‹¤. ìƒí˜¸ìž‘ìš©ì˜ ì¡´ìž¬ëŠ” ìœ„ ê·¸ë¦¼ì—ì„œ ë³¼ ìˆ˜ ìžˆëŠ”ë°, í”¼ì³ $X_1$ì˜ ê°’ ë³€í™”ì˜ íš¨ê³¼ëŠ” $X_2$ ê°’ì— ë”°ë¼ ë‹¬ë¼ì§‘ë‹ˆë‹¤. 

ì´ì œ ìš°ë¦¬ê°€ í•  ì¼ì€ ì´ í•¨ìˆ˜ë¥¼ í”¼ì³ $X_1$ê³¼ $X_2$ì˜ ì£¼íš¨ê³¼ì™€ ìƒí˜¸ìž‘ìš© termìœ¼ë¡œ ë¶„í•´í•˜ëŠ” ê²ƒìž…ë‹ˆë‹¤. ë‘ ê°œì˜ input í”¼ì³ì—ë§Œ ì˜ì¡´í•˜ëŠ” 2ì°¨ì› í•¨ìˆ˜ $\hat{f}$ ì˜ ê²½ìš° ë‹¤ìŒê³¼ ê°™ì´ ë¶„í•´í•©ë‹ˆë‹¤ - 
$\hat{f}(x_1,x_2)$ì˜ ê²½ìš° ê° ì„±ë¶„ì´ ì£¼ íš¨ê³¼ ($\hat{f}_1$ì™€ $\hat{f}_2$), ìƒí˜¸ìž‘ìš© íš¨ê³¼ ($\hat{f}_{1,2}$) ë˜ëŠ” ì ˆíŽ¸ ($\hat{f}_0$) : 
$$
\hat{f}\left(x_1, x_2\right)=\hat{f}_0+\hat{f}_1\left(x_1\right)+\hat{f}_2\left(x_2\right)+\hat{f}_{1,2}\left(x_1, x_2\right)
$$
ì£¼íš¨ê³¼ëŠ” ë‹¤ë¥¸ í”¼ì³ê°’ê³¼ ë¬´ê´€í•˜ê²Œ ê° í”¼ì³ê°€ ì˜ˆì¸¡ì¹˜ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ìƒí˜¸ìž‘ìš© íš¨ê³¼ëŠ” í”¼ì³ì˜ ê³µë™(joint) íš¨ê³¼ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ì ˆíŽ¸ì€ ëª¨ë“  í”¼ì³ íš¨ê³¼ê°€ 0ìœ¼ë¡œ ì„¤ì •ë˜ì—ˆì„ ë•Œ ì˜ˆì¸¡ì¹˜ê°€ ì–´ë–»ê²Œ ë˜ëŠ”ì§€ ì•Œë ¤ì¤ë‹ˆë‹¤. 

ê° êµ¬ì„± ìš”ì†Œì— ëŒ€í•´ ì‹œê°í™” í•´ë³´ê² ìŠµë‹ˆë‹¤. ì ˆíŽ¸ì€ $\hat{f}_0 \sim 3.18$ ìž…ë‹ˆë‹¤ : 
![](Pasted%20image%2020240102203347.png) Figure 8.23 : Decomposition of a function

$x_1$ í”¼ì³ëŠ” exponential ì¸ ì£¼íš¨ê³¼ë¥¼ ë‚˜íƒ€ë‚´ê³ , $x_2$ëŠ” ìŒì˜ ì„ í˜• íš¨ê³¼ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ìƒí˜¸ìž‘ìš© termì€ í”„ë§ê¸€ìŠ¤ ì¹©ê³¼ ë¹„ìŠ·í•˜ê²Œ ìƒê²¼ìŠµë‹ˆë‹¤. ìˆ˜í•™ì ìœ¼ë¡œ í‘œí˜„í•˜ìžë©´ $x_1 \cdot x_2$ ì˜ ìŒê³¡ì„  í¬ë¬¼ì„ ìž…ë‹ˆë‹¤. ì´ëŸ¬í•œ ë¶„í•´ëŠ” ë’¤ì—ì„œ ì„¤ëª…í•  ALE plots ì„ ê¸°ë°˜ìœ¼ë¡œ í•©ë‹ˆë‹¤.

## 1. How to Compute the Components I

ì™œ ì´ë ‡ê²Œ ë³µìž¡í• ê¹Œìš”? ê³µì‹ì„ ë³´ë©´ ì´ë¯¸ ë¶„í•´ì— ëŒ€í•œ ë‹µì„ ì•Œ ìˆ˜ ìžˆëŠ”ë° ë³µìž¡í•œ ë°©ë²•ì´ í•„ìš” ì—†ê² ì£ ? í”¼ì³ $x_1$ì˜ ê²½ìš°, $x_1$ë§Œ í¬í•¨ëœ ê²ƒë“¤ì„ ëª¨ë‘ í•©í•˜ì—¬ í•´ë‹¹ í”¼ì³ê°’ì˜ ì„±ë¶„ìœ¼ë¡œ ì·¨í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì¦‰, $\hat{f}_1(x_1)=e^{x_1}$ ì´ê³ , $x_2$ì˜ ê²½ìš° $\hat{f}_2(x_2)=-x_2$ê°€ ë©ë‹ˆë‹¤. ê·¸ëŸ¬ë©´ ìƒí˜¸ìž‘ìš©ì€ $\hat{f}_{12}(x_1,x_2)=x_1\cdot x_2$ ì´ ë©ë‹ˆë‹¤. ì´ ì˜ˆì œì—ì„œëŠ” ì´ê²ƒì´ ì •ë‹µì´ì§€ë§Œ ì´ëŸ¬í•œ ì ‘ê·¼ë²•ì—ëŠ” ë‘ ê°€ì§€ ë¬¸ì œì ì´ ìžˆìŠµë‹ˆë‹¤ : 1) ì´ ì˜ˆì œëŠ” ì°¸ ê³µì‹ìœ¼ë¡œ ì¶œë°œí–ˆì§€ë§Œ, ì‹¤ì œë¡œëŠ” ì´ë ‡ê²Œ ê¹”ë”í•œ ê³µì‹ìœ¼ë¡œëŠ” ì„¤ëª…í•  ìˆ˜ ìžˆëŠ” ML ëª¨ë¸ì€ ê±°ì˜ ì—†ìŠµë‹ˆë‹¤. 2) ë‘ ë²ˆì§¸ ë¬¸ì œì ì€ ë” ë³µìž¡í•œë°, ìƒí˜¸ìž‘ìš©ì´ ë¬´ì—‡ì¸ì§€ì™€ ê´€ë ¨ ë˜ì–´ ìžˆìŠµë‹ˆë‹¤. ë‘ í”¼ì³ê°€ ëª¨ë‘ 0ë³´ë‹¤ í° ê°’ì„ ê°€ì§€ë©° ì„œë¡œ ë…ë¦½ì ì¸ ê°„ë‹¨í•œ í•¨ìˆ˜ $\hat{f}(x_1,x_2)=x_1\cdot x_2$ ë¥¼ ê³ ë ¤í•´ ë³´ê² ìŠµë‹ˆë‹¤. ë°©ê¸ˆ ì „ì²˜ëŸ¼ look-at-the-formula ë°©ì‹ìœ¼ë¡œ ë³´ë©´ í”¼ì³ $x_1$ê³¼ $x_2$ ê°„ ìƒí˜¸ìž‘ìš©ì´ ìžˆì§€ë§Œ ê°œë³„ í”¼ì³ íš¨ê³¼ëŠ” ì—†ë‹¤ëŠ” ê²°ë¡ ì´ ë‚´ë ¤ì§‘ë‹ˆë‹¤. ë‹¤ë¥¸ í”¼ì³ $x_2$ ê°’ì— ê´€ê³„ì—†ì´ $x_1$ë¥¼ ì¦ê°€ì‹œí‚¤ë©´ ì˜ˆì¸¡ì¹˜ëŠ” ì¦ê°€í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, $x_2=1$ ì¼ ë•Œ $x_1$ì˜ íš¨ê³¼ëŠ” $\hat{f}(x_1, 1) = x_1$ ì´ê³ , $x_2 = 10$ ì¼ ë•ŒëŠ” $\hat{f}(x_1,10)=10\cdot x_1$ ìž…ë‹ˆë‹¤. ë”°ë¼ì„œ í”¼ì³ $x_1$ì€ $x_2$ì™€ ë¬´ê´€í•˜ê²Œ ì˜ˆì¸¡ì¹˜ì— ì–‘ì˜ ì˜í–¥ì„ ë¯¸ì¹˜ë©° ê·¸ íš¨ê³¼ê°€ 0ì´ ì•„ë‹˜ì´ ë¶„ëª…í•©ë‹ˆë‹¤. 

í˜„ì‹¤ ë¬¸ì œì—ëŠ” ê¹”ë”í•œ ìˆ˜ì‹/ê³µì‹ì´ ì—†ë‹¤ëŠ” ë¬¸ì œ 1)ì„ í•´ê²°í•˜ë ¤ë©´ ì˜ˆì¸¡ í•¨ìˆ˜ ë˜ëŠ” ë¶„ë¥˜ ì ìˆ˜ë§Œì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ í•„ìš”í•©ë‹ˆë‹¤. ë¬¸ì œ 2)ì˜ ì •ì˜ ë¶€ì¡± ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ë©´ êµ¬ì„± ìš”ì†Œê°€ ì–´ë–»ê²Œ ìƒê²¼ëŠ”ì§€ì™€ ì„œë¡œê°€ ì–´ë–»ê²Œ ê´€ê³„ë˜ì–´ ìžˆëŠ”ì§€ë¥¼ ì•Œë ¤ì£¼ëŠ” ëª‡ ê°€ì§€ ì •ë¦¬/ì›ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤. ìš°ì„ ì€ í•¨ìˆ˜ ë¶„í•´ê°€ ë¬´ì—‡ì¸ì§€ ë” ì •í™•í•˜ê²Œ ì •ì˜í•´ë´…ì‹œë‹¤.

## 2. Functional Decomposition

ì˜ˆì¸¡ í•¨ìˆ˜ëŠ” $p$ ê°œì˜ í”¼ì³ë“¤ì„ inputìœ¼ë¡œ ë°›ê³ , $\hat{f}: \mathbb{R}^p \mapsto\mathbb{R}$ output ì„ ë‚´ë±‰ìŠµë‹ˆë‹¤. ì´ëŠ” íšŒê·€ í•¨ìˆ˜ì¼ ìˆ˜ë„ ìžˆê³  í´ëž˜ìŠ¤ í™•ë¥ ì´ë‚˜ í´ëŸ¬ìŠ¤í„°/êµ°ì§‘ì— ëŒ€í•œ ì ìˆ˜(ë¹„ì§€ë„ í•™ìŠµ)ì¼ ìˆ˜ë„ ìžˆìŠµë‹ˆë‹¤. ì™„ì „ížˆ ë¶„í•´í•˜ë©´ ì˜ˆì¸¡ í•¨ìˆ˜ë¥¼ functional componentsì˜ í•©ìœ¼ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤ : 
$$
\begin{aligned}
\hat{f}(x)= & \hat{f}_0+\hat{f}_1\left(x_1\right)+\ldots+\hat{f}_p\left(x_p\right) \\
& +\hat{f}_{1,2}\left(x_1, x_2\right)+\ldots+\hat{f}_{1, p}\left(x_1, x_p\right)+\ldots+\hat{f}_{p-1, p}\left(x_{p-1}, x_p\right) \\
& +\ldots \\
& +\hat{f}_{1, \ldots, p}\left(x_1, \ldots, x_p\right)
\end{aligned}
$$
í”¼ì³ ì¡°í•©ë“¤ì˜ ê°€ëŠ¥í•œ ëª¨ë“  ë¶€ë¶„ ì§‘í•©ì„ indexing í•˜ì—¬ ë¶„í•´ ê³µì‹ì„ ì¢€ ë” ê°„ë‹¨í•˜ê²Œ ìž‘ì„±í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤ : $S\subseteq\{1,\ldots,p\}$. ì´ ì§‘í•©ì—ëŠ” ì ˆíŽ¸ ($S=\emptyset$), ì£¼ íš¨ê³¼ ($|S|=1$), ëª¨ë“  ìƒí˜¸ìž‘ìš© ($|S| \ge 1$)ì´ í¬í•¨ë©ë‹ˆë‹¤. ì´ ë¶€ë¶„ ì§‘í•©ì„ ì •ì˜í•˜ë©´ ì•„ëž˜ì™€ ê°™ì´ ë¶„í•´ì‹ì„ ì“¸ ìˆ˜ ìžˆìŠµë‹ˆë‹¤ :
$$
\hat{f}(x)=\sum_{S \subseteq\{1, \ldots, p\}} \hat{f}_S\left(x_S\right)
$$
ê³µì‹ì—ì„œ $x_S$ëŠ” ì¸ë±ìŠ¤ ì§‘í•© $S$ì˜ í”¼ì³ ë²¡í„°ìž…ë‹ˆë‹¤. ê·¸ë¦¬ê³  ê° ë¶€ë¶„ ì§‘í•© $S$ëŠ” functional component (ì˜ˆ: $S$ì— í•˜ë‚˜ì˜ í”¼ì³ë§Œ í¬í•¨ëœ ê²½ìš° ì£¼íš¨ê³¼, $|S|>1$ì¸ ê²½ìš° ìƒí˜¸ìž‘ìš©)ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.

ìœ„ ê³µì‹ì—ëŠ” ëª‡ ê°œì˜ componentsê°€ ìžˆì„ê¹Œìš”? í”¼ì³ $1,\ldots,p$ ê°€ëŠ¥í•œ ë¶€ë¶„ ì§‘í•© $S$ì˜ ê²½ìš°ì˜ ìˆ˜ì¸ $\sum_{i=0}^p\left(\begin{array}{c}p \\ i\end{array}\right)=2^p$ ìž…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ í•œ í•¨ìˆ˜ê°€ 10ê°œì˜ í”¼ì³ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš° í•¨ìˆ˜ë¥¼ $2^{10}=1024$ ê°œì˜ componentsë¡œ ë¶„í•´í•  ìˆ˜ ìžˆëŠ” ê²ƒìž…ë‹ˆë‹¤. ê·¸ë¦¬ê³  í”¼ì³ê°€ ì¶”ê°€ë  ë•Œë§ˆë‹¤ ì´ ì»´í¬ë„ŒíŠ¸ì˜ ìˆ˜ëŠ” ê¸°ì¡´ì˜ 2ë°°ê°€ ë©ë‹ˆë‹¤. í•˜ì§€ë§Œ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ë¥¼ ê³„ì‚°í•˜ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥í•˜ê³ , ê·¸ëŸ¬ì§€ ì•ŠëŠ” ë˜ ë‹¤ë¥¸ ì´ìœ ëŠ” $|S| >2$ì¸ ì„±ë¶„ì€ ì‹œê°í™”ì™€ í•´ì„ì´ ì–´ë µê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤.

## 3. How not to Compute the Components II

ì—¬íƒœê¹Œì§€ëŠ” ì»´í¬ë„ŒíŠ¸/ì„±ë¶„ë“¤ì´ ì–´ë–»ê²Œ ì •ì˜ë˜ê³  ê³„ì‚°ë˜ëŠ”ì§€ì— ëŒ€í•´ì„œëŠ” ì–¸ê¸‰í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì»´í¬ë„ŒíŠ¸ì˜ ìˆ˜ì™€ ì°¨ì›, ê·¸ë¦¬ê³  ì´ë“¤ì˜ í•©ì´ ì›ëž˜/ê¸°ì¡´ì˜ í•¨ìˆ˜ë¥¼ ì‚°ì¶œí•´ì•¼ í•œë‹¤ëŠ” ì œì•½ ì¡°ê±´ë§Œ ë§í–ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ê·¸ ì»´í¬ë„ŒíŠ¸ë“¤ì— ëŒ€í•œ ì¶”ê°€ì ì¸ ì œì•½ì´ ì—†ë‹¤ë©´ ì´ë“¤ì€ unique í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¦‰, ì£¼ íš¨ê³¼ì™€ ìƒí˜¸ìž‘ìš© ë˜ëŠ” ì €ì°¨ ìƒí˜¸ìž‘ìš©(few features)ê³¼ ê³ ì°¨ ìƒí˜¸ìž‘ìš©(more features) ê°„ íš¨ê³¼ë¥¼ ì´ë™ì‹œí‚¬ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì´ ì„¹ì…˜ì˜ ì‹œìž‘ ë¶€ë¶„ì— ìžˆëŠ” ì˜ˆì œì—ì„œëŠ” ë‘ ê°œì˜ ì£¼ íš¨ê³¼ë¥¼ ëª¨ë‘ 0ìœ¼ë¡œ ì„¤ì •í•˜ê³  ê·¸ íš¨ê³¼ë¥¼ ìƒí˜¸ìž‘ìš© íš¨ê³¼ì— ì¶”ê°€í•  ê²ƒìž…ë‹ˆë‹¤. 

ë‹¤ìŒì€ ì»´í¬ë„ŒíŠ¸ë“¤ì— ëŒ€í•œ ì¶”ê°€ ì œì•½ ì¡°ê±´ì˜ í•„ìš”ì„±ì„ ë³´ì—¬ì£¼ëŠ” ë” ê·¹ë‹¨ì ì¸ ì˜ˆì‹œìž…ë‹ˆë‹¤. 3ì°¨ì› í•¨ìˆ˜ê°€ ìžˆë‹¤ê³  ê°€ì •í•´ ë³´ê² ìŠµë‹ˆë‹¤. ì´ í•¨ìˆ˜ì˜ ìƒê¹€ìƒˆëŠ” ì¤‘ìš”í•˜ì§€ ì•Šì§€ë§Œ, ì•„ëž˜ì™€ ê°™ì€ ë¶„í•´ê°€ ìž‘ë™í•©ë‹ˆë‹¤ :  $\hat{f}_0=0.12$. $\hat{f}_1(x_1)2\cdot x_1 +\text{shoes}$. $\hat{f}_2,\hat{f}_3, \hat{f}_{1,2},\hat{f}_{2,3}, \hat{f}_{1,3}$ëŠ” ëª¨ë‘ 0ìž…ë‹ˆë‹¤. ê·¸ë¦¬ê³  ì´ íŠ¸ë¦­ì„ ìœ„í•´ $\hat{f}_{1,2,3}(x_1,x_2,x_3)=\hat{f}(x)-\sum_{S\in\{1,\ldots,p\}}\hat{f}_S(x_S)$ë¡œ ì •ì˜í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ëª¨ë“  í”¼ì³ë“¤ì„ í¬í•¨í•˜ëŠ” ìƒí˜¸ìž‘ìš© í•­ì€ ë‚˜ë¨¸ì§€ íš¨ê³¼ë¥¼ ëª¨ë‘ í¡ìˆ˜í•˜ë©° ëª¨ë“  ì»´í¬ë„ŒíŠ¸ë“¤ì˜ í•©ì´ ì›ëž˜ì˜ ì˜ˆì¸¡í•¨ìˆ˜ë¥¼ ì œê³µí•œë‹¤ëŠ” ì˜ë¯¸ì—ì„œ ì •ì˜ìƒ í•­ìƒ ìž‘ë™í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ë¶„í•´ëŠ” ëª¨ë¸ì˜ í•´ì„ìœ¼ë¡œ ì œì‹œí•  ë•ŒëŠ” ì˜ë¯¸ê°€ ì—†ìŠµë‹ˆë‹¤.

ì´ëŸ¬í•œ ëª¨í˜¸í•¨(ambiguity)ì€ ì¶”ê°€ì ì¸ ì œì•½ì´ë‚˜ ì»´í¬ë„ŒíŠ¸ ê³„ì‚°ì„ ìœ„í•œ êµ¬ì²´ì ì¸ ë°©ë²•ì„ ì§€ì •í•¨ìœ¼ë¡œì¨ í”¼í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” í•¨ìˆ˜ ë¶„í•´ì— ëŒ€í•œ 3ê°€ì§€ ë°©ë²•ì„ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤ : 
- (Generalized) Functional ANOVA
- Accumulated Local Effects
- Statistical regression models

## 4. Functional ANOVA

Hooker (2004)ëŠ” Functional ANOVAë¥¼ ì œì•ˆí–ˆìŠµë‹ˆë‹¤. ì´ ì ‘ê·¼ë²•ì˜ ì „ì œ ì¡°ê±´ì€ ëª¨ë¸ ì˜ˆì¸¡ í•¨ìˆ˜ $\hat{f}$ ê°€ square integrable í•´ì•¼ í•œë‹¤ëŠ” ê²ƒìž…ë‹ˆë‹¤. functional ANOVA ëŠ” í•¨ìˆ˜ë¥¼ ì»´í¬ë„ŒíŠ¸ë“¤ë¡œ ë¶„í•´í•©ë‹ˆë‹¤ : 
$$
\hat{f}(x)=\sum_{S \subseteq\{1, \ldots, p\}} \hat{f}_S\left(x_S\right)
$$
Hooker (2004)ëŠ” ê° ì»´í¬ë„ŒíŠ¸ë¥¼ ë‹¤ìŒê³¼ ê°™ì€ ê³µì‹ìœ¼ë¡œ ì •ì˜í–ˆìŠµë‹ˆë‹¤ : 
$$
\hat{f}_S(x)=\int_{X_{-S}}\left(\hat{f}(x)-\sum_{V \subset S} \hat{f}_V(x)\right) d X_{-S}
$$
ì´ê²ƒì„ ë¶„í•´í•´ ë³´ê² ìŠµë‹ˆë‹¤. ì»´í¬ë„ŒíŠ¸ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ë‹¤ì‹œ ì“¸ ìˆ˜ ìžˆìŠµë‹ˆë‹¤ : 
$$
\hat{f}_S(x)=\int_{X_{-S}}(\hat{f}(x)) d X_{-S}-\int_{X_{-S}}\left(\sum_{V \subset S}) \hat{f}_V(x)\right) d X_{-S}
$$
ì²« ë²ˆì§¸ëŠ” ì§‘í•© $S$ì—ì„œ ì œì™¸ëœ í”¼ì³($-S$)ë“¤ì— ëŒ€í•œ ì˜ˆì¸¡ í•¨ìˆ˜ì— ëŒ€í•œ ì ë¶„ìž…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ì„œ í”¼ì³ 2ì™€ 3ì— ëŒ€í•œ 2-way ìƒí˜¸ìž‘ìš© ì„±ë¶„ì„ ê³„ì‚°í•˜ë©´ í”¼ì³ 1,4,5,... ì— ëŒ€í•´ ì ë¶„í•˜ëŠ” ê²ƒìž…ë‹ˆë‹¤. ì ë¶„ì€ ëª¨ë“  í”¼ì³ë“¤ì´ ìµœì†Œê°’ì—ì„œ ìµœëŒ€ê°’ê¹Œì§€ uniform ë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤ê³  ê°€ì •í•  ë•Œ $X_{-S}$ì— ëŒ€í•œ ì˜ˆì¸¡ í•¨ìˆ˜ì˜ ê¸°ëŒ“ê°’ìœ¼ë¡œ ë³¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì´ êµ¬ê°„ì—ì„œ $S$ì˜ ë¶€ë¶„ ì§‘í•©ì„ ê°–ëŠ” ëª¨ë“  ì»´í¬ë„ŒíŠ¸ë“¤ì„ ë»…ë‹ˆë‹¤. ì´ ëº„ì…ˆì€ ëª¨ë“  í•˜ìœ„ íš¨ê³¼(lower-order effects)ë¥¼ ì œê±°í•˜ê³  íš¨ê³¼ë¥¼ ì¤‘ì‹¬í™”í•©ë‹ˆë‹¤. $S=\{1,2\}$ ì˜ ê²½ìš° ë‘ í”¼ì³ $\hat{f}_1$ê³¼ $\hat{f}_2$ ì˜ ì£¼íš¨ê³¼ì™€ ì ˆíŽ¸ $\hat{f}_0$ì„ ëºë‹ˆë‹¤. ì´ëŸ¬í•œ í•˜ìœ„ íš¨ê³¼ì˜ ë°œìƒì€ ìˆ˜ì‹ì„ ìž¬ê·€ì ìœ¼ë¡œ ë§Œë“­ë‹ˆë‹¤ : ë¶€ë¶„ ì§‘í•©ì˜ ê³„ì¸µ êµ¬ì¡°ë¥¼ ê±°ì³ ì ˆíŽ¸ì— ë„ë‹¬í•œ í›„ ì´ ëª¨ë“  ì„±ë¶„ì„ ê³„ì‚°í•´ì•¼ í•©ë‹ˆë‹¤. ì ˆíŽ¸ ì„±ë¶„ $\hat{f}_0$ì˜ ê²½ìš° ë¶€ë¶„ ì§‘í•©ì€ ë¹ˆ ì§‘í•© $S=\{\emptyset\}$ì´ë¯€ë¡œ $-S$ ê°€ ëª¨ë“  í”¼ì³ë“¤ì„ í¬í•¨í•©ë‹ˆë‹¤.
$$
\hat{f}_0(x)=\int_X \hat{f}(x) d X
$$

ì´ê²ƒì€ ë‹¨ìˆœížˆ ëª¨ë“  í”¼ì³ë“¤ì— ëŒ€í•´ í†µí•©ëœ ì˜ˆì¸¡ í•¨ìˆ˜ìž…ë‹ˆë‹¤. ë˜í•œ ëª¨ë“  í”¼ì³ë“¤ì´ uniform ë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤ê³  í•  ë•Œ ì ˆíŽ¸ì€ ì˜ˆì¸¡ í•¨ìˆ˜ì˜ ê¸°ëŒ“ê°’ìœ¼ë¡œ í•´ì„í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì´ì œ $\hat{f}_0$ ì— ëŒ€í•´ ì•Œì•˜ìœ¼ë¯€ë¡œ $\hat{f}_1$ê³¼ $\hat{f}_2$ë¥¼ ê³„ì‚°í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 
$$
\hat{f}_1(x)=\int_{X_{-1}}\left(\hat{f}(x)-\hat{f}_0\right) d X_{-S}
$$
ì»´í¬ë„ŒíŠ¸ $\hat{f}_{1,2}$ì— ëŒ€í•œ ê³„ì‚°ì„ ì™„ë£Œí•˜ë ¤ë©´ ëª¨ë“  ê²ƒì„ í•©ì¹˜ë©´ ë©ë‹ˆë‹¤ :
$$
\begin{aligned}
\hat{f}_{1,2}(x) & =\int_{X_{3,4}}\left(\hat{f}(x)-\left(\hat{f}_0(x)+\hat{f}_1(x)-\hat{f}_0+\hat{f}_2(x)-\hat{f}_0\right)\right) d X_3, X_4 \\
& =\int_{X_{3,4}}\left(\hat{f}(x)-\hat{f}_1(x)-\hat{f}_2(x)+\hat{f}_0\right) d X_3, X_4
\end{aligned}
$$
ì´ ì˜ˆëŠ” ê° ê³ ì°¨ íš¨ê³¼(high-order effect)ê°€ ë‹¤ë¥¸ ëª¨ë“  í”¼ì³ë“¤ì„ í†µí•©í•˜ê³  ê´€ì‹¬ ìžˆëŠ” í”¼ì³ ì§‘í•©ì˜ ë¶€ë¶„ ì§‘í•©ì¸ ëª¨ë“  í•˜ìœ„ íš¨ê³¼ë¥¼ ì œê±°í•˜ì—¬ ì •ì˜ë˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.

Hooker (2004)ëŠ” ì´ëŸ¬í•œ functional components ì˜ ì •ì˜ê°€ ì•„ëž˜ì˜ ê³µë¦¬(axioms)ë“¤ì„ ë§Œì¡±í•œë‹¤ê³  í–ˆìŠµë‹ˆë‹¤ : 
- Zero Means :  $\int \hat{f}_S\left(x_S\right) d X_s=0$ for each $S\ne\emptyset$.
- Orthogonality : $\int \hat{f}_S\left(x_S\right) \hat{f}_V\left(x_v\right) d X=0$ for $S\ne V$
- Variance Decomposition : Let $\sigma_{\hat{f}}^2=\int \hat{f}(x)^2 d X$, then $\sigma^2(\hat{f})=\sum_{S \subseteq\{1, \ldots, p\}} \sigma_S^2\left(\hat{f}_S\right)$

Zero Means ê³µë¦¬ëŠ” ëª¨ë“  íš¨ê³¼ ë˜ëŠ” ìƒí˜¸ìž‘ìš©ì´ 0ì„ ì¤‘ì‹¬ìœ¼ë¡œ êµ¬ì„±ë¨ì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ê²°ê³¼ì ìœ¼ë¡œ xì—ì„œì˜ í•´ì„ì€ ì ˆëŒ€ì ì¸ ì˜ˆì¸¡ì¹˜ê°€ ì•„ë‹ˆë¼ ì¤‘ì‹¬í™”ëœ ì˜ˆì¸¡ì— ëŒ€í•œ ìƒëŒ€ì ì¸ í•´ì„ì¸ ê²ƒìž…ë‹ˆë‹¤.

Orthogonality ê³µë¦¬ëŠ” ì»´í¬ë„ŒíŠ¸ë¼ë¦¬ ì •ë³´ë¥¼ ê³µìœ í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ í”¼ì³ $X_1$ì˜ 1ì°¨ íš¨ê³¼ì™€ $X_1$, $X_2$ ê°„ ìƒí˜¸ìž‘ìš© í•˜ì€ ì„œë¡œ ìƒê´€ê´€ê³„ê°€ ì—†ìŠµë‹ˆë‹¤. ì§êµì„± ë•Œë¬¸ì— ëª¨ë“  ì»´í¬ë„ŒíŠ¸ëŠ” íš¨ê³¼ë¥¼ í˜¼í•©í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì˜ë¯¸ì—ì„œ "pure" í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, $X_4$ì˜ ì»´í¬ë„ŒíŠ¸ê°€ $X_1$ê³¼ $X_2$ ê°„ ìƒí˜¸ìž‘ìš©ê³¼ ë…ë¦½ì ì´ì–´ì•¼ í•œë‹¤ëŠ” ê²ƒì€ ë‹¹ì—°í•©ë‹ˆë‹¤. í•˜ë‚˜ì˜ ì»´í¬ë„ŒíŠ¸ê°€ ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ë“¤ì˜ í”¼ì³, ì˜ˆë¥¼ ë“¤ì–´ì„œ $X_1$ê³¼ $X_2$ ê°„ ìƒí˜¸ìž‘ìš©ê³¼ $X_1$ì˜ ì£¼íš¨ê³¼ë¥¼ í¬í•¨í•˜ëŠ” ê³„ì¸µì  ì»´í¬ë„ŒíŠ¸ì˜ ì§êµì„±ì—ì„œëŠ” í¥ë¯¸ë¡œìš´ ì¼ì´ ë°œìƒí•©ë‹ˆë‹¤. ì´ì™€ëŠ” ëŒ€ì¡°ì ìœ¼ë¡œ, $X_1$ê³¼ $X_2$ì— ëŒ€í•œ 2D-PDPëŠ” 4ê°œì˜ íš¨ê³¼, ì¦‰ ì ˆíŽ¸, $X_1$ê³¼ $X_2$ì˜ ì£¼íš¨ê³¼ì™€ ìƒí˜¸ìž‘ìš©ì„ í¬í•¨í•©ë‹ˆë‹¤. $\hat{f}_{1,2}(x_1,x_2)$ì— ëŒ€í•œ functional ANOVAëŠ” ìˆœìˆ˜í•œ ìƒí˜¸ìž‘ìš©ë§Œì„ í¬í•¨í•©ë‹ˆë‹¤. 

Variance decomposition ì„ ì‚¬ìš©í•˜ë©´ í•¨ìˆ˜ $\hat{f}$ì˜ ë¶„ì‚°ì„ ì»´í¬ë„ŒíŠ¸ë“¤ë¡œ ë¶„í•´í• ìˆ˜ ìžˆìœ¼ë©°, ìµœì¢…ì ìœ¼ë¡œ í•¨ìˆ˜ì˜ ì´ ë¶„ì‚°ì„ í•©ì‚°í•  ìˆ˜ ìžˆë‹¤ëŠ” ê²ƒì„ ë³´ìž¥í•©ë‹ˆë‹¤. ì´ê²ƒì´ "Functional ANOVA"ë¼ê³  ë¶€ë¥´ëŠ” ì´ìœ ìž…ë‹ˆë‹¤. ë¶„ì‚°ë¶„ì„ì€ targetì˜ í‰ê·  ì°¨ì´ë¥¼ ë¶„ì„í•˜ëŠ” ë°©ë²•ì„ ë§í•©ë‹ˆë‹¤. ANOVAëŠ” ë¶„ì‚°ì„ ë‚˜ëˆ„ê³  ì´ë¥¼ ë³€ìˆ˜ê°€ ê¸°ì—¬í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ìž‘ë™í•©ë‹ˆë‹¤. ë”°ë¼ì„œ functional ANOVA ëŠ” ì´ ê°œë…ì„ ëª¨ë“  í•¨ìˆ˜ë¡œ í™•ìž¥í•œ ê²ƒìœ¼ë¡œ ë³¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 

í•˜ì§€ë§Œ í”¼ì³ë“¤ì´ ìƒí˜¸ ì—°ê´€ë˜ì–´ ìžˆì„ ê²½ìš° functional ANOVA ëŠ” ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì´ì— ëŒ€í•œ í•´ê²°ì±…ìœ¼ë¡œ generalized functional ANOVA ê°€ ì œì•ˆë˜ì–´ ìžˆìŠµë‹ˆë‹¤.

## 5. Generalized Functional ANOVA for Dependent Features

ëŒ€ë¶€ë¶„ì˜ ìƒ˜í”Œë§ ë°ì´í„° ê¸°ë°˜ í•´ì„ ê¸°ë²•(ì˜ˆ: PDP)ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ, functional ANOVA ëŠ” í”¼ì³ë“¤ì´ ìƒí˜¸ ì—°ê´€ë˜ì–´ ìžˆì„ ë•Œ ë¬¸ì œê°€ ë°œìƒí•©ë‹ˆë‹¤. ê· ë“± ë¶„í¬ì— ëŒ€í•´ í†µí•©í•  ê²½ìš°, ì‹¤ì œë¡œëŠ” í”¼ì³ë“¤ì´ ì¢…ì†ì ì¸ joint ë¶„í¬ì—ì„œ ë²—ì–´ë‚˜ ê°€ëŠ¥ì„±ì´ ë‚®ì€ ì¡°í•©ìœ¼ë¡œ ì¶”ì •ë˜ëŠ” ìƒˆë¡œìš´ ë°ì´í„°ì…‹ì´ ë§Œë“¤ì–´ì§‘ë‹ˆë‹¤. 

Hooker (2007)ëŠ” dependent featuresì— ëŒ€í•´ ìž‘ë™í•˜ëŠ” ë¶„í•´ ê¸°ë²•ì¸ generalized functional anovaë¥¼ ì œì•ˆí–ˆìŠµë‹ˆë‹¤. ì»´í¬ë„ŒíŠ¸ë“¤ì€ $f$ ë¥¼ ê°€ë²•ì ì¸ í•¨ìˆ˜ë“¤ì˜ ê³µê°„ì— ì‚¬ì˜ì‹œí‚¨ ê²ƒìœ¼ë¡œ ì •ì˜ë©ë‹ˆë‹¤ : 
$$
\hat{f}_S\left(x_S\right)=\operatorname{argmin}_{g_S \in L^2\left(\mathbb{R}^S\right)_{S \in P}} \int\left(\hat{f}(x)-\sum_{S \subset P} g_S\left(x_S\right)\right)^2 w(x) d x .
$$

ì»´í¬ë„ŒíŠ¸ë“¤ì€ orthogonality ëŒ€ì‹  ê³„ì¸µì  ì§êµì„± ì¡°ê±´(hierarchical orthogonality condition)ì„ ë§Œì¡±í•©ë‹ˆë‹¤ :
$$
\forall \hat{f}_S\left(x_S\right) \mid S \subset U: \int \hat{f}_S\left(x_S\right) \hat{f}_U\left(x_U\right) w(x) d x=0
$$
ê³„ì¸µì  ì§êµëŠ” ì§êµì™€ëŠ” ë‹¤ë¦…ë‹ˆë‹¤. ë‘ ê°œì˜ ì§‘í•© $S$ì™€ $U$ì— ëŒ€í•˜ì—¬, ì–´ëŠ ìª½ë„ ë‹¤ë¥¸ ìª½ì˜ ë¶€ë¶„ì§‘í•©ì´ ì•„ë‹Œ ê²½ìš°, ë¶„í•´ê°€ ê³„ì¸µì  ì§êµê°€ ë˜ê¸° ìœ„í•´ ì„±ë¶„ $\hat{f}_S$ ë° $\hat{f}_U$ê°€ ì§êµì¼ í•„ìš”ëŠ” ì—†ìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ $S$ì˜ ëª¨ë“  ë¶€ë¶„ì§‘í•©ì— ëŒ€í•œ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ëŠ” $\hat{f}_S$ì— ì§êµí•´ì•¼ í•©ë‹ˆë‹¤. ê²°ê³¼ì ìœ¼ë¡œ í•´ì„ì€ ë‹¬ë¼ì§‘ë‹ˆë‹¤ : ALE ì±•í„°ì˜ M-plotê³¼ ìœ ì‚¬í•˜ê²Œ generalized functional ANOVAëŠ” ìƒê´€ëœ í”¼ì³ë“¤ì˜ (ì£¼ë³€) íš¨ê³¼ë¥¼ í¬í•¨í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì»´í¬ë„ŒíŠ¸ê°€ ì£¼ë³€ íš¨ê³¼ë¥¼ í¬í•¨í• ì§€ ì—¬ë¶€ëŠ” ê°€ì¤‘ì¹˜ í•¨ìˆ˜ $w(x)$ì— ë”°ë¼ ë‹¬ë¼ì§‘ë‹ˆë‹¤. ë‹¨ìœ„ íë¸Œ(unit cube)ì˜  uniform measure ìœ¼ë¡œ $w$ ì„ ì„ íƒí•˜ë©´ functional ANOVA ë¥¼ êµ¬í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. $w$ì— ëŒ€í•œ ìžì—°ìŠ¤ëŸ¬ìš´ ì„ íƒì€ joint pdf ìž…ë‹ˆë‹¤. í•˜ì§€ë§Œ joint distribution ì€ ë³´í†µ ì•Œ ìˆ˜ ì—†ìœ¼ë©´ ì¶”ì •ì´ ì–´ë µìŠµë‹ˆë‹¤. í•œ ê°€ì§€ ìš”ë ¹ì€ unit cubeì˜ uniform measure ë¡œ ì‹œìž‘í•˜ì—¬ ë°ì´í„°ê°€ ì—†ëŠ” ì˜ì—­ì„ ìž˜ë¼ë‚´ëŠ” ê²ƒìž…ë‹ˆë‹¤. 

ì´ ì¶”ì •ì€ í”¼ì³ ê³µê°„ì˜ gridì—ì„œ ìˆ˜í–‰ë˜ë©° íšŒê·€ ê¸°ë²•ì„ ì‚¬ìš©í•˜ì—¬ í•´ê²°í•  ìˆ˜ ìžˆëŠ” minimization ë¬¸ì œìž…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì»´í¬ë„ŒíŠ¸ë“¤ì€ ê°œë³„ì  ë˜ëŠ” ê³„ì¸µì ìœ¼ë¡œ ê³„ì‚°í•  ìˆ˜ ì—†ìœ¼ë©°, ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ë“¤ê³¼ ê´€ë ¨ëœ ë³µìž¡í•œ ë°©ì •ì‹ìœ¼ë¡œ í’€ì–´ì•¼ í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ê³„ì‚°ì´ ë§¤ìš° ë³µìž¡í•©ë‹ˆë‹¤.

## 6. Accumulated Local Effect Plots

ALE plot ë„ í•¨ìˆ˜ ë¶„í•´ë¥¼ ì œê³µí•˜ë¯€ë¡œ ì ˆíŽ¸, 1D-ALE, 2D-ALE ë“±ì˜ ëª¨ë“  ALE plotë“¤ì„ ë”í•˜ë©´ ì˜ˆì¸¡ í•¨ìˆ˜ë¥¼ ì–»ì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ALEëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ì§êµ(orthogonal)í•˜ì§€ ì•Šê³  ìœ ì‚¬ ì§êµ(pseudo-orthogonal)í•˜ê¸° ë•Œë¬¸ì— (generalized) functional ANOVAì™€ëŠ” ë‹¤ë¦…ë‹ˆë‹¤. pseudo-orthogonalityë¥¼ ì´í•´í•˜ë ¤ë©´ í•¨ìˆ˜ $\hat{f}$ ë¥¼ ì·¨í•˜ì—¬ í”¼ì³ ë¶€ë¶„ ì§‘í•© $S$ ì— ëŒ€í•œ ALE plotì— ë§¤í•‘í•˜ëŠ” ì—°ì‚°ìž $H_S$ë¥¼ ì •ì˜í•´ì•¼ í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, $H_{1,2}$ ì—°ì‚°ìžëŠ” ML ëª¨ë¸ì„ ìž…ë ¥(input)ìœ¼ë¡œ ë°›ì•„ í”¼ì³ 1ê³¼2ì— ëŒ€í•œ 2D-ALE plotì„ ë§Œë“­ë‹ˆë‹¤ : $H_{1,2}(\hat{f})=\hat{f}_{A L E, 12}$ . ë™ì¼í•œ ì—°ì‚°ìžë¥¼ ë‘ ë²ˆ ì ìš©í•˜ë©´ ë™ì¼í•œ ALE plotì„ ì–»ì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì—°ì‚°ìž $H_{1,2}$ë¥¼ $f$ ì— í•œ ë²ˆ ì ìš©í•˜ë©´ 2D-ALE plot $\hat{f}_{ALE,12}$ë¥¼ ì–»ìŠµë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ì—°ì‚°ìžë¥¼ $f$ ê°€ì•„ë‹Œ $\hat{f}_{ALE, 12}$ì— ë‹¤ì‹œ ì ìš©í•©ë‹ˆë‹¤. ì´ëŠ” 2D-ALE ì»´í¬ë„ŒíŠ¸ ìžì²´ê°€ í•¨ìˆ˜ê¸° ë•Œë¬¸ì— ê°€ëŠ¥í•©ë‹ˆë‹¤. ê·¸ ê²°ê³¼ëŠ” ë‹¤ì‹œ $\hat{f}_{ALE, 12}$ì´ë¯€ë¡œ ë™ì¼í•œ ì—°ì‚°ìžë¥¼ ì—¬ëŸ¬ ë²ˆ ì ìš©í•´ë„ í•­ìƒ ë™ì¼í•œ ALE plotì´ ì–»ì–´ì§‘ë‹ˆë‹¤. ì´ê²ƒì´ pseudo-orthogonality ì˜ ì²« ë²ˆì§¸ ë¶€ë¶„ìž…ë‹ˆë‹¤. í•˜ì§€ë§Œ ì„œë¡œ ë‹¤ë¥¸ í”¼ì³ ì§‘í•©ì— ëŒ€í•´ ì„œë¡œ ë‹¤ë¥¸ ë‘ ê°œì˜ ì—°ì‚°ìžë¥¼ ì ìš©í•˜ë©´ ì–´ë–¤ ê²°ê³¼ê°€ ë‚˜ì˜¬ê¹Œìš”? ì˜ˆë¥¼ ë“¤ì–´, $H_{1,2}$ì™€ $H_1$ ë˜ëŠ” $H_{1,2}$ì™€ $H_{3,4,5}$ ? ë‹µì€ 0ìž…ë‹ˆë‹¤. ì¦‰, ë™ì¼í•œ ALE plotì„ ë‘ ë²ˆ ì ìš©í•˜ì§€ ì•ŠëŠ” í•œ ALE plotì˜ ALE plotì€ 0ìž…ë‹ˆë‹¤. ë‹¤ì‹œ ë§í•´, í”¼ì³ ì§‘í•© $S$ì— ëŒ€í•œ ALE plotì€ ë‹¤ë¥¸ ALE plotì´ í¬í•¨ë˜ì–´ ìžˆì§€ ì•Šë‹¤ëŠ” ëœ»ìž…ë‹ˆë‹¤. ìˆ˜í•™ì ì¸ ìš©ì–´ë¡œ, ALE ì—°ì‚°ìžëŠ” í•¨ìˆ˜ë¥¼ ë‚´ì  ê³±(inner product) spaceì˜ orthogonal subspacesì— ë§¤í•‘í•©ë‹ˆë‹¤. 

Apleyì™€ Zhu(2020)ê°€ ì§€ì í–ˆë“¯ì´, pseudo-orthogonality ëŠ” í”¼ì³ì˜ ì£¼ë³€ íš¨ê³¼ë¥¼ í¬í•¨í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ê³„ì¸µì  ì§êµë³´ë‹¤ ë” ë°”ëžŒì§í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ë˜í•œ ALEëŠ” joint distributionì„ ì¶”ì •í•  í•„ìš”ê°€ ì—†ìœ¼ë©°, ì»´í¬ë„ŒíŠ¸ë“¤ì„ ê³„ì¸µì ìœ¼ë¡œ ì¶”ì •í•  ìˆ˜ ìžˆìœ¼ë¯€ë¡œ í”¼ì³ 1ê³¼ 2ì— ëŒ€í•œ 2D-ALEë¥¼ ê³„ì‚°í•˜ë ¤ë©´ ê°œë³„ ALE ì™€ ì ˆíŽ¸ í•­ì„ ì¶”ê°€ë¡œ ê³„ì‚°í•˜ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.

## 7. Statistical Regression Models

ì´ ë°©ì‹ì€ interpretable models, íŠ¹ížˆ GAMsì™€ ê´€ë ¨ë˜ì–´ ìžˆìŠµë‹ˆë‹¤. ë³µìž¡í•œ í•¨ìˆ˜ë¥¼ ë¶„í•´í•˜ëŠ” ëŒ€ì‹  ëª¨ë¸ë§ í”„ë¡œì„¸ìŠ¤ì— ì œì•½ ì¡°ê±´ì„ êµ¬ì¶•í•´ ê°œë³„ ì»´í¬ë„ŒíŠ¸ë¥¼ ì‰½ê²Œ ë³¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ë¶„í•´ëŠ” ê³ ì°¨ì› í•¨ìˆ˜ì—ì„œ ì‹œìž‘í•´ ë¶„í•´í•˜ëŠ” í•˜í–¥ì‹(top-down) ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìžˆì§€ë§Œ, GAMsëŠ” ê°„ë‹¨í•œ ì»´í¬ë„ŒíŠ¸ì—ì„œ ëª¨ë¸ì„ êµ¬ì¶•í•˜ëŠ” ìƒí–¥ì‹(bottom-up) ë°©ì‹ì„ ì œê³µí•©ë‹ˆë‹¤. ë‘ ë°©ì‹ ëª¨ë‘ ê°œë³„ì ì´ê³  í•´ì„ ê°€ëŠ¥í•œ ì»´í¬ë„ŒíŠ¸ë“¤ì„ ì œê³µí•˜ëŠ” ê²ƒì´ ëª©í‘œìž…ë‹ˆë‹¤. í†µê³„ ëª¨ë¸ì—ì„œëŠ” ì»´í¬ë„ŒíŠ¸ ìˆ˜ë¥¼ ì œí•œí•˜ì—¬ $2^p$ ê°œì˜ ì»´í¬ë„ŒíŠ¸ ëª¨ë‘ë¥¼ ì í•©í•  í•„ìš”ê°€ ì—†ë„ë¡ í•©ë‹ˆë‹¤. ê°€ìž¥ ê°„ë‹¨í•œ ë²„ì „ì€ ì„ í˜• íšŒê·€ìž…ë‹ˆë‹¤ :
$$
\hat{f}(x)=\beta_0+\beta_1 x_1+\ldots \beta_p x_p
$$
ì´ ìˆ˜ì‹ì€ í•¨ìˆ˜ ë¶„í•´ì™€ ë§¤ìš° ìœ ì‚¬í•´ ë³´ì´ì§€ë§Œ ë‘ ê°€ì§€ ë³€í˜•ì´ ìžˆìŠµë‹ˆë‹¤ : 
1) ëª¨ë“  ìƒí˜¸ìž‘ìš© íš¨ê³¼ëŠ” ì œì™¸ë˜ê³  ì ˆíŽ¸ê³¼ ì£¼íš¨ê³¼ë§Œ ìœ ì§€ë©ë‹ˆë‹¤.
2) ì£¼ íš¨ê³¼ëŠ” í”¼ì³ì—ì„œ ì„ í˜•íš¨ê³¼ë§Œ ìžˆì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤ : $\hat{f}_j(x_j)=\beta_jx_j$.
ì„ í˜• íšŒê·€ ëª¨ë¸ì„ í•¨ìˆ˜ ë¶„í•´ ê´€ì ì—ì„œ ë³´ë©´, ëª¨ë¸ ìžì²´ê°€ í”¼ì³ì—ì„œ targetìœ¼ë¡œ ë§¤í•‘ë˜ëŠ” ì‹¤ì œ í•¨ìˆ˜ì˜ í•¨ìˆ˜ ë¶„í•´ë¥¼ ë‚˜íƒ€ë‚´ì§€ë§Œ, íš¨ê³¼ê°€ ì„ í˜•ì ì´ê³  ìƒí˜¸ìž‘ìš©ì´ ì—†ë‹¤ëŠ” ê°•í•œ ì¡°ê±´ í•˜ì— ìžˆìŠµë‹ˆë‹¤.

GAMì€ ìŠ¤í”Œë¼ì¸ì„ ì‚¬ìš©í•´ ë³´ë‹¤ ë³µìž¡í•œ í•¨ìˆ˜ $\hat{f}_j$ë¥¼ í—ˆìš©í•¨ìœ¼ë¡œì¨ ë‘ ë²ˆì§¸ ì„ í˜•ì„± ê°€ì •ì„ ì™„í™”í•©ë‹ˆë‹¤. ìƒí˜¸ìž‘ìš©ì„ ì¶”ê°€í•  ìˆ˜ ìžˆê¸´í•˜ì§€ë§Œ ì´ëŠ” ë‹¤ì†Œ ìˆ˜ë™ì ìž…ë‹ˆë‹¤. GA2M ê³¼ ê°™ì€ ë°©ì‹ì€ ì–‘ë°©í–¥ ìƒí˜¸ìž‘ìš©ì„ GAMì— ì¶”ê°€í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

ì„ í˜• íšŒê·€ ëª¨ë¸ì´ë‚˜ GAMì„ í•¨ìˆ˜ ë¶„í•´ë¡œ ê°„ì£¼í•˜ë©´ í˜¼ë™ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì´ ì„¹ì…˜ì˜ ì•žë¶€ë¶„ì—ì„œ ì„¤ëª…í•œ ë¶„í•´ ë°©ì‹(generalized functional ANOVA ë° ALE)ì„ ì ìš©í•˜ë©´ GAMì—ì„œ ë³´ëŠ” ê²ƒê³¼ëŠ” ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ë“¤ì„ ì–»ê²Œ ë©ë‹ˆë‹¤. ì´ê²ƒì€ ìƒí˜¸ ì—°ê´€ëœ í”¼ì³ë“¤ì˜ ìƒí˜¸ìž‘ìš© íš¨ê³¼ê°€ GAMì—ì„œ ëª¨ë¸ë§ë  ë•Œ ë°œìƒí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ë¶ˆì¼ì¹˜ëŠ” ë‹¤ë¥¸ í•¨ìˆ˜ ë¶„í•´ ë°©ì‹ì´ ìƒí˜¸ìž‘ìš© íš¨ê³¼ì™€ ì£¼íš¨ê³¼ ê°„ íš¨ê³¼ë¥¼ ë‹¤ë¥´ê²Œ ë¶„í•´í•˜ê¸° ë•Œë¬¸ì— ë°œìƒí•©ë‹ˆë‹¤. 

ê·¸ë ‡ë‹¤ë©´ ì–¸ì œ ë³µìž¡í•œ ëª¨ë¸ì˜ ê°€ë²• ë¶„í•´ ëŒ€ì‹  GAM ì„ ì‚¬ìš©í•´ì•¼ í• ê¹Œìš”? ëŒ€ë¶€ë¶„ì˜ ìƒí˜¸ìž‘ìš©ì´ 0ì¸ ê²½ìš°, íŠ¹ížˆ 3ê°œ ì´ìƒì˜ í”¼ì³ì— ëŒ€í•´ì„œ ìƒí˜¸ìž‘ìš©ì´ ì—†ëŠ” ê²½ìš°ì— GAMì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. ìƒí˜¸ìž‘ìš©ì— ê´€ë ¨ëœ ìµœëŒ€ í”¼ì³ ìˆ˜ê°€ ë‘ ê°œ($|S| \le 2$), MARS ë˜ëŠ” GA2Mê³¼ ê°™ì€ ë°©ì‹ì„ ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ê¶ê·¹ì ìœ¼ë¡œ ë­ê°€ ë” ë‚˜ì€ì§€ëŠ” test setì— ëŒ€í•œ ì„±ëŠ¥ì¹˜ê°€ ë‚˜íƒ€ë‚´ì¤„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

## 8. Bonus : PDP

PDPëŠ” í•¨ìˆ˜ ë¶„í•´ë¥¼ ì œê³µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í”¼ì³ ì§‘í•© $S$ ì— ëŒ€í•œ PDPëŠ” í•­ìƒ ê³„ì¸µ êµ¬ì¡°ì˜ ëª¨ë“  íš¨ê³¼ë¥¼ í¬í•¨í•˜ë©°, $\{1,2\}$ì— ëŒ€í•œ PDPëŠ” ìƒí˜¸ìž‘ìš© ë¿ì•„ë‹ˆë¼ ê°œë³„ íš¨ê³¼ë„ í¬í•¨í•©ë‹ˆë‹¤. ê²°ê³¼ì ìœ¼ë¡œ ëª¨ë“  ë¶€ë¶„ì§‘í•©ì— ëŒ€í•œ ëª¨ë“  PDPë¥¼ ë”í•´ë„ ì›ëž˜ í•¨ìˆ˜ê°€ ë‚˜ì˜¤ì§€ ì•Šìœ¼ë¯€ë¡œ í•¨ìˆ˜ ë¶„í•´ê°€ ì•„ë‹™ë‹ˆë‹¤. 

## 9. Advantages

Functional decompositionì´ ML interpretationì˜ í•µì‹¬ ê°œë…ìž…ë‹ˆë‹¤.

í•¨ìˆ˜ ë¶„í•´ëŠ” ê³ ì°¨ì›ì ì´ê³  ë³µìž¡í•œ ëª¨ë¸ì„ ê°œë³„ íš¨ê³¼ì™€ ìƒí˜¸ìž‘ìš©ìœ¼ë¡œ ë¶„í•´í•˜ëŠ” ì´ë¡ ì  ê·¼ê±°ë¥¼ ì œê³µí•˜ë©°, ê°œë³„ íš¨ê³¼ë¥¼ í•´ì„í•˜ëŠ” ë° í•„ìˆ˜ì ì¸ ë‹¨ê³„ìž…ë‹ˆë‹¤. í•¨ìˆ˜ ë¶„í•´ëŠ” statistical regression models, ALE, (generalized) functional anova, PDP, H-statistic, ICE curveì™€ ê°™ì€ ê¸°ë²•ì˜ í•µì‹¬ ì•„ì´ë””ì–´ ìž…ë‹ˆë‹¤. 

ë˜í•œ í•¨ìˆ˜ ë¶„í•´ëŠ” ë‹¤ë¥¸ ë°©ë²•ë“¤ì„ ë” ìž˜ ì´í•´í•  ìˆ˜ ìžˆë„ë¡ í•´ì¤ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ permutation feature importanceëŠ” í”¼ì³ì™€ targer ê°„ ì—°ê´€ì„±ì„ ë¶„ì„í•©ë‹ˆë‹¤. í•¨ìˆ˜ ë¶„í•´ ê´€ì ìœ¼ë¡œ ë³´ë©´ ìˆœì—´(permutation)ì´ í”¼ì³ì™€ ê´€ë ¨ëœ ëª¨ë“  êµ¬ì„± ìš”ì†Œ(components)ì˜ íš¨ê³¼ë¥¼ 'íŒŒê´´(destroys)' í•©ë‹ˆë‹¤. ì´ëŠ” í”¼ì³ì˜ ì£¼ íš¨ê³¼ ë¿ ì•„ë‹ˆë¼ ë‹¤ë¥¸ í”¼ì³ë“¤ê³¼ì˜ ëª¨ë“  ìƒí˜¸ ìž‘ìš©ì—ë„ ì˜í–¥ì„ ë¯¸ì¹©ë‹ˆë‹¤. ë˜ ë‹¤ë¥¸ ì˜ˆë¡œ, Shapley valuesëŠ” ì˜ˆì¸¡ì¹˜ë¥¼ ê°œë³„ í”¼ì³ì˜ ì¶”ê°€/ê°€ë²•ì ì¸ íš¨ê³¼ë¡œ ë¶„í•´í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ í•¨ìˆ˜ ë¶„í•´ëŠ” ë¶„í•´ì— ìƒí˜¸ìž‘ìš© íš¨ê³¼ë„ ìžˆì–´ì•¼ í•¨ì„ ì•Œë ¤ì£¼ëŠ”ë°, ê·¸ë ‡ë‹¤ë©´ ìƒí˜¸ìž‘ìš© íš¨ê³¼ëŠ” ì–´ë””ì— ìžˆì„ê¹Œìš”? Shapley valuesëŠ” ê°œë³„ í”¼ì³ì— ëŒ€í•œ íš¨ê³¼ì˜ ê³µì •í•œ ê¸°ì—¬ë„ë¥¼ ì œê³µí•˜ë¯€ë¡œ ëª¨ë“  ìƒí˜¸ìž‘ìš©ë„ í”¼ì³ì— ëŒ€í•œ ê³µì •í•œ ê¸°ì—¬ë„ë¥¼ ê°€ì§€ë©°, ë”°ë¼ì„œ Shpley values ë¡œ ë‚˜ëˆ„ì–´ì§‘ë‹ˆë‹¤. 

í•¨ìˆ˜ ë¶„í•´ë¥¼ ë„êµ¬ë¡œ ê³ ë ¤í•  ë•Œ, ALE plotì„ ì‚¬ìš©í•˜ë©´ ë§Žì€ ì´ì ì„ ì–»ì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ALE plotì€ ê³„ì‚° ì†ë„ê°€ ë¹ ë¥´ê³ , S/W êµ¬í˜„ì´ ê°€ëŠ¥í•˜ë©°, ë°”ëžŒì§í•œ pseudo-orthogonalityë¥¼ ê°€ì§„ í•¨ìˆ˜ ë¶„í•´ë¥¼ ì œê³µí•©ë‹ˆë‹¤. 

## 10. Disadvantages

í•¨ìˆ˜ ë¶„í•´ì˜ ê°œë…ì€ ë‘ í”¼ì³ ê°„ ìƒí˜¸ìž‘ìš©ì„ ë„˜ì–´ì„œëŠ” ê³ ì°¨ì› ì»´í¬ë„ŒíŠ¸ë“¤ì— ëŒ€í•´ ë¹ ë¥´ê²Œ í•œê³„ì ì´ ì˜µë‹ˆë‹¤. í”¼ì³ ìˆ˜ê°€ ì¦ê°€í•˜ë©´ ê³ ì°¨ ìƒí˜¸ìž‘ìš©ì„ ì‹œê°í™”í•˜ëŠ” ê²ƒì´ ì–´ë µê¸° ë•Œë¬¸ì— ì‹¤ìš©ì„±ì´ ì œí•œë˜ê³ , ëª¨ë“  ìƒí˜¸ìž‘ìš©ì„ ê³„ì‚°í•˜ë ¤ë©´ ê³„ì‚° ì‹œê°„ì´ ì—„ì²­ ê¸¸ì–´ì§‘ë‹ˆë‹¤. 

ê° í•¨ìˆ˜ ë¶„í•´ ë°©ë²•ë“¤ì—ëŠ” ë‹¨ì ì´ ìžˆìŠµë‹ˆë‹¤. ìƒí–¥ì‹(bottom-up) ë°©ì‹ì¸ íšŒê·€ ëª¨ë¸ êµ¬ì¶•ì€ ìƒë‹¹ížˆ ìˆ˜ë™ì ì´ë©° ì˜ˆì¸¡ ì„±ëŠ¥ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìžˆëŠ” ë§Žì€ ì œì•½ë“¤ì´ ìžˆìŠµë‹ˆë‹¤. Functional ANOVA ëŠ” ë…ë¦½ì ì¸ í”¼ì³ë“¤ì´ í•„ìš”í•©ë‹ˆë‹¤. Genearlized functional ANOVA ëŠ” ì¶”ì •ì´ ë§¤ìš° ì–´ë µìŠµë‹ˆë‹¤. ALE plot ì€ ë¶„ì‚° ë¶„í•´ë¥¼ ì œê³µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

í•¨ìˆ˜ ë¶„í•´ ë°©ì‹ì€ í…ìŠ¤íŠ¸ë‚˜ ì´ë¯¸ì§€ë³´ë‹¤ tabular dataë¥¼ ë¶„ì„í•˜ëŠ” ë° ë” ì í•©í•©ë‹ˆë‹¤.

---
# ðŸ“•08-05. Permutataion Feature Importance

ìˆœì—´ ë³€ìˆ˜ ì¤‘ìš”ë„(Permutation Feature Importance; PFI)ëŠ” í”¼ì³ë“¤ì„ ì„žì–´ì„œ true outcomeê³¼ í”¼ì³ ê°„ ê´€ê³„(relatioship)ì„ ëŠì€ í›„ ëª¨ë¸ì˜ ì˜ˆì¸¡ ì˜¤ì°¨(prediction error)ì˜ ì¦ê°€ê°’ì„ ì¸¡ì •í•©ë‹ˆë‹¤. 

## 1. Theory

ê°œë…ì€ ë§¤ìš° ì‰½ìŠµë‹ˆë‹¤ : í”¼ì³ë“¤ì„ ì„žì€ í›„ ëª¨ë¸ì˜ ì˜ˆì¸¡ ì˜¤ì°¨ì˜ ì¦ê°€ëŸ‰ì„ ê³„ì‚°í•´ ë³€ìˆ˜ ì¤‘ìš”ë„ë¥¼ ì¸¡ì •í•©ë‹ˆë‹¤. ì´ ë•Œ í”¼ì³ ê°’ì„ ì„žìœ¼ë©´ ëª¨ë¸ ì˜¤ë¥˜ê°€ ì¦ê°€í•˜ëŠ” ê²½ìš°ëŠ” ëª¨ë¸ì´ ì˜ˆì¸¡í•˜ëŠ” ë°ì— ê·¸ í”¼ì³ì— ì˜ì¡´í–ˆê¸° ë•Œë¬¸ì— í•´ë‹¹ í”¼ì³ê°€ "ì¤‘ìš”(important)"í•©ë‹ˆë‹¤. í”¼ì³ ê°’ì„ ì„žì–´ë„ ëª¨ë¸ ì˜¤ë¥˜ê°€ ë³€í•˜ì§€ ì•Šìœ¼ë©´ "ì¤‘ìš”í•˜ì§€ ì•ŠìŒ" ìœ¼ë¡œ ê°„ì£¼ë˜ë©°, ì´ ê²½ìš° ëª¨ë¸ì´ ì˜ˆì¸¡í•˜ëŠ” ë° í•´ë‹¹ í”¼ì³ë¥¼ ë¬´ì‹œí–ˆë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ìˆœì—´ í”¼ì³ ì¤‘ìš”ë„(PFI)ì˜ ì¸¡ì •ì€ Breiman (2001)ì´ Random Forestì—ì„œ ë„ìž…í–ˆìŠµë‹ˆë‹¤. ì´ ì•„ì´ë””ì–´ë¥¼ ë°”íƒ•ìœ¼ë¡œ Fisher, Rudin, Dominici (2018)ëŠ” ë³´ë‹¤ ë°œì „ëœ model-agnostic versionì˜ ë³€ìˆ˜ ì¤‘ìš”ë„ë¥¼ ì†Œê°œí–ˆìŠµë‹ˆë‹¤. ì´ ë…¼ë¬¸ì˜ ì£¼ìš” ë‚´ìš©ì„ ì†Œê°œí•˜ê² ìŠµë‹ˆë‹¤.

#### The Permutation Feature Importance algorithm based on Fisher, Rudin and Dominici (2018) :

- Input : Trained model $\hat{f}$, feature matrix $X$, target vector $y$, error measure $L(y,\hat{f})$
	1. ê¸°ì¡´ ëª¨ë¸ ì˜¤ì°¨ $e_{orig} = L(y,\hat{f}(X))$ë¥¼ ì¶”ì •í•˜ì„¸ìš” : e.g. mean squared error
	2. ê° feature $j\in \{1,\ldots,p\}$ì— ëŒ€í•´ ì•„ëž˜ ê³¼ì •ì„ ì§„í–‰í•˜ì„¸ìš” : 
		- $X$ì— ìžˆëŠ” $j$ ë²ˆì§¸ featureë¥¼ ì„žì–´ì„œ(permute) featuer matrix $X_{perm}$ì„ ë§Œë“œì„¸ìš”. ì´ ë™ìž‘ì€ true outcome $y$ê³¼ feature $j$ ê°„ ì—°ê´€ì„±ì„ ëŠëŠ” ê²ƒìž…ë‹ˆë‹¤. 
		- ì„žì¸ ë°ì´í„°ë¥¼ ì´ìš©í•œ ì˜ˆì¸¡ì¹˜ë¡œë¶€í„° ì˜¤ì°¨ $e_{perm} = L(Y,\hat{f}(X_{perm}))$ë¥¼ ì¶”ì •í•˜ì„¸ìš”.
		- PFI ë¥¼ ë¶„ìˆ˜ $FI_j = e_{perm}/e_{orig}$ ì´ë‚˜ ì°¨ì´ê°’ $FI_j=e_{perm}-e_{orig}$ë¡œ ê³„ì‚°í•˜ì„¸ìš”.
	3. $p$ ê°œì˜ $FI$ ê°’ë“¤ì„ ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ ì •ë ¬í•˜ì„¸ìš”.

Fisher, Rudin, and Dominici (2018)ëŠ” ë…¼ë¬¸ì—ì„œ ë°ì´í„°ì…‹ì„ ì ˆë°˜ìœ¼ë¡œ ë¶„í• í•˜ê³  í”¼ì³ $j$ë¥¼ ì„žëŠ” ëŒ€ì‹  ê° ë¶„í• ì˜ í”¼ì³ê°’ì„ êµí™˜í•˜ëŠ” ë°©ë²•ì„ ì œì•ˆí•©ë‹ˆë‹¤. ë” ì •í™•í•œ ì¶”ì •ì„ ì›í•œë‹¤ë©´, ê° ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ì˜ í”¼ì³ $j$ ê°’ê³¼ ì§ ì§€ì–´(ìžì‹ ì€ ì œì™¸)ì„œ í”¼ì³ $j$ ë¥¼ permute í•˜ëŠ” ì˜¤ì°¨ë¥¼ ì¶”ì •í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ìˆœì—´ ì˜¤ì°¨ (permutation error)ë¥¼ ì¶”ì •í•  ìˆ˜ ìžˆëŠ” í¬ê¸°ê°€ `n(n-1)`ì˜ ë°ì´í„°ì…‹ì´ í•„ìš”í•˜ë©°, ê³„ì‚° ì‹œê°„ë¯¸ ë§Žì´ ê±¸ë¦½ë‹ˆë‹¤. ë§¤ìš° ì •í™•í•œ ì¶”ì •ì¹˜ë¥¼ ì–»ê³ ìž í•˜ëŠ” ê²½ìš°ì—ë§Œ n(n-1)-methodë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

## 2. Should I Compute Importance on Training or Test Data?

**ìš”ì•½ : test dataë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.**

ì´ ì§ˆë¬¸ì— ë‹µí•˜ëŠ” ê²ƒì€ ë³€ìˆ˜ ì¤‘ìš”ë„ê°€ ë¬´ì—‡ì¸ì§€ì— ëŒ€í•œ ê·¼ë³¸ì ì¸ ì§ˆë¬¸ìž…ë‹ˆë‹¤. Train set ê¸°ë°˜ ë³€ìˆ˜ ì¤‘ìš”ë„ì™€ test set ê¸°ë°˜ ë³€ìˆ˜ ì¤‘ìš”ë„ì˜ ì°¨ì´ë¥¼ ì´í•´í•˜ëŠ” ê°€ìž¥ ì¢‹ì€ ë°©ë²•ì€ 'ê·¹ë‹¨ì ì¸' ì˜ˆì‹œë¥¼ ë“¤ì–´ ì„¤ëª…í•˜ëŠ” ê²ƒìž…ë‹ˆë‹¤. ì—¬ê¸°ì„œ ì €ëŠ” 50ê°œì˜ ë¬´ìž‘ìœ„ í”¼ì³ (200ê°œì˜ ì¸ìŠ¤í„´ìŠ¤)ê°€ ì£¼ì–´ì¡Œì„ ë•Œ ì—°ì†í˜• random target outcomeì„ ì˜ˆì¸¡í•˜ë„ë¡ SVMì„ í•™ìŠµì‹œì¼°ìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œ "random"ì´ëž€ targetì´ 50ê°œì˜ í”¼ì³ì™€ëŠ” ë¬´ê´€í•˜ë‹¤ëŠ” ì˜ë¯¸ìž…ë‹ˆë‹¤. ëª¨ë¸ì´ ì–´ë–¤ ê´€ê³„ë¥¼ "í•™ìŠµ"í•˜ë©´ ê³¼ì í•©ì´ ë°œìƒí•©ë‹ˆë‹¤. ì‹¤ì œë¡œ SVM ì€ train dataë¥¼ ê³¼ì í•© í–ˆìŠµë‹ˆë‹¤. Train dataì˜ MAEëŠ” 0.29, test dataì˜ MAEëŠ” 0.82ì´ë©°, ì´ëŠ” í‰ê· ì´ 0ì¸ targetì„ ì˜ˆì¸¡í•˜ëŠ” best ëª¨ë¸ìž…ë‹ˆë‹¤ (MAE : 0.78). ì¦‰, ì´ SVM ëª¨ë¸ì€ í˜•íŽ¸ì—†ìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ê³¼ì í•©ëœ SVMì˜ 50ê°œ í”¼ì³ì— ëŒ€í•´ ë³€ìˆ˜ ì¤‘ìš”ë„ëŠ” ì˜ë¯¸ê°€ ì—†ìŠµë‹ˆë‹¤. Unseen test dataì˜ ì„±ëŠ¥ í–¥ìƒì— ê¸°ì—¬í•˜ëŠ” í”¼ì³ê°€ í•˜ë‚˜ë„ ì—†ìœ¼ë¯€ë¡œ 0ìœ¼ë¡œ í•´ì•¼í• ê¹Œìš”? ì•„ë‹ˆë©´ í•™ìŠµëœ ê´€ê³„ê°€ ë³´ì´ì§€ ì•ŠëŠ” (unseen) ë°ì´í„°ì— ì¼ë°˜í™”ë˜ëŠ”ì§€ ì—¬ë¶€ì™€ ê´€ê³„ì—†ì´ ëª¨ë¸ì´ ê° í”¼ì³ì— ì–¼ë§ˆë‚˜ ì˜ì¡´í•˜ëŠ”ì§€ë¥¼ ë°˜ì˜í•´ì•¼ í• ê¹Œìš”? ìš°ì„  train dataì™€ test dataì˜ ë³€ìˆ˜ ì¤‘ìš”ë„ ë¶„í¬ê°€ ì–´ë–»ê²Œ ë‹¤ë¥¸ì§€ ì‚´íŽ´ë³´ê² ìŠµë‹ˆë‹¤.

![](Pasted%20image%2020240103000212.png) Figure 8.24 : SVMì´ ë°ì´í„°ë¥¼ ê³¼ì í•©í–ˆìŠµë‹ˆë‹¤. Train dataë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ë³€ìˆ˜ ì¤‘ìš”ë„ëŠ” ì¤‘ìš”í•œ í”¼ì³ë“¤ì„ ë§Žì´ ë³´ì—¬ì¤ë‹ˆë‹¤. Unseen test data ì—ì„œ ê³„ì‚°ëœ ë³€ìˆ˜ ì¤‘ìš”ë„ëŠ” 1(ì¤‘ìš”í•˜ì§€ ì•ŠìŒ)ì— ê°€ê¹ìŠµë‹ˆë‹¤.

ë‘ ê²°ê³¼ ì¤‘ ì•„ì§ ì–´ëŠ ê²ƒì´ ë” ë°”ëžŒì§í•œì§€ ì•Œ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ë‘ ë²„ì „ ëª¨ë‘ì— ëŒ€í•œ ì‚¬ë¡€ë¥¼ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤.

#### The case for test data

Train dataì— ê¸°ë°˜í•œ ëª¨ë¸ ì˜¤ë¥˜ (ì¶”ì •ì¹˜)ëŠ” ì“°ë ˆê¸° (garbage) -> ë³€ìˆ˜ ì¤‘ìš”ë„ëŠ” ëª¨ë¸ ì˜¤ë¥˜ (ì¶”ì •ì¹˜)ì— ì˜ì¡´í•¨ -> í•™ìŠµ ë°ì´í„°ì— ê¸°ë°˜í•œ ë³€ìˆ˜ ì¤‘ìš”ë„ëŠ” ì“°ë ˆê¸° (garbage)ìž…ë‹ˆë‹¤. ëª¨ë¸ì„ í•™ìŠµì‹œí‚¨ ë°ì´í„°ì—ì„œ ëª¨ë¸ ì˜¤ì°¨/ì„±ëŠ¥ì„ ì¸¡ì •í•˜ë©´ ë³´í†µ ì¸¡ì •ê°’ì´ ë„ˆë¬´ ë‚™ê´€ì /ê¸ì •ì ì´ê¸° ë•Œë¬¸ì— ì‹¤ì œë³´ë‹¤ í›¨ì”¬ ë” ìž˜ ìž‘ë™í•˜ëŠ” ê²ƒì²˜ëŸ¼ ë³´ìž…ë‹ˆë‹¤. PFIëŠ” ëª¨ë¸ ì˜¤ì°¨ì˜ ì¸¡ì •ê°’ì— ì˜ì¡´í•˜ê¸° ë•Œë¬¸ì— unseen test data ë¥¼ ì‚¬ìš©í•´ì„œ ì¸¡ì •í•´ì•¼ í•©ë‹ˆë‹¤. Train dataì— ê¸°ë°˜í•œ ë³€ìˆ˜ ì¤‘ìš”ë„ëŠ” ì‹¤ì œë¡œëŠ” ëª¨ë¸ì´ ê·¸ ë°ì´í„°ì— ê³¼ì í•©í•œ ê²ƒì— ë¶ˆê³¼í•˜ê³  ì „í˜€ ì¤‘ìš”í•˜ì§€ ì•Šì€ í”¼ì³ì¸ë°ë„ ì¤‘ìš”í•˜ë‹¤ê³  íŒë‹¨í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

#### The case for training data

Garbage SVMì„ ë‹¤ì‹œ ì‚´íŽ´ë´…ì‹œë‹¤. Train dataì— ë”°ë¥´ë©´ ê°€ìž¥ ì¤‘ìš”í•œ í”¼ì³ëŠ” `X42` ìž…ë‹ˆë‹¤. í”¼ì³ `X42`ì˜ PDPë¥¼ ë³´ë©´ í•´ë‹¹ í”¼ì³ì˜ ë³€í™”ì— ë”°ë¼ ëª¨ë¸ì˜ ì¶œë ¥ì¸ ì˜ˆì¸¡ì¹˜ê°€ ì–´ë–»ê²Œ ë³€í•˜ëŠ”ì§€ë¥¼ ë³´ì—¬ì£¼ë©° ì¼ë°˜í™” ì˜¤ë¥˜ì— ì˜ì¡´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¦‰, PDPëŠ” train í˜¹ì€ test dataë¡œ ê³„ì‚°ë˜ì—ˆëŠ”ì§€ê°€ ì¤‘ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

![](Pasted%20image%2020240104182053.png) Figure 8.25 : Train dataë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ë³€ìˆ˜ ì¤‘ìš”ë„ì—ì„œ ê°€ìž¥ ì¤‘ìš”í•˜ë‹¤ê³  ë‚˜ì˜¨ `X42`ì˜ PDP. ì´ í”Œë¡¯ì€ SVMì´ `X42`ì— ì˜ì¡´í•˜ì—¬ ì˜ˆì¸¡ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ì‹ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.

ì´ ê·¸ë¦¼ì€ SVMì´ ì˜ˆì¸¡ì— í”¼ì³ `X42`ì— ì˜ì¡´í•˜ë„ë¡ í•™ìŠµë˜ì—ˆì§€ë§Œ test data ê¸°ë°˜ì˜ ë³€ìˆ˜ ì¤‘ìš”ë„ë¥¼ ë³´ë©´ `X42`ëŠ” ì¤‘ìš” ë³€ìˆ˜ê°€ ì•„ë‹˜ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. Train dataì— ê¸°ë°˜í•œ ì¤‘ìš”ë„ëŠ” 1.19ìž…ë‹ˆë‹¤. Train data ê¸°ë°˜ ë³€ìˆ˜ ì¤‘ìš”ë„ëŠ” ì˜ˆì¸¡ì¹˜ ê³„ì‚°ì— ìžˆì–´ì„œ ê·¸ ëª¨ë¸ì´ ì–´ë– í•œ í”¼ì³ì— ì˜ì¡´í•œë‹¤ëŠ” ì˜ë¯¸ì—ì„œ ë³€ìˆ˜ë“¤ì˜ ì¤‘ìš”ë„ë¥¼ ì•Œë ¤ì¤ë‹ˆë‹¤.

Train dataë¥¼ ì‚¬ìš©í•˜ëŠ” ì‚¬ë¡€ì˜ ì¼í™˜ìœ¼ë¡œ ì–´ë– í•œ ì˜ˆì‹œë¥¼ ì†Œê°œí•˜ê² ìŠµë‹ˆë‹¤. ì‹¤ì œë¡œëŠ” ëª¨ë“  ë°ì´í„°ë¥¼ ì‚¬ìš©í•´ì„œ ëª¨ë¸ì„ í•™ìŠµì‹œí‚¤ê³  ìµœì¢…ì ìœ¼ë¡œ ìµœìƒì˜(best) ëª¨ë¸ì„ ì–»ê³ ìž í•©ë‹ˆë‹¤. ì¦‰, í”¼ì³ ì¤‘ìš”ë“œë¥¼ ê³„ì‚°í•˜ëŠ” ë° ì“°ì§€ ì•Šì€ test dataëŠ” ë‚¨ì•„ ìžˆì§€ ì•Šì•„ì•¼ í•©ë‹ˆë‹¤. ëª¨ë¸ì˜ ì¼ë°˜í™” ì˜¤ë¥˜ë¥¼ ì¶”ì •í•  ë•Œë„ ë™ì¼í•œ ë¬¸ì œê°€ ë°œìƒí•©ë‹ˆë‹¤. í”¼ì³ ì¤‘ìš”ë„ ì¶”ì •ì— (nested) CVë¥¼ ì‚¬ìš©í•˜ë©´ ëª¨ë“  ë°ì´í„°ê°€ í¬í•¨ëœ ìµœì¢… ëª¨ë¸ì—ì„œ í”¼ì³ ì¤‘ìš”ë„ê°€ ê³„ì‚°ë˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ê°ê¸° ë‹¤ë¥´ê²Œ ìž‘ë™í•˜ëŠ” ë°ì´í„°ì˜ ë¶€ë¶„ ì§‘í•©ì— ëŒ€í•œ ëª¨ë¸ì—ì„œ ë³€ìˆ˜ ì¤‘ìš”ë„ê°€ ê³„ì‚°ë©ë‹ˆë‹¤.

í•˜ì§€ë§Œ, PFIëŠ” test dataì—ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. ëª¨ë¸ì˜ ì˜ˆì¸¡ì¹˜ê°€ í”¼ì³ì˜ ì˜í–¥ì„ ì–¼ë§ˆë‚˜ ë°›ëŠ”ì§€ì— ê´€ì‹¬ì´ ìžˆë‹¤ë©´ SHAP importanceì™€ ê°™ì€ ì¸¡ì •ê°’ì„ ì‚¬ìš©í•´ì•¼ í•˜ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤.


## 3. Example and Interpretation

ì—¬ê¸°ì„œëŠ” ì¤‘ìš”ë„ ê³„ì‚°ì— ì½”ë“œì˜ ê¸¸ì´ë¥¼ ì¤„ì´ê¸° ìœ„í•´ train dataë¡œ ì¤‘ìš”ë„ë¥¼ ê³„ì‚°í–ˆìŠµë‹ˆë‹¤.

#### Cervical cancer (classification)

ìžê¶ê²½ë¶€ì•” ì˜ˆì¸¡ì„ ìœ„í•´ Random Forest ëª¨ë¸ì„ ì ìš©í•©ë‹ˆë‹¤. ì˜¤ì°¨ì˜ ì¦ê°ì€ 1-AUCë¡œ ì¸¡ì •í•©ë‹ˆë‹¤. ëª¨ë¸ ì˜¤ì°¨ê°€ 1ë°° ì¦ê°€(=ë³€í™” ì—†ìŒ)í•˜ëŠ” í”¼ì³ë“¤ì€ ìžê¶ê²½ë¶€ì•” ì˜ˆì¸¡ì— ì¤‘ìš”í•˜ì§€ ì•Šì€ ê²ƒìž…ë‹ˆë‹¤ :

![](Pasted%20image%2020240104184404.png) Figure 8.26 : RFì˜ ìžê¶ê²½ë¶€ì•” ì˜ˆì¸¡ì— ëŒ€í•œ ê° í”¼ì³ ì¤‘ìš”ë„. ê°€ìž¥ ì¤‘ìš”í•œ í”¼ì³ëŠ” í˜¸ë¥´ëª¬ í”¼ìž„ì•½ ë³µìš© ë…„ìˆ˜ìž…ë‹ˆë‹¤. ì´ ë³€ìˆ˜ ê°’ì„ ì„žìœ¼ë©´ 1-AUCê°€ 6.33ë°° ì¦ê°€í•©ë‹ˆë‹¤.

#### Bike sharing (regression)

íšŒê·€ ë¬¸ì œë¡œëŠ” ë‚ ì”¨ ê´€ë ¨ ë³€ìˆ˜ë“¤ê³¼ ì‹œê°„ ê´€ë ¨ ì •ë³´ë“¤ì„ ì´ìš©í•´ SVMì„ ì í•©í•˜ì—¬ ìžì „ê±° ëŒ€ì—¬ ìˆ˜ ì˜ˆì¸¡ì„ í•´ê²°í•´ ë³´ê² ìŠµë‹ˆë‹¤. ì˜¤ì°¨ ì¸¡ì •ê°’ìœ¼ë¡œëŠ” í‰ê·  ì ˆëŒ€ ì˜¤ì°¨ (MAE)ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤ : 

![](Pasted%20image%2020240104185419.png) Figure 8.27 : ê°€ìž¥ ì£¼ìš” ë³€ìˆ˜ëŠ” `temp`, ëœ ì¤‘ìš”í•œ ë³€ìˆ˜ëŠ” `holiday`ìž…ë‹ˆë‹¤.

## 4. Advantages

- **Nice interpretation** : ë³€ìˆ˜ ì¤‘ìš”ë„ëŠ” í”¼ì³ì˜ ì •ë³´ê°€ íŒŒê´´ë  ë•Œ ëª¨ë¸ ì˜¤ë¥˜ê°€ ì¦ê°€í•¨ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.
- ë³€ìˆ˜ ì¤‘ìš”ë„ëŠ” ëª¨ë¸ ë™ìž‘ì— ëŒ€í•œ **ë§¤ìš° ì••ì¶•ëœ ì „ë°˜ì ì¸ ì¸ì‚¬ì´íŠ¸ (highly compressed, global insight)**ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
- ì˜¤ì°¨ì˜ ì°¨ì´ê°’ ëŒ€ì‹  ì˜¤ë¥˜ ë¹„ìœ¨ ì‚¬ìš© ì‹œ ìž¥ì ì€ **ë‹¤ë¥¸ ì—¬ëŸ¬ ë¬¸ì œë“¤ê³¼ ë³€ìˆ˜ ì¤‘ìš”ë„ ì¸¡ì •ê°’ì„ ë¹„êµí•  ìˆ˜ ìžˆë‹¤**ëŠ” ê²ƒìž…ë‹ˆë‹¤.
- ì¤‘ìš”ë„ ê°’ì€ ë‹¤ë¥¸ í”¼ì³ë“¤ê³¼ì˜ **ëª¨ë“  ìƒí˜¸ìž‘ìš©ì„ ìžë™ìœ¼ë¡œ ê³ ë ¤í•˜ì—¬** ê³„ì‚°ë©ë‹ˆë‹¤. í”¼ì³ë“¤ì„ ì„žìœ¼ë©´ ë‹¤ë¥¸ í”¼ì³ì™€ì˜ ìƒí˜¸ìž‘ìš© íš¨ê³¼ëŠ” ì‚¬ë¼ì§‘ë‹ˆë‹¤. ì¦‰, PFIëŠ” ëª¨ë¸ ì„±ëŠ¥ì— ëŒ€í•œ ì£¼íš¨ê³¼ì™€ ìƒíš¨ìž‘ìš© íš¨ê³¼ë¥¼ ëª¨ë‘ ê³ ë ¤í•©ë‹ˆë‹¤. ì´ëŠ” ë‘ ê°œì˜ í”¼ì³ ê°„ ìƒí˜¸ìž‘ìš©ì˜ ì¤‘ìš”ë„ê°€ ë‘ í”¼ì³ì˜ ì¤‘ìš”ë„ ì¸¡ì •ì— í¬í•¨ë˜ê¸° ë•Œë¬¸ì— ë‹¨ì ì´ê¸°ë„ í•©ë‹ˆë‹¤. ì¦‰, ë³€ìˆ˜ ì¤‘ìš”ë„ê°€ ì´ ì„±ëŠ¥ í•˜ë½ì— í•©ì‚°ë˜ì§€ëŠ” ì•Šì§€ë§Œ ì´í•©ì´ ë” í¬ë‹¤ëŠ” ì˜ë¯¸ìž…ë‹ˆë‹¤. (ì„ í˜• ëª¨ë¸ì²˜ëŸ¼) í”¼ì³ ê°„ ìƒí˜¸ìž‘ìš©ì´ ì—†ëŠ” ê²½ìš°ì—ë§Œ ì¤‘ìš”ë„ê°€ ëŒ€ëžµì ìœ¼ë¡œ í•©ì‚°ë©ë‹ˆë‹¤. 
- PFIëŠ” ëª¨ë¸ì„ **ìž¬í•™ìŠµí•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤**. ë‹¤ë¥¸ ë°©ë²•ë“¤ì€ íŠ¹ì • í”¼ì³ë¥¼ ì‚­ì œí•˜ê³  ëª¨ë¸ì„ ìž¬í•™ìŠµí•œ ë‹¤ìŒ ëª¨ë¸ ì˜¤ì°¨ë¥¼ ë¹„êµí•´ ì¤‘ìš”ë„ë¥¼ ê³„ì‚°í•˜ëŠ” ê²½ìš°ê°€ ë§ŽìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ìž¬í•™ìŠµì—ëŠ” ì‹œê°„ì´ ì˜¤ëž˜ ê±¸ë¦¬ë¯€ë¡œ, PFI ì²˜ëŸ¼ í”¼ì³ë¥¼ ì˜¤ì§ ì„žê¸°ë§Œ í•˜ë©´ ë§Žì€ ì‹œê°„ì„ ì ˆì•½í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ë˜í•œ ë°ì´í„°ì˜ ë¶€ë¶„ ì§‘í•©ìœ¼ë¡œ ëª¨ë¸ì„ ìž¬í•™ìŠµí•˜ëŠ” ì¤‘ìš”ë„ ë°©ì‹ë„ ê´œì°®ì•„ë³´ì´ì§€ë§Œ, ì¤„ì–´ë“  ë°ì´í„°ë¥¼ ì´ìš©í•œ ëª¨ë¸ì€ ë³€ìˆ˜ ì¤‘ìš”ë„ì— ìžˆì–´ì„œëŠ” ì˜ë¯¸ê°€ ì—†ìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” ê³ ì •ëœ ëª¨ë¸ì˜ ë³€ìˆ˜ ì¤‘ìš”ë„ì— ê´€ì‹¬ì´ ìžˆëŠ” ê²ƒì´ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤. ì¶•ì†Œëœ ë°ì´í„°ì…‹ìœ¼ë¡œ ìž¬í•™ìŠµí•˜ë©´ ê´€ì‹¬ ëª¨ë¸ê³¼ëŠ” ë‹¤ë¥¸ ëª¨ë¸ì´ ìƒì„±ë©ë‹ˆë‹¤. 

## 5. Disadvantages

- PFIëŠ” **ëª¨ë¸ì˜ ì˜¤ë¥˜ì™€ ê´€ë ¨ ìžˆìŠµë‹ˆë‹¤**. ì´ëŠ” ë³¸ì§ˆì ìœ¼ë¡œëŠ” ë‚˜ìœ ì ì´ ì•„ë‹ˆì§€ë§Œ ë¶ˆí•„ìš”í•œ ê²½ìš°ê°€ ë§ŽìŠµë‹ˆë‹¤. ì–´ë–¤ ê²½ìš°ì—ëŠ” ì„±ëŠ¥ì— ëŒ€í•œ ì˜ë¯¸ëŠ” ê³ ë ¤í•˜ì§€ ì•Šê³  í”¼ì³ì— ë”°ë¼ ëª¨ë¸ ì¶œë ¥ì´ ì–´ë–»ê²Œ ë‹¬ë¼ì§€ëŠ”ì§€ë§Œ ì•Œê³  ì‹¶ì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ëˆ„êµ°ê°€ëŠ” í”¼ì³ë¥¼ ì¡°ìž‘í–ˆì„ ë•Œ ëª¨ë¸ ì¶œë ¥ì´ ì–¼ë§ˆë‚˜ ê²¬ê³ í•œì§€(robust) ì•Œê³  ì‹¶ì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì´ ê²½ìš° í”¼ì³ê°€ ì„žì¼ ë•Œ ëª¨ë¸ ì„±ëŠ¥ì´ ì–¼ë§ˆë‚˜ ê°ì†Œí•˜ëŠ”ì§€ê°€ ì•„ë‹ˆë¼ ê° í”¼ì³ê°€ ëª¨ë¸ì˜ ì¶œë ¥(ì˜ˆì¸¡ì¹˜)ì˜ ë¶„ì‚°ì„ ì–¼ë§ˆë‚˜ ì„¤ëª…í•˜ëŠ”ì§€ì— ê´€ì‹¬ì´ ìžˆëŠ” ê²½ìš°ìž…ë‹ˆë‹¤. ëª¨ë¸ì´ ìž˜ ì¼ë°˜í™”ë  ë•Œ (ì¦‰, ê³¼ì í•©ì´ ë‚˜ì§€ ì•Šì„ ë•Œ), ëª¨ë¸ ë¶„ì‚° (model variance) (í”¼ì³ë¡œ ì„¤ëª…ë¨)ê³¼ í”¼ì³ ì¤‘ìš”ë„ëŠ” ê°•í•œ ìƒê´€ê´€ê³„ê°€ ìžˆìŠµë‹ˆë‹¤. 
- True outcome $y$ê°€ ì¡´ìž¬í•´ì•¼ ì´ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. True $y$ê°€ ì—†ì„ ì‹œ PFIëŠ” ì´ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
- PFIëŠ” í”¼ì³ ê°’ì— ë¬´ìž‘ìœ„ì„±(randomness)ë¥¼ ì¶”ê°€í•˜ê¸° ë•Œë¬¸ì— í”¼ì³ì˜ shuffleì— ë”°ë¼ ë‹¬ë¼ì§‘ë‹ˆë‹¤. ì„žëŠ” ê²ƒì„ ë°˜ë³µí•˜ë©´ ì¤‘ìš”ë„ ê²°ê³¼ê°€ ë‹¬ë¼ì§ˆ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. Shufflingì„ ë°˜ë³µí•˜ê³  ì´ëŸ¬í•œ ë°˜ë³µì— ë”°ë¥¸ ì¸¡ì •ê°’ë“¤ì˜ í‰ê· ìœ¼ë¡œ ì¤‘ìš”ë„ë¥¼ êµ¬í•˜ë©´ ì¸¡ì •ì¹˜ëŠ” ì•ˆì •í™”ë˜ì§€ë§Œ, ê³„ì‚° ì‹œê°„ì€ ëŠ˜ì–´ë‚©ë‹ˆë‹¤.
- í”¼ì³ë“¤ì´ ìƒí™” ì—°ê´€ë˜ì–´ ìžˆëŠ” ê²½ìš°, PFIëŠ” **ë¹„í˜„ì‹¤ì ì¸ ì¸ìŠ¤í„´ìŠ¤ ëª‡ ê°œì— ì˜í•´ íŽ¸í–¥ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤**. ì´ ë¬¸ì œëŠ” PDPì™€ ë™ì¼í•©ë‹ˆë‹¤ : 2ê°œ ì´ìƒì˜ í”¼ì³ë“¤ì´ ìƒê´€ë˜ì—ˆì„ ë•Œ í”¼ì³ë“¤ì„ ì„žë‹¤ë³´ë©´ ë¹„í˜„ì‹¤ì ì¸ ì¸ìŠ¤í„´ìŠ¤ê°€ ë§Œë“¤ì–´ì§‘ë‹ˆë‹¤. ë”°ë¼ì„œ í”¼ì³ê°€ ê°•í•œ ìƒê´€ê´€ê³„ì— ë†“ì—¬ ìžˆëŠ”ì§€ë¥¼ ë¨¼ì € í™•ì¸í•˜ê³  í•´ì„ì— ì£¼ì˜ë¥¼ í•´ì•¼ í•©ë‹ˆë‹¤. 
- ë˜ ê¹Œë‹¤ë¡œìš´ ì ì€ **ìƒê´€ê´€ê³„ì— ë†“ì¸ í”¼ì³ë¥¼ ì¶”ê°€í•˜ë©´ ë‘ í”¼ì³ê°„ ì¤‘ìš”ë„ê°€ ë‚˜ë‰˜ì–´ì„œ í•´ë‹¹ í”¼ì³ë“¤ì˜ ì¤‘ìš”ë„ê°€ ë‚®ì•„ì§ˆ ìˆ˜ ìžˆë‹¤**ëŠ” ì ìž…ë‹ˆë‹¤. í”¼ì³ ì¤‘ìš”ë„ë¥¼ 'ë¶„í• 'í•˜ëŠ” ê²ƒì˜ ì˜ˆë¥¼ ë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤: ë¹„ê°€ ì˜¬ í™•ë¥ ì„ ì˜ˆì¸¡í•˜ê³  ì „ë‚  ì˜¤ì „ 8ì‹œ ê¸°ì˜¨ì„ ìƒê´€ê´€ê³„ê°€ ì—†ëŠ” ë‹¤ë¥¸ í”¼ì³ë“¤ê³¼ í•¨ê»˜ í•˜ë‚˜ì˜ í”¼ì³ë¡œ ì‚¬ìš©í•˜ë ¤ í•©ë‹ˆë‹¤. random forestë¥¼ í•™ìŠµí•œ ê²°ê³¼ ì˜¨ë„ê°€ ê°€ìž¥ ì¤‘ìš”í•œ í”¼ì³ì´ë©° ëª¨ë“  ê²ƒì´ ìž˜ ë§žì•˜ìŠµë‹ˆë‹¤. ì´ì œ ì˜¤ì „ 8ì‹œì™€ ê°•í•œ ìƒê´€ê´€ê³„ì— ìžˆëŠ” ì˜¤ì „ 9ì‹œ ì˜¨ë„ë¥¼ ì¶”ê°€ í”¼ì³ë¡œ í¬í•¨ì‹œì¼  ìƒí™©ì„ ê°€ì •í•˜ê² ìŠµë‹ˆë‹¤. ì˜¤ì „ 8ì‹œì˜ ì˜¨ë„ë¥¼ ì´ë¯¸ ì•Œê³  ìžˆê¸° ë•Œë¬¸ì— 9ì‹œì˜ ì˜¨ë„ëŠ” ë³„ë‹¤ë¥¸ ì¶”ê°€ ì •ë³´ë¥¼ ì œê³µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. Random Forestì˜ ì—¬ëŸ¬ íŠ¸ë¦¬ ì¤‘ ì¼ë¶€ëŠ” ì˜¤ì „ 8ì‹œì˜ ì˜¨ë„ë¥¼, ë‹¤ë¥¸ íŠ¸ë¦¬ëŠ” 9ì‹œì˜ ì˜¨ë„ë¥¼, ë˜ ë‹¤ë¥¸ íŠ¸ë¦°ëŠ ë‘ ê°€ì§€ ì˜¨ë„ë¥¼... í¬ì°©í•©ë‹ˆë‹¤. ë‘ ê°œì˜ ì˜¨ë„ í”¼ì³ê°€ í•©ì³ì§€ë©´ ì¤‘ìš”ë„ì˜ ì´í•©ì€ ê¸°ì¡´ë³´ë‹¤ ì¡°ê¸ˆ ë” ë†’ì•„ì§€ì§€ë§Œ, ê°ê°ì€ ê°€ìž¥ ì¤‘ìš”í•œ í”¼ì³ë¡œ ì„ ì •ë˜ì§€ ì•Šê³  ì¤‘ê°„ ì •ë„ì˜ ì¤‘ìš”ë„ë¥¼ ê°–ìŠµë‹ˆë‹¤. ìƒê´€ê´€ê³„ì— ë†“ì¸ í”¼ì³ë¥¼ ì¶”ê°€í•¨ìœ¼ë¡œì¨ ê°€ìž¥ ì¤‘ìš”í•œ í”¼ì³ë¥¼ í‰ë²ˆí•œ í”¼ì³ë¡œ ëŒì–´ë‚´ë¦¬ê²Œ ëœ ê²ƒìž…ë‹ˆë‹¤. ì´ë ‡ê²Œ í•¨ìœ¼ë¡œì¨ ë³€ìˆ˜ ì¤‘ìš”ë„ì— ëŒ€í•œ í•´ì„ì´ ë” ì–´ë ¤ì›Œì§‘ë‹ˆë‹¤. ë˜ ë‹¤ë¥¸ ì˜ˆë¥¼ ë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤: í”¼ì³ì— ì¸¡ì • ì˜¤ë¥˜ê°€ ìžˆëŠ”ì§€ í™•ì¸í•˜ë ¤ í•œë‹¤ê³  í•´ë³´ê² ìŠµë‹ˆë‹¤. ì´ ì ê²€ì€ ë¹„ìš©ì´ ë§Žì´ ë“¤ê¸° ë•Œë¬¸ì— ê°€ìž¥ ì¤‘ìš”í•œ 3ê°œì˜ í”¼ì³ë§Œ ì ê²€í•˜ê¸°ë¡œ í–ˆìŠµë‹ˆë‹¤. ì²« ë²ˆì§¸ ì‹œë‚˜ë¦¬ì˜¤ëŠ” ì˜¨ë„ë¥¼ í™•ì¸í•˜ëŠ” ê²ƒì´ê³ , ë‘ ë²ˆì§¸ëŠ” ì˜¨ë„ í”¼ì³ê°€ ì¤‘ìš”ë„ë¥¼ ê³µìœ /ë¶„í• í•œë‹¤ëŠ” ì´ìœ ë¡œ í¬í•¨í•˜ì§€ ì•ŠëŠ” ê²ƒìž…ë‹ˆë‹¤. ì¤‘ìš”ë„ ê°’ì´ ëª¨ë¸ ë™ìž‘ ìˆ˜ì¤€ì—ì„œëŠ” ì˜ë¯¸ê°€ ìžˆì„ ìˆœ ìžˆì§€ë§Œ, ìƒí˜¸ ì—°ê´€ëœ í”¼ì³ê°€ ìžˆëŠ” ê²½ìš°ì—ëŠ” í˜¼ëž€ì„ ì•¼ê¸°í•©ë‹ˆë‹¤. 

## 6. Alternatives

[`PIMP`](https://academic.oup.com/bioinformatics/article/26/10/1340/193348?login=false)ë¼ëŠ” ì•Œê³ ë¦¬ì¦˜ì€ PFI ì•Œê³ ë¦¬ì¦˜ì„ ì¡°ì •í•˜ì—¬ ì¤‘ìš”ë„ì— ëŒ€í•œ p-valuesë¥¼ ì œê³µí•©ë‹ˆë‹¤. ë˜ ë‹¤ë¥¸ ì†ì‹¤ ê¸°ë°˜ (loss-based) ëŒ€ì•ˆì€ train dataì—ì„œ í”¼ì³ë¥¼ ìƒëžµí•˜ê³  ëª¨ë¸ì„ ìž¬í•™ìŠµí•œ í›„ ì†ì‹¤ì˜ ì¦ê°€ë¥¼ ì¸¡ì •í•˜ëŠ” ê²ƒìž…ë‹ˆë‹¤. í”¼ì³ ê°’ì„ ì„žê³  ì†ì‹¤ì˜ ì¦ê°€ë¥¼ ì¸¡ì •í•˜ëŠ” ê²ƒì´ ë³€ìˆ˜ ì¤‘ìš”ì„±ì˜ ìœ ì¼í•œ ì¸¡ì •ë²•ì´ ì•„ë‹™ë‹ˆë‹¤. ë‹¤ì–‘í•œ ì¤‘ìš”ë„ ì¸¡ì • ë°©ë²•ì€ ëª¨ë¸ë³„ (model-specific) ë°©ë²•ê³¼ model-agnostic ë°©ë²•ìœ¼ë¡œ ë‚˜ë‰©ë‹ˆë‹¤. Random Forestì— ëŒ€í•œ Gini index ë˜ëŠ” íšŒê·€ ëª¨ë¸ì— ëŒ€í•œ standardized coefficientsëŠ” model-specific ì¸¡ì •ì˜ ì˜ˆìž…ë‹ˆë‹¤.

PFIì— ëŒ€í•œ model-agnostic ë°©ë²•ì˜ ëŒ€ì•ˆì€ ë¶„ì‚° ê¸°ë°˜ (variance-based) ì¸¡ì •ë²•ìž…ë‹ˆë‹¤. Variance-based feature importance (ì˜ˆ: Sobol's indices, functional ANOVA)ì€ ì˜ˆì¸¡ í•¨ìˆ˜ì—ì„œ ë†’ì€ ë¶„ì‚°ì„ ìœ ë°œí•˜ëŠ” í”¼ì³ì— ë” ë†’ì€ ì¤‘ìš”ë„ë¥¼ ë¶€ì—¬í•©ë‹ˆë‹¤. SHAPì´ ì´ëŸ¬í•œ ë¶„ì‚° ê¸°ë°˜ ì¤‘ìš”ë„ì™€ ìœ ì‚¬í•©ë‹ˆë‹¤. í”¼ì³ë¥¼ ë³€ê²½í•˜ë©´ outputì´ í¬ê²Œ ë³€í•˜ëŠ” ê²½ìš° í•´ë‹¹ í”¼ì³ì˜ ì¤‘ìš”ë„ê°€ ë†’ì•„ì§‘ë‹ˆë‹¤. ì´ëŸ¬í•œ ì¤‘ìš”ë„ì˜ ì •ì˜ëŠ” PFIì²˜ëŸ¼ loss-based ì •ì˜ì™€ëŠ” ë‹¤ë¦…ë‹ˆë‹¤. ì´ëŠ” ëª¨ë¸ì´ ê³¼ì í•©ëœ ê²½ìš°ì— ë¶„ëª…í•˜ê²Œ/ëª…ë°±í•˜ê²Œ ë‚˜íƒ€ë‚©ë‹ˆë‹¤. ëª¨ë¸ì´ ê³¼ì í•©ë˜ì–´ outputê³¼ ê´€ë ¨ì´ ì—†ëŠ” í”¼ì³ë¥¼ ì‚¬ìš©í•  ê²½ìš°, PFIëŠ” ì´ í”¼ì³ê°€ ì˜¬ë°”ë¥¸ ì˜ˆì¸¡ì¹˜ ìƒì„±ì— ê¸°ì—¬í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— 0ì˜ ì¤‘ìš”ì„±ì„ í• ë‹¹í•©ë‹ˆë‹¤. ë°˜ë©´ì— variance-based ì¤‘ìš”ë„ ì¸¡ì •ë²•ì€ í”¼ì³ê°’ì´ ë³€í•  ë•Œ ì˜ˆì¸¡ì¹˜ê°€ ë§Žì´ ë°”ë€” ìˆ˜ ìžˆìœ¼ë¯€ë¡œ ì´ëŸ¬í•œ í”¼ì³ì— ë†’ì€ ì¤‘ìš”ë„ë¥¼ í• ë‹¹í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 

ë‹¤ì–‘í•œ ì¤‘ìš”ë„ ì¸¡ì • ê¸°ë²•ì€ Wei (2015)ì˜ ë…¼ë¬¸ì—ì„œ ë‹¤ë£¨ê³  ìžˆìŠµë‹ˆë‹¤.

## 7. Software

ìœ„ ì˜ˆì œë“¤ì—ì„œëŠ” `iml` íŒ¨í‚¤ì§€ê°€ ì“°ì˜€ìŠµë‹ˆë‹¤. R ì—ì„œëŠ” `DALEX`ì™€ `vip` íŒ¨í‚¤ì§€ì—ì„œ ì´ëŸ¬í•œ ê¸°ëŠ¥ì„ ì œê³µí•˜ë©°, Pyhonì—ì„œëŠ” `alibi`, `scikit-learn`, `rfpimp`ì—ì„œ ì´ëŸ¬í•œ model-agnosticí•œ PFIë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤. 

---

# ðŸ“•08-06. Global Surrogate

Global surrogate modelì€ black box ëª¨ë¸ì˜ ì˜ˆì¸¡ì¹˜ë¥¼ ê·¼ì‚¬í•˜ë„ë¡ í•™ìŠµëœ interpretable modelìž…ë‹ˆë‹¤. Surrogate modelì„ í•´ì„í•˜ì—¬ black box ëª¨ë¸ì— ëŒ€í•œ ê²°ë¡ ì„ ëƒ…ë‹ˆë‹¤. 

## 1. Theory

Interpretable MLì—ì„œ ë§í•˜ëŠ” surrogate modelì€ ê¸°ë³¸ black box modelì´ ML ëª¨ë¸ì´ê³ , ì´ surrogate modelì´ í•´ì„ ê°€ëŠ¥í•´ì•¼ í•©ë‹ˆë‹¤. (Interpretable) surrogate modelì˜ ëª©ì ì€ ê¸°ë³¸ (black box) ëª¨ë¸ì˜ ì˜ˆì¸¡ì¹˜ë¥¼ ê°€ëŠ¥í•œ í•œ ì •í™•ížˆ ê·¼ì‚¬í•˜ë©´ì„œ í•´ì„ì„ ì œê³µí•˜ëŠ” ê²ƒìž…ë‹ˆë‹¤. ì´ surrogate modelì€ ë‹¤ì–‘í•œ ì´ë¦„ìœ¼ë¡œ ë¶ˆë¦½ë‹ˆë‹¤ : Approximation model, metamodel, response surface model, emulator, ...

ì‚¬ì‹¤ surrogate modelì˜ ì´í•´ì— í•„ìš”í•œ ì´ë¡ ì€ ê·¸ë¦¬ ë§Žì§€ ì•ŠìŠµë‹ˆë‹¤. ìš°ë¦¬ëŠ” black box ì˜ˆì¸¡í•¨ìˆ˜ $f$ ë¥¼ surrogate modelì˜ ì˜ˆì¸¡ í•¨ìˆ˜ $g$ ë¥¼ ì´ìš©í•´ ìµœëŒ€í•œ ê°€ê¹ê²Œ ê·¼ì‚¬ì‹œí‚¤ê³ ìž í•˜ëŠ”ë°, ì´ ë•Œ $g$ ëŠ” í•´ì„ì´ ê°€ëŠ¥í•´ì•¼ í•œë‹¤ëŠ” ì œì•½ì´ ìžˆìŠµë‹ˆë‹¤. í•¨ìˆ˜ $g$ ë¡œ [CH05. Interpretable Methods](CH05.%20Interpretable%20Methods.md) ì—ì„œ ë‹¤ë£¨ëŠ” í•´ì„ ê°€ëŠ¥í•œ ëª¨ë¸ë“¤ì„ ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

For example a linear model : 
$$
g(x) = \beta_0+\beta_1x_1+\ldots+\beta_px_p
$$
Or a decision tree : 
$$
g(x) = \sum_{m=1}^Mc_mI\{x\in R_m\}
$$
Surrogate modelì„ í•™ìŠµí•˜ëŠ” ê²ƒì€ black box ëª¨ë¸ì˜ ë‚´ë¶€ ìž‘ë™ì— ëŒ€í•œ ì •ë³´ê°€ í•„ìš”í•˜ì§€ ì•Šê³  ë°ì´í„°ì™€ ì˜ˆì¸¡ í•¨ìˆ˜ì— ëŒ€í•œ ì ‘ê·¼ì„±/ì•¡ì„¸ìŠ¤(access)ë§Œ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— ì´ ë°©ë²•ì€ model-agnosticìž…ë‹ˆë‹¤. ê¸°ë³¸ ML ëª¨ë¸ì´ ë‹¤ë¥¸ ëª¨ë¸ë¡œ êµì²´ëœ ê²½ìš°ì—ë„ ì—¬ì „ížˆ surrogate modelì„ ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. Black box ëª¨ë¸ ìœ í˜•ê³¼ surrogate model ìœ í˜•ì˜ ì„ íƒì€ ë¶„ë¦¬ë˜ì–´ ìžˆìŠµë‹ˆë‹¤.

ì•„ëž˜ì˜ ë‹¨ê³„ë“¤ì„ ìˆ˜í–‰í•˜ì—¬ surrogate modelì„ ì–»ì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤ : 
1. ë°ì´í„°ì…‹ $X$ ë¥¼ ì„ íƒí•©ë‹ˆë‹¤. Black box ëª¨ë¸ì„ í›ˆë ¨í•  ë•Œ ì‚¬ìš©í•œ ë°ì´í„°ì…‹, í˜¹ì€ ê·¸ì™€ ë™ì¼í•œ ë¶„í¬ì˜ ë°ì´í„°ì…‹ì´ì–´ì•¼ í•©ë‹ˆë‹¤. ê²½ìš°ì— ë”°ë¼ ë°ì´í„°ì˜ ë¶€ë¶„ ì§‘í•© or í¬ì¸íŠ¸ grid ì¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 
2. ì„ íƒí•œ ë°ì´í„°ì…‹ $X$ì— ëŒ€í•´ black box modelì˜ ì˜ˆì¸¡ì¹˜ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤. 
3. Interpretable model type (linear mode, decision tree, ...)ì„ ì„ íƒí•©ë‹ˆë‹¤.
4. ë°ì´í„°ì…‹ $X$ì™€ ê·¸ ì˜ˆì¸¡ì¹˜ì— ëŒ€í•˜ì—¬ ì„ íƒí•œ interpretable modelì„ í•™ìŠµí•©ë‹ˆë‹¤.
5. ì´ì œ surrogate modelì´ ìƒê²¼ìŠµë‹ˆë‹¤.
6. ì´ì œ ì´ surrogate modelì´ black box modelì˜ ì˜ˆì¸¡ì¹˜ë¥¼ ì–¼ë§ˆë‚˜ ìž˜ ê·¼ì‚¬/ë³µì œí•˜ëŠ”ì§€ë¥¼ ì¸¡ì •í•©ë‹ˆë‹¤. 
7. ê·¸ëŸ° ë‹¤ìŒ surrogate modelì„ í•´ì„í•©ë‹ˆë‹¤.

Surrogate model ì— ëŒ€í•œ ì ‘ê·¼ë²•ë“¤ì—ëŠ” ëª‡ëª‡ ì¶”ê°€ì ì¸ ë‹¨ê³„ê°€ ìžˆê±°ë‚˜ ë‹¤ë¥¼ ìˆ˜ ìžˆì§€ë§Œ ë³´í†µì€ ì´ëŸ¬í•œ ë‹¨ê³„ë¥¼ ê±°ì¹©ë‹ˆë‹¤.

Surrogate modelì´ black box modelì„ ì–¼ë§ˆë‚˜ ìž˜ ê·¼ì‚¬/ë³µì œí•˜ëŠ”ì§€ ì¸¡ì •í•˜ëŠ” í•œ ê°€ì§€ ë°©ë²•ì€ R-squared (ê²°ì •ê²Œìˆ˜)ìž…ë‹ˆë‹¤ : 
$$
R^2=1-\frac{S S E}{S S T}=1-\frac{\sum_{i=1}^n\left(\hat{y}_*^{(i)}-\hat{y}^{(i)}\right)^2}{\sum_{i=1}^n\left(\hat{y}^{(i)}-\overline{\hat{y}}\right)^2}
$$
ì—¬ê¸°ì„œ $\hat{y}_*^{(i)}$ëŠ” $i$ ë²ˆì§¸ ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•œ surrogate modelì˜ ì˜ˆì¸¡ì¹˜ì´ê³ , $\hat{y}^{(i)}$ëŠ” $i$ ë²ˆì§¸ ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•œ black box modelì˜ ì˜ˆì¸¡ì¹˜, $\bar{\hat{y}}$ëŠ” black box model ì˜ˆì¸¡ì¹˜ë“¤ì˜ í‰ê· ê°’ìž…ë‹ˆë‹¤. SSEëŠ” ì˜¤ì°¨ì œê³±í•©, SSTëŠ” ì´ ì œê³±í•©ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. $R^2$ê°€ 1ì— ê°€ê¹Œìš°ë©´ (=SSEê°€ ë‚®ìœ¼ë©´) interpretable modelì´ black box moldeì˜ ë™ìž‘ì„ ë§¤ìš° ìž˜ ê·¼ì‚¬í•œë‹¤ëŠ” ê²ƒìž…ë‹ˆë‹¤. ì´ë ‡ê²Œ ë§¤ìš° ê·¼ì ‘í•œ ê²½ìš° ë³µìž¡í•œ ëª¨ë¸ì„ interpretable modelë¡œ ëŒ€ì²´í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. $R^2$ê°€ 0ì— ê°€ê¹Œìš°ë©´ (=SSEê°€ ë†’ìœ¼ë©´) ë°˜ëŒ€ì˜ ìƒí™©ì¸ ê²ƒìž…ë‹ˆë‹¤. 

ì—¬ê¸°ì„œ ê¸°ì €ì— ê¹”ë¦° black box modelì˜ ì„±ëŠ¥ì— ëŒ€í•´ì„œëŠ” ë‹¤ë£¨ì§€ ì•ŠìŠµë‹ˆë‹¤. Black box modelì˜ ì„±ëŠ¥ì€ surrogate modelì„ í•™ìŠµí•˜ëŠ” ë° ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤. Surrogate modelì˜ í•´ì„ì€ ì‹¤ì œê°€ ì•„ë‹Œ ëª¨ë¸ì˜ ì§„ìˆ ì„ ìœ„í•œ ê²ƒì´ê¸° ë•Œë¬¸ì— ì—¬ì „ížˆ ìœ íš¨í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ë¬¼ë¡  black box modelì´ ìž˜ëª»ëœ ê²ƒì´ë©´ ê·¸ ìžì²´ê°€ ë¬´ì˜ë¯¸í•´ì§€ê¸° ë•Œë¬¸ì— ì´ì— ë”°ë¥¸ surrogate modelì˜ í•´ì„ ë˜í•œ ì“¸ëª¨ê°€ ì—†ì–´ì§€ëŠ” ê²ƒì€ ë‹¹ì—°í•©ë‹ˆë‹¤. 

ì›ë³¸ ë°ì´í„°ì˜ ë¶€ë¶„ ì§‘í•©ì„ ê¸°ë°˜ìœ¼ë¡œ surrogate modelì„ ë§Œë“¤ê±°ë‚˜ ì¸ìŠ¤í„´ìŠ¤ë“¤ì˜ ê°€ì¤‘ì¹˜ë¥¼ ìž¬ì¡°ì •í•˜ì—¬ ë§Œë“¤ ìˆ˜ë„ ìžˆìŠµë‹ˆë‹¤. ì´ëŸ° ì‹ìœ¼ë¡œ surrogate model ì˜ inputì˜ ë¶„í¬ë¥¼ ë³€ê²½í•˜ë©´ í•´ì„ì˜ ì´ˆì ì´ ë°”ë€ë‹ˆë‹¤ (ê·¸ëŸ¬ë©´ ë” ì´ìƒ ì „ì—­ì /globalì´ì§€ ì•Šê²Œ ë©ë‹ˆë‹¤). íŠ¹ì • ì¸ìŠ¤í„´ìŠ¤ë³„ë¡œ locally ê°€ì¤‘ì¹˜ë¥¼ ë¶€ì—¬í•˜ë©´ (ì„ íƒí•œ ì¸ìŠ¤í„´ìŠ¤ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ê°€ì¤‘ì¹˜ê°€ ë†’ì•„ì§), ì¸ìŠ¤í„´ìŠ¤ ê°œë³„ ì˜ˆì¸¡ì„ ì„¤ëª…í•  ìˆ˜ ìž‡ëŠ” local surrogate modelì„ ì–»ëŠ” ê²ƒìž…ë‹ˆë‹¤. ë‹¤ìŒ ì„¹ì…˜ì—ì„œ ì´ëŸ¬í•œ local modelì— ëŒ€í•´ ì•Œì•„ë³¼ ê²ƒìž…ë‹ˆë‹¤. 

## 2. Example

ìš°ì„  ë‚ ì”¨ì™€ ë‚ ì§œ ì •ë³´ê°€ ì£¼ì–´ì¡Œì„ ë•Œ ì¼ì¼ ìžì „ê±° ëŒ€ì—¬ ìˆ˜ ì˜ˆì¸¡ì„ ìœ„í•´ SVMì„ í•™ìŠµí•©ë‹ˆë‹¤. SVMì€ í•´ì„ì´ ì–´ë µê¸° ë•Œë¬¸ì— ì´ ëª¨ë¸ì˜ ë™ìž‘ì„ ê·¼ì‚¬í™”í•˜ê¸° ìœ„í•´ interpretable í•œ CARTë¥¼ ì‚¬ìš©í•´ surrogate modelì„ í•™ìŠµí•˜ê² ìŠµë‹ˆë‹¤ : 

![](Pasted%20image%2020240104200527.png) Figure 8.28 : ìžì „ê±° ë°ì´í„°ë¡œ í•™ìŠµëœ SVMì˜ ì˜ˆì¸¡ì¹˜ë¥¼ ê·¼ì‚¬í™”í•˜ëŠ” surrogate treeì˜ í„°ë¯¸ë„ ë…¸ë“œìž…ë‹ˆë‹¤. ë…¸ë“œì˜ ë¶„í¬ë¥¼ ë³´ë©´ surrogate treeëŠ” `temp`ê°€ ì•½ 13ë„ ì´ìƒì¼ ë•Œì™€ 2ë…„ê°„ì˜ ì¼ ìˆ˜ ê°€ 435ì¼ë³´ë‹¤ í´ ë•Œ ëŒ€ì—¬ ìžì „ê±° ìˆ˜ê°€ ë” ë§Žì„ ê²ƒìœ¼ë¡œ ì˜ˆì¸¡í•˜ê³  ìžˆìŠµë‹ˆë‹¤.

Surrogate modelì˜ $R^2$ (variance explained) ê°’ì€ 0.77ë¡œ, ê¸°ì €ì— ê¹”ë¦° black box modelì˜ ë™ìž‘ì„ ìƒë‹¹ížˆ ìž˜ ì¶”ì •í•˜ì§€ë§Œ ì™„ë²½í•˜ì§„ ì•ŠìŠµë‹ˆë‹¤. ì í•©ë„ê°€ ì™„ë²½í•˜ë‹¤ë©´ SVMì„ ë²„ë¦¬ê³  ì´ íŠ¸ë¦¬ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 

ë‘ ë²ˆì§¸ ì˜ˆì‹œë¡œëŠ” random forestë¥¼ ì‚¬ìš©í•˜ì—¬ ìžê¶ê²½ë¶€ì•” ë°œìƒ í™•ë¥ ì„ ì˜ˆì¸¡í•˜ëŠ” ê²ƒìž…ë‹ˆë‹¤. ì—¬ê¸°ì„œë„ CARTë¥¼ surrogate modelë¡œ ì‚¼ì§€ë§Œ, ì´ ëª¨ë¸ì´ ì‚¬ìš©í•˜ëŠ” outputì€ random forestì˜ ì˜ˆì¸¡ì¹˜ìž…ë‹ˆë‹¤ :
![](Pasted%20image%2020240104202024.png) Figure 8.29 : ìžê¶ê²½ë¶€ì•” ë°ì´í„°ì— ëŒ€í•´ í•™ìŠµí•œ RFì˜ ì˜ˆì¸¡ì¹˜ë¥¼ ê·¼ì‚¬í•˜ëŠ” surrogate treeì˜ í„°ë¯¸ë„ ë…¸ë“œìž…ë‹ˆë‹¤. ë…¸ë“œ ë‚´ countsëŠ” í•´ë‹¹ ë…¸ë“œì—ì„œ black box modelì˜ ë¶„ë¥˜ ë¹ˆë„ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.

Surrogate modelì˜ $R^2$ (variance explained)ëŠ” 0.19ë¡œ, RFì— ì œëŒ€ë¡œ ê·¼ì‚¬í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì´ íŠ¸ë¦¬ë¥¼ ê³¼ë„í•˜ê²Œ í•´ì„í•˜ë©´ ì•ˆë©ë‹ˆë‹¤.

## 3. Advantages

- Surrogate model methodëŠ” **ìœ ì—°(flexible)** í•©ë‹ˆë‹¤ : [CH05. Interpretable Methods](CH05.%20Interpretable%20Methods.md)ì˜ ëª¨ë“  ëª¨ë¸ì„ ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì´ëŠ” interpretable model ë¿ ì•„ë‹ˆë¼ black box modelë„ êµí™˜ì´ ê°€ëŠ¥í•˜ë‹¤ëŠ” ì–˜ê¸°ìž…ë‹ˆë‹¤. ë³µìž¡í•œ ëª¨ë¸ì„ ë§Œë“¤ì–´ì„œ íšŒì‚¬ íŒ€ì›ë“¤ì—ê²Œ ì„¤ëª…í•˜ëŠ” ìƒí™©ì´ë¼ê³  í•˜ê² ìŠµë‹ˆë‹¤. íŒ€ë§ˆë‹¤ ìµìˆ™í•œ ëª¨ë¸ì´ ë‹¤ë¥¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì›ëž˜ì˜ black box modelì— ëŒ€í•´ ê° íŒ€ì— ìµìˆ™í•œ surrogate modelsë¥¼ í•™ìŠµì‹œí‚¤ê³  2ê°€ì§€ ì¢…ë¥˜ì˜ ì„¤ëª…(explanations)ë¥¼ ì œê³µí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 
- ì´ ë°©ë²•ì€ **ë§¤ìš° ì§ê´€ì ì´ê³  ê°„ë‹¨í•©ë‹ˆë‹¤** : ì¦‰, êµ¬í˜„ì´ ì‰½ê³  MLì— ìµìˆ™í•˜ì§€ ì•Šì€ ì‚¬ëžŒë“¤ì—ê²Œë„ ì‰½ê²Œ ì„¤ëª…í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 
- $R^2$ì„ ì‚¬ìš©í•˜ë©´ surrogate modelì´ black box modelì— ì–¼ë§ˆë‚˜ ê·¼ì ‘í•œì§€ë¥¼ ì‰½ê²Œ ì¸¡ì •í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

## 4. Disadvantages

- Surrogate modelì€ ì‹¤ì œ outcomeì„ ë³¼ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì—** ë°ì´í„°ê°€ ì•„ë‹Œ ëª¨ë¸ (black box)ì— ëŒ€í•œ ê²°ë¡ **ì„ ë„ì¶œí•œë‹¤ëŠ” ì ì„ ìœ ì˜í•´ì•¼ í•©ë‹ˆë‹¤. 
- Surrogate modelì´ black box modelì— ì¶©ë¶„ížˆ ê°€ê¹ë‹¤ê³  í™•ì‹ í• ë§Œí•œ **$R^2$ì˜ ìµœì ì˜ cutoff ê°’ì´ ë¬´ì—‡ì¸ì§€ ëª…í™•í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤**.
- ì–´ë– í•œ interpretable surrogate modelì€ ë°ì´í„°ì…‹ì˜ í•œ ë¶€ë¶„ì§‘í•©ì— ëŒ€í•´ì„œëŠ” black box modelì„ ìž˜ ê·¼ì‚¬í•˜ì§€ë§Œ ë‹¤ë¥¸ ë¶€ë¶„ì§‘í•©ì— ëŒ€í•´ì„œëŠ” í¬ê²Œ ë‹¤ë¥¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 
- Surrogate modelë¡œ ì„ íƒí•˜ëŠ” interpretable modelì—ëŠ” ëª¨ë‘ ìž¥ë‹¨ì ì´ ìžˆìŠµë‹ˆë‹¤.
- ëª‡ëª‡ ì‚¬ëžŒì€ ë³¸ì§ˆì ìœ¼ë¡œ í•´ì„ ê°€ëŠ¥í•œ ëª¨ë¸ì€ ì—†ìœ¼ë©° í•´ì„ ê°€ëŠ¥ì„±ì— ëŒ€í•œ í™˜ìƒì„ ê°–ëŠ” ê²ƒì¡°ì°¨ ìœ„í—˜í•˜ë‹¤ê³  ì£¼ìž¥í•©ë‹ˆë‹¤.

---

# ðŸ“• 08-07. Prototypes and Criticisms

**Prototype**ì€ ëª¨ë“  ë°ì´í„°ë¥¼ ëŒ€í‘œí•˜ëŠ” ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§í•©ë‹ˆë‹¤. **Criticism**ì€ prototypes ì§‘í•©ìœ¼ë¡œ ëŒ€í‘œë˜ì§€ ì•ŠëŠ” ë°ì´í„° ì¸ìŠ¤í„´ìŠ¤ë“¤ìž…ë‹ˆë‹¤. ì´ëŸ¬í•œ criticismì˜ ëª©ì ì€ prototypesê°€ ìž˜ ë‚˜íƒ€ë‚´ì§€ ëª»í•˜ëŠ” ë°ì´í„° ìš”ì†Œì— ëŒ€í•œ ì¸ì‚¬ì´íŠ¸ë¥¼ ì°¾ëŠ” ê²ƒì— ìžˆìŠµë‹ˆë‹¤. Prototypesì™€ criticismsëŠ” ë°ì´í„°ë¥¼ ì„¤ëª…í•˜ê¸° ìœ„í•´ ML ëª¨ë¸ê³¼ ë…ë¦½ì ìœ¼ë¡œ ì“¸ ìˆ˜ ìžˆì§€ë§Œ, interpretable modelì„ ë§Œë“¤ê±°ë‚˜ black box modelì„ í•´ì„ ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ ë•Œë„ ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 

ì´ ì„¹ì…˜ì—ì„œëŠ” ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê°€ë¦¬í‚¤ëŠ” 'ë°ì´í„° í¬ì¸íŠ¸'ë¼ëŠ” í‘œí˜„ì„ ì‚¬ìš©í•˜ëŠ”ë°, ì´ëŠ” ê° í”¼ì³ê°€ ì°¨ì›ì¸ ì¢Œí‘œê³„ì˜ í•œ ì ìœ¼ë¡œ ì¸ìŠ¤í„´ìŠ¤ê°€ ì¡´ìž¬í•¨ì„ í•´ì„í•˜ê¸°ë¥¼ ê°•ì¡°í•˜ê¸° ìœ„í•´ì„œìž…ë‹ˆë‹¤. ì•„ëž˜ ê·¸ë¦¼ì€ ì¼ë¶€ ì¸ìŠ¤í„´ìŠ¤ë“¤ì„ prototypesë¡œ ì¼ë¶€ëŠ” criticismsë¡œ ì„ íƒí•œ (ì‹œë®¬ë ˆì´ì…˜) ë°ì´í„° ë¶„í¬ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤. ìž‘ì€ ì ì€ ë°ì´í„°, í° ì ì€ criticisms, í° ë„¤ëª¨ëŠ” prototypesìž…ë‹ˆë‹¤. PrototypesëŠ”ë°ì´í„° ë¶„í¬ì˜ ì¤‘ì‹¬ë“¤ì„ í¬í•¨í•˜ë„ë¡ (ìˆ˜ë™ìœ¼ë¡œ) ì„ íƒí•˜ë©°, criticismsëŠ” prototypesê°€ ì—†ëŠ” ì§‘ë‹¨ (clusters)ì˜ í¬ì¸íŠ¸ë“¤ìž…ë‹ˆë‹¤. 
![](Pasted%20image%2020240104204141.png) Figure 8.30 : Prototypes and criticisms for a data distribution with two features x1 and x2.

Prototypesë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì„ íƒí•˜ë©´ ê²°ê³¼ê°€ ì¢‹ì§€ ì•Šì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ë°ì´í„°ì—ì„œ prototypesë¥¼ ì°¾ëŠ” ë°©ë²•ì„ ëª‡ ê°€ì§€ ì†Œê°œí•˜ê² ìŠµë‹ˆë‹¤. K-means ì•Œê³ ë¦¬ì¦˜ê³¼ ê´€ë ¨ëœ clustering ì•Œê³ ë¦¬ì¦˜ì¸ K-medoidsìž…ë‹ˆë‹¤. ë°ì´í„° í¬ì¸íŠ¸ë“¤ì„ í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ìœ¼ë¡œ ë°˜í™˜í•˜ëŠ” ëª¨ë“  í´ëŸ¬ìŠ¤í„°ë§ ì•Œê³ ë¦¬ì¦˜ì€ prototypesë¥¼ ì„ íƒí•˜ëŠ” ë° ì ì ˆí•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ ë°©ë²• ëŒ€ë¶€ë¶„ì€ prototypesë§Œì„ ì°¾ì„ ë¿ criticismsëŠ” ì œê³µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ ì„¹ì…˜ì—ì„œëŠ” prototypesì™€ criticismsì„ í•˜ë‚˜ì˜ í”„ë ˆìž„ì›Œí¬ê²Œ ê²°í•©í•œ ì ‘ê·¼ë²•ì€ Kim et al. (2016)ì˜ MMD-criticì„ ì†Œê°œí•˜ê² ìŠµë‹ˆë‹¤.

MMD-criticì€ ë°ì´í„°ì˜ ë¶„í¬ì™€ ì„ íƒëœ prototypesì˜ ë¶„í¬ë¥¼ ë¹„êµí•©ë‹ˆë‹¤. ì´ê²ƒì´ í•µì‹¬ ê°œë…ìž…ë‹ˆë‹¤. MMD-criticì€ ë‘ ë¶„í¬ ê°„ ë¶ˆì¼ì¹˜ë¥¼ ìµœì†Œí™”í•˜ëŠ” prototypesë¥¼ ì„ íƒí•©ë‹ˆë‹¤. íŠ¹ížˆ ì„œë¡œ ë‹¤ë¥¸ êµ°ì§‘/í´ëŸ¬ìŠ¤í„°ì—ì„œ í¬ì¸íŠ¸ë¥¼ ì„ íƒí•˜ëŠ” ê²½ìš° ë°€ë„ê°€ ë†’ì€ ì˜ì—­ì˜ ë°ì´í„° í¬ì¸íŠ¸ê°€ ì¢‹ì€ prototypesê°€ ë©ë‹ˆë‹¤. Prototypesë¡œ ìž˜ ì„¤ëª…ë˜ì§€ ì•ŠëŠ” ì˜ì—­ì˜ ë°ì´í„° ìš”ì†ŒëŠ” criticismsì˜ ëŒ€ìƒìœ¼ë¡œ ì„ íƒë©ë‹ˆë‹¤. 

ì´ë¡ ì— ëŒ€í•´ ì‚´íŽ´ë³´ê² ìŠµë‹ˆë‹¤.

## 1. Theory

MMD-criticì˜ ì ˆì°¨ëŠ” ì•„ëž˜ì™€ ê°™ì´ ê°„ëžµí•˜ê²Œ ìš”ì•½í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤ :
1. ì°¾ê³ ìž í•˜ëŠ” prototypesì™€ criticismsì˜ ê°œìˆ˜ë¥¼ ê³ ë¦…ë‹ˆë‹¤.
2. Greedy searchë¡œ prototypesë¥¼ ì°¾ìŠµë‹ˆë‹¤. Prototypesì˜ ë¶„í¬ê°€ ë°ì´í„° ë¶„í¬ì— ê°€ê¹Œì›Œì§€ë„ë¡ prototypesë¥¼ ì„ íƒí•©ë‹ˆë‹¤. 
3. Greedy searchë¡œ criticismsì„ ì°¾ìœ¼ì„¸ìš”. Prototypesì˜ ë¶„í¬ê°€ ë°ì´í„°ì˜ ë¶„í¬ì™€ ë‹¤ë¥¸ í¬ì¸íŠ¸ë“¤ì„ criticismsìœ¼ë¡œ ì„ íƒí•©ë‹ˆë‹¤. 

MMD-criticìœ¼ë¡œ ë°ì´í„°ì…‹ì— ëŒ€í•œ prototypesì™€ criticismsì„ ì°¾ê¸° ìœ„í•´ì„  ëª‡ ê°€ì§€ í•„ìš”í•œ ê²ƒì´ ìžˆìŠµë‹ˆë‹¤. ê°€ìž¥ ê¸°ë³¸ì ì¸ ìš”ì†ŒëŠ” ë°ì´í„°ì˜ ë°€ë„ë¥¼ ì¶”ì •í•˜ê¸° ìœ„í•œ **ì»¤ë„ í•¨ìˆ˜(kernel function)** ìž…ë‹ˆë‹¤. ì»¤ë„ í•¨ìˆ˜ëŠ” ë‘ ë°ì´í„° í¬ì¸íŠ¸ì˜ ê·¼ì ‘ì„±(proximity)ì— ë”°ë¼ ê°€ì¤‘ì¹˜ë¥¼ ë¶€ì—¬í•˜ëŠ” í•¨ìˆ˜ìž…ë‹ˆë‹¤. ë°€ë„ ì¶”ì •ì„ ê¸°ë°˜ìœ¼ë¡œ ì„ íƒí•œ prototypesì˜ ë¶„í¬ê°€ ë°ì´í„° ë¶„í¬ì— ê°€ê¹Œìš´ì§€ ì—¬ë¶€ë¥¼ ì•Œë ¤ë©´ ë‘ ë¶„í¬ì˜ ì°¨ì´ë¥¼ ì•Œë ¤ì£¼ëŠ” ì¸¡ì •ë²•ì´ í•„ìš”í•©ë‹ˆë‹¤. ì´ëŠ” **ìµœëŒ€ í‰ê·  ë¶ˆì¼ì¹˜ (maximum mean discrepancy; MMD)** ë¥¼ ì‚¬ìš©í•´ ì¸¡ì •í•©ë‹ˆë‹¤. ë˜í•œ ì»¤ë„ í•¨ìˆ˜ë¥¼ ê¸°ë°˜ìœ¼ë¡œ íŠ¹ì •í•œ ë°ì´í„° í¬ì¸íŠ¸ì—ì„œ ë‘ ë¶„í¬ê°€ ì–¼ë§ˆë‚˜ ë‹¤ë¥¸ì§€ ì•Œë ¤ì£¼ëŠ” **witness function** ì´ í•„ìš”í•©ë‹ˆë‹¤. Witness functionì„ ì‚¬ìš©í•˜ë©´ criticisms, ì¦‰ prototypesì™€ ë°ì´í„°ì˜ ë¶„í¬ê°€ êµ¬ë¶„ë˜ê³  witness functionê°€ ì ˆëŒ€ê°’ì´ í° ë°ì´í„° í¬ì¸íŠ¸ë“¤ì„ ì„ íƒí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ë§ˆì§€ë§‰ ìš”ì†ŒëŠ” ì¢‹ì€ prototypesì™€ criticismsì— ëŒ€í•œ ê²€ìƒ‰ ì „ëžµì¸ë°, ì´ëŠ” ê°„ë‹¨ížˆ **greedy search**ë¡œ í•´ê²°í•©ë‹ˆë‹¤.

ìš°ì„  ë‘ ë¶„í¬ ê°„ ë¶ˆì¼ì¹˜ë¥¼ ì¸¡ì •í•˜ëŠ” **MMD** ë¥¼ ë³´ê² ìŠµë‹ˆë‹¤. Prototypesì„ ì„ íƒí•˜ë©´ prototypesì˜ ë°€ë„ ë¶„í¬ê°€ ìƒì„±ë©ë‹ˆë‹¤. ì´ì œ prototypesì˜ ë¶„í¬ê°€ ë°ì´í„° ë¶„í¬ì™€ ë‹¤ë¥¸ì§€ í‰ê°€í•˜ë ¤ í•©ë‹ˆë‹¤. ì»¤ë„ ë°€ë„ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ ë‘ ê°€ì§€ ë¶„í¬ë¥¼ ëª¨ë‘ ì¶”ì •í•©ë‹ˆë‹¤. MMDëŠ” ë‘ ë¶„í¬ ê°„ ì°¨ì´ë¥¼ ì¸¡ì •í•˜ë©°, ì´ëŠ” ë‘ ë¶„í¬ì— ë”°ë¥¸ ê¸°ëŒ€ê°’ë“¤ì˜ ì°¨ì´ê°’ì˜ í•¨ìˆ˜ ê³µê°„ì— ëŒ€í•œ ìµœëŒ“ê°’ìž…ë‹ˆë‹¤. ìž˜ ì´í•´ê°€ ë˜ì§€ ì•Šì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì•„ëž˜ ê³µì‹ì€ MMD ì¸¡ì •ê°’ì˜ ì œê³± ($MMD^2$)ì„ ê³„ì‚°í•˜ëŠ” ë°©ë²•ìž…ë‹ˆë‹¤ : 
$$
M M D^2=\frac{1}{m^2} \sum_{i, j=1}^m k\left(z_i, z_j\right)-\frac{2}{m n} \sum_{i, j=1}^{m, n} k\left(z_i, x_j\right)+\frac{1}{n^2} \sum_{i, j=1}^n k\left(x_i, x_j\right)
$$
ì—¬ê¸°ì„œ $k$ëŠ” ë‘ ê°œì˜ í¬ì¸íŠ¸ì˜ ìœ ì‚¬ë„ë¥¼ ì¸¡ì •í•˜ëŠ” ì»¤ë„ í•¨ìˆ˜ì¸ë°, ì´ëŠ” ì¶”í›„ì— ë‹¤ë£¨ê² ìŠµë‹ˆë‹¤. $m$ì€ prototypes $z$ì˜ ê°œìˆ˜ê³ , $n$ ì€ ì›ë³¸ ë°ì´í„°ì…‹ì˜ ë°ì´í„° í¬ì¸íŠ¸ $x$ì˜ ìˆ˜ìž…ë‹ˆë‹¤. Prototypes $z$ëŠ” ë°ì´í„° í¬ì¸íŠ¸ $x$ ì¤‘ ì„ íƒí•˜ëŠ” ê²ƒìž…ë‹ˆë‹¤. ê° ë°ì´í„° í¬ì¸íŠ¸ëŠ” ë‹¤ì°¨ì›ì´ë¯€ë¡œ ì—¬ëŸ¬ í”¼ì³ë¥¼ ê°–ìŠµë‹ˆë‹¤. MMD-criticì˜ ëª©ì ì€ ì´ $MMD^2$ë¥¼ ìµœì†Œí™”í•˜ëŠ” ê²ƒìž…ë‹ˆë‹¤. ì´ ê°’ì´ 0ì— ê°€ê¹Œìš¸ìˆ˜ë¡ prototypesì˜ ë¶„í¬ê°€ ë°ì´í„° ë¶„í¬ì— ê°€ê¹ë‹¤ëŠ” ê²ƒìž…ë‹ˆë‹¤. ì´ë¥¼ 0ìœ¼ë¡œ ë‚®ì¶”ê¸° ìœ„í•œ í•µì‹¬ì€ ì¤‘ê°„ì— ìžˆëŠ” termìœ¼ë¡œ, prototypesê³¼ ë‹¤ë¥¸ ëª¨ë“  ë°ì´í„° í¬ì¸íŠ¸ ì‚¬ì´ì˜ í‰ê·  ê·¼ì ‘ë„(average proximity)ì˜ 2ë°°ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤. ì´ termì´ ì²« ë²ˆì§¸ term (prototypes ì„œë¡œì— ëŒ€í•œ í‰ê·  ê·¼ì ‘ë„)ê³¼ ë§ˆì§€ë§‰ term (ë°ì´í„° í¬ì¸íŠ¸ ì„œë¡œì— ëŒ€í•œ í‰ê·  ê·¼ì ‘ë„)ì„ ë”í•˜ë©´ ê°’ê³¼ ê°™ìœ¼ë©´ prototypesì´ ë°ì´í„°ë¥¼ ì™„ë²½ížˆ ë‚˜íƒ€ë‚´ëŠ”/ì„¤ëª…í•˜ëŠ” ê²ƒìž…ë‹ˆë‹¤. 

ì•„ëž˜ ê·¸ë¦¼ì€ $MMD^2$ ì¸¡ì •ê°’ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ì²« ë²ˆì§¸ ê·¸ë¦¼ì€ 2ê°€ì§€ í”¼ì³ë¥¼ ê°–ëŠ” ë°ì´í„° í¬ì¸íŠ¸ë¥¼ ë‚˜íƒ€ë‚´ë©°, ë°ì´í„° ë°€ë„ì— ëŒ€í•œ ì¶”ì •ì¹˜ê°€ ìŒì˜ ì²˜ë¦¬ëœ ë°°ê²½ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤. ë‚˜ë¨¸ì§€ ê·¸ë¦¼ë“¤ì€ ê°ê°ì˜ MMD2 ê°’ê³¼ í•¨ê»˜ ë‹¤ì–‘í•œ prototypes selectionì„ ë³´ì—¬ì¤ë‹ˆë‹¤. prototypesëŠ” í° ì ìœ¼ë¡œ í‘œì‹œë˜ê³ , ê·¸ê²ƒì˜ ë¶„í¬ëŠ” ë“±ê³ ì„ ìœ¼ë¡œ í‘œì‹œí•©ë‹ˆë‹¤. ì´ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ì›ë³¸ ë°ì´í„°ë¥¼ ê°€ìž¥ ìž˜ ì»¤ë²„/ëŒ€í‘œí•˜ëŠ” prototypes selectionì€ ì™¼ìª½ ì•„ëž˜ ê·¸ë¦¼ìœ¼ë¡œ MMD2 ê°’ì´ ê°€ìž¥ ë‚®ìŠµë‹ˆë‹¤ : 

![](Pasted%20image%2020240104212657.png) Figure 8.31 : The squared maximum mean discrepancy measure (MMD2) for a dataset with two features and different selections of prototypes.

ì»¤ë„ì€ radial basis function; rbf kernelì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤ : 
$$
k\left(x, x^{\prime}\right)=\exp \left(-\gamma\left\|x-x^{\prime}\right\|^2\right)
$$
ì—¬ê¸°ì„œ $||x-x^\prime||^2$ì€ ë‘ ê°œì˜ í¬ì¸íŠ¸ ê°„ Euclidean ê±°ë¦¬ì´ê³ , $\gamma$ëŠ” ì²™ë„ ëª¨ìˆ˜ìž…ë‹ˆë‹¤. ì»¤ë„ê°’ì€ ë‘ ì  ì‚¬ì´ì˜ ê±°ë¦¬ì— ë”°ë¼ ê°ì†Œí•˜ë©° 0~1ì˜ ë²”ìœ„ìž…ë‹ˆë‹¤. 

Prototypesë¥¼ ì°¾ê¸° ìœ„í•œ ì•Œê³ ë¦¬ì¦˜ì—ì„œ MMD2 ê°’, ì»¤ë„, greedy searchë¥¼ ê²°í•©í•©ë‹ˆë‹¤ : 
- ë¹ˆ prototypes ëª©ë¡ìœ¼ë¡œ ì‹œìž‘í•©ë‹ˆë‹¤
- Prototypesì˜ ìˆ˜ê°€ ì„ íƒëœ ìˆ˜ $m$ ë³´ë‹¤ ì ì„ ë•Œê¹Œì§€ ê¸°ë‹¤ë¦½ë‹ˆë‹¤ : 
	- ë°ì´í„°ì…‹ì˜ ê° í¬ì¸íŠ¸ì— ëŒ€í•´ í•´ë‹¹ í¬ì¸íŠ¸ë¥¼ prototypes ëª©ë¡ì— ì¶”ê°€í•  ë•Œ $MMD^2$ ê°€ ì–¼ë§ˆë‚˜ ê°ì†Œí•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤. $MMD^2$ë¥¼ ìµœì†Œí™”í•˜ëŠ” ë°ì´í„° í¬ì¸íŠ¸ë¥¼ ëª©ë¡ì— ì¶”ê°€í•©ë‹ˆë‹¤. 
- ëª©ë¡ì„ ë°˜í™˜í•©ë‹ˆë‹¤.

Criticismsë¥¼ ì°¾ê¸° ìœ„í•œ ë‚¨ì€ ìš”ì†ŒëŠ” íŠ¹ì • í¬ì¸íŠ¸ì—ì„œ ë‘ ë°€ë„ ì¶”ì •ì¹˜ê°€ ì–¼ë§ˆë‚˜ ë‹¤ë¥¸ì§€ë¥¼ ì•Œë ¤ì£¼ëŠ” witness functionìž…ë‹ˆë‹¤. ì´ í•¨ìˆ˜ëŠ” ì•„ëž˜ì™€ ê°™ì´ ì¶”ì •í•©ë‹ˆë‹¤ : 
$$
\text { witness }(x)=\frac{1}{n} \sum_{i=1}^n k\left(x, x_i\right)-\frac{1}{m} \sum_{j=1}^m k\left(x, z_j\right)
$$
ë™ì¼í•œ í”¼ì³ë“¤ì„ ê°–ëŠ” ë‘ ê°œì˜ ë°ì´í„°ì…‹ì´ ìžˆì„ ë•Œ ì´ëŸ¬í•œ witness functionì€ í¬ì¸íŠ¸ $x$ê°€ ì–´ë–¤ empirical distributionì— ë” ìž˜ ë§žëŠ”ì§€ í‰ê°€í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. Criticismsë¥¼ ì°¾ê¸° ìœ„í•´ ìŒì˜ ë°©í–¥ê³¼ ì–‘ì˜ ë°©í–¥ ëª¨ë‘ì—ì„œ witness functionì˜ ê·¹ë‹¨ê°’(extreme values)ì„ ì°¾ìŠµë‹ˆë‹¤. Witness functionì˜ ì²« ë²ˆì§¸ í•­ì€ ì  $x$ì™€ ë°ì´í„° í¬ì¸íŠ¸ ê°„ í‰ê·  ê·¼ì ‘ì„±ì´ê³ , ë‘ ë²ˆì§¸ í•­ì€ ì  $x$ì™€ prototypes ê°„ í‰ê·  ê·¼ì ‘ì„±ìž…ë‹ˆë‹¤. ì  $x$ì— ëŒ€í•œ witness functionì´ 0ì— ê°€ê¹Œìš°ë©´ ë°ì´í„°ì™€ prototypesì˜ ë°€ë„í•¨ìˆ˜ê°€ ì„œë¡œ ê°€ê¹ë‹¤ëŠ” ê²ƒì´ë©°, ì´ëŠ” ë‘˜ì˜ ë¶„í¬ê°€ ì„œë¡œ ìœ ì‚¬í•¨ì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ì´ì™€ ë‹¤ë¥´ê²Œ, $x$ì—ì„œì˜ witness functionì´ ìŒìˆ˜ë©´ prototypesì˜ ë¶„í¬ê°€ ë°ì´í„° ë¶„í¬ë¥¼ ê³¼ëŒ€ í‰ê°€í•˜ëŠ” ê²ƒì´ê³ , ì–‘ìˆ˜ë©´ ê³¼ì†Œí‰ê°€í•œë‹¤ëŠ” ê²ƒìž…ë‹ˆë‹¤. 

ì¢€ ë” ì§ê´€ì ì¸ ì´í•´ë¥¼ ìœ„í•´, ì•žì„  ê·¸ë¦¼ì˜ prototypesì„ ê°€ìž¥ ë‚®ì€ $MMD^2$ë¡œ ìž¬ì‚¬ìš©í•˜ê³  ìˆ˜ë™ìœ¼ë¡œ ì„ íƒí•œ í¬ì¸íŠ¸ë“¤ì— ëŒ€í•œ witness functionì„ í‘œì‹œí•´ ë³´ê² ìŠµë‹ˆë‹¤. ì•„ëž˜ ê·¸ë¦¼ì—ì„œ ì‚¼ê°í˜•ê³¼ ë ˆì´ë¸”ì€ ìˆ˜ë™ìœ¼ë¡œ ì„ íƒí•œ í¬ì¸íŠ¸ë“¤ì— ëŒ€í•œ witness function ê°’ìž…ë‹ˆë‹¤. ê°€ìš´ë° ìžˆëŠ” ì ë§Œ ì ˆëŒ€ê°’ì´ ë†’ê¸° ë•Œë¬¸ì— criticismsì˜ ì¢‹ì€ í›„ë³´ê°€ ë©ë‹ˆë‹¤. 

![](Pasted%20image%2020240104214206.png) Figure 8.32 Evaluations of the witness function at different points.

Witness functionì„ ì‚¬ìš©í•˜ë©´ prototypesë¡œ ìž˜ ëŒ€í‘œë˜ì§€ ì•ŠëŠ” ì¸ìŠ¤í„´ìŠ¤ë“¤ì„ ëª…ì‹œì ìœ¼ë¡œ ì°¾ì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. CriticismsëŠ” witness functionì—ì„œ ì ˆëŒ€ê°’ì´ ë†’ì€ í¬ì¸íŠ¸ë“¤ìž…ë‹ˆë‹¤. Prototypesì™€ ë§ˆì°¬ê°€ì§€ë¡œ criticismsë„ greedy searchë¡œ ì°¾ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì „ì²´ $MMD^2$ë¥¼ ì¤„ì´ëŠ” ëŒ€ì‹  witness functionê³¼ ì •ê·œí™” í•­(regularizer term)ì„ í¬í•¨í•˜ëŠ” cost functionì„ ìµœëŒ€í™”í•˜ëŠ” ì ì„ ì°¾ìŠµë‹ˆë‹¤. ìµœì í™” í•¨ìˆ˜ì— ëŒ€í•œ ì¶”ê°€ì ì¸ termì€ í¬ì¸íŠ¸ë“¤ì—ê²Œ ë‹¤ì–‘ì„±ì„ ì£¼ëŠ”ë°, ì´ëŠ” í¬ì¸íŠ¸ê°€ ì„œë¡œ ë‹¤ë¥¸ í´ëŸ¬ìŠ¤í„°ì—ì„œ ë‚˜ì˜¤ë„ë¡ í•˜ê¸° ìœ„í•¨ìž…ë‹ˆë‹¤.

ì´ ë‘ ë²ˆì§¸ ìŠ¤í…ì€ prototypes ì°¾ëŠ” ê²ƒê³¼ëŠ” ë¬´ê´€í•©ë‹ˆë‹¤. ëª‡ ê°€ì§€ prototypesë¥¼ ê³¨ë¼ì„œ ì´ ì ˆì°¨ë¥¼ ì‚¬ìš©í•´ criticismsë¥¼ í•™ìŠµí•  ìˆ˜ë„ ìžˆìŠµë‹ˆë‹¤. ë˜ëŠ” K-medoids ê°™ì€ í´ëŸ¬ìŠ¤í„°ë§ì„ í†µí•´ prototypesì„ ì–»ì„ ìˆ˜ë„ ìžˆìŠµë‹ˆë‹¤. 

í•œ ê°€ì§€ ì˜ë¬¸ì´ ë‚¨ìŠµë‹ˆë‹¤ : **Interpretable MLì—ì„œ MMD-criticì€ ì–´ë–»ê²Œ ì“°ì¼ê¹Œìš”?**

MMD-criticì€ 3ê°€ì§€ ë°©ë²•ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤ : 1) ë°ì´í„° ë¶„í¬ë¥¼ ë” ìž˜ ì´í•´í•˜ë„ë¡ ë•ê±°ë‚˜, 2) interpretable modelì„ êµ¬ì¶•í•˜ê±°ë‚˜, 3) black box modelì„ í•´ì„ ê°€ëŠ¥í•˜ê²Œ ë§Œë“œëŠ” ê²ƒìž…ë‹ˆë‹¤. 

Prototypesì™€ criticismsë¥¼ ì°¾ëŠ” ë°ì— MMD-criticì„ ì ìš©í•˜ë©´, íŠ¹ížˆ edge casesê°€ ìžˆëŠ” ë³µìž¡í•œ ë°ì´í„° ë¶„í¬ì˜ ê²½ìš° ë°ì´í„°ì— ëŒ€í•œ ì´í•´ë„ë¥¼ ë†’ì¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ë¿ë§Œ ì•„ë‹ˆë¼ ë” ë§Žì€ ê²ƒì„ ì–»ì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, í•´ì„ ê°€ëŠ¥í•œ ì˜ˆì¸¡ ëª¨ë¸ì„ ë§Œë“¤ ìˆ˜ ìžˆìŠµë‹ˆë‹¤ : ì´ë¥¼ 'nearest prototype model'ì´ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤. ì˜ˆì¸¡í•¨ìˆ˜ëŠ” ì•„ëž˜ì™€ ê°™ì´ ì •ì˜í•©ë‹ˆë‹¤ : 
$$
\hat{f}(x) = \operatorname{argmax}_{i\in S}k(x, x_i)
$$
ì¦‰, ì»¤ë„ í•¨ìˆ˜ì˜ ê°€ìž¥ ë†’ì€ ê°’ì„ ì‚°ì¶œí•œë‹¤ëŠ” ì˜ë¯¸ì—ì„œ prototypes $S$ ì§‘í•©ì—ì„œ ìƒˆë¡œìš´ ë°ì´í„° í¬ì¸íŠ¸ì— ê°€ìž¥ ê°€ê¹Œìš´ prototype $i$ë¥¼ ì„ íƒí•©ë‹ˆë‹¤. Prototype ìžì²´ëŠ” ì˜ˆì¸¡ì¹˜ì— ëŒ€í•œ ì„¤ëª…ìœ¼ë¡œ ë°˜í™˜ë©ë‹ˆë‹¤. ì´ ì ˆì°¨ì—ëŠ” 3ê°€ì§€ tuning parametersê°€ ìžˆìŠµë‹ˆë‹¤ : ì»¤ë„ ìœ í˜• (type of kernel), ì»¤ë„ ì²™ë„ ëª¨ìˆ˜ (kernel scaling parameter), prototypesì˜ ìˆ˜ ìž…ë‹ˆë‹¤. ëª¨ë“  parametersëŠ” CV loop ë‚´ì—ì„œ ìµœì í™”í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì´ ë°©ì‹ì—ëŠ” criticismsê°€ ì‚¬ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. 

3ë²ˆì§¸ë¡œ, ëª¨ë¸ ì˜ˆì¸¡ì¹˜ì™€ í•¨ê»˜ prototypesì™€ criticismsì„ ê²€í† í•˜ì—¬ ëª¨ë“  ML ëª¨ë¸ì„ globalí•˜ê²Œ/ ì „ì—­ì ìœ¼ë¡œ ì„¤ëª… ê°€ëŠ¥í•˜ê²Œ ë§Œë“œëŠ” ë°ì— MMD-criticì„ ì“¸ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì ˆì°¨ëŠ” ì•„ëž˜ì™€ ê°™ìŠµë‹ˆë‹¤ : 
1. MMD-critic ìœ¼ë¡œ prototypesì™€ criticismsì„ ì°¾ìŠµë‹ˆë‹¤. 
2. í‰ì†ŒëŒ€ë¡œ ML ëª¨ë¸ì„ í•™ìŠµí•©ë‹ˆë‹¤. 
3. ML ëª¨ë¸ë¡œ prototypesì™€ criticismsì— ëŒ€í•œ outcomesì„ ì˜ˆì¸¡í•©ë‹ˆë‹¤. 
4. ì´ì œ ê²°ê³¼ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤: ì–´ë–¤ ê²½ìš°ì— ì•Œê³ ë¦¬ì¦˜ì´ ìž˜ëª»ë˜ì—ˆëŠ”ì§€ íŒŒì•…í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ë°ì´í„°ë¥¼ ìž˜ í‘œí˜„í•˜ê³  ML ëª¨ë¸ì˜ ì•½ì ì„ ì°¾ëŠ” ë° ë„ì›€ì´ ë˜ëŠ” ì ì„ì„ ì–»ì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

ì–´ë–»ê²Œ ë„ì›€ì´ ë ê¹Œìš”? ëª¨ë¸ì˜ ì„±ëŠ¥ë§Œì„ í™•ì¸í•˜ëŠ” ê²ƒì€ ì¶©ë¶„í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ëª¨ë¸ì´ 99% ì •í™•í•˜ë‹¤ë©´ ë¬¸ì œì ì€ ì—¬ì „ížˆ 1%ê°€ ë‚¨ì•„ìžˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ë¼ë²¨ë„ í‹€ë¦´ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ëª¨ë“  train dataë“¤ì„ ê²€í† í•˜ê³  ì˜ˆì¸¡ì— ë¬¸ì œê°€ ìžˆëŠ”ì§€ ê²€ì‚¬í•˜ëŠ” ê²ƒì€ ë¬¸ì œë¥¼ ë°œê²¬í•  ìˆœ ìžˆì§€ë§Œ ì‹¤í˜„ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ìˆ˜ì²œ ê°œì˜ prototypesì™€ criticismsë¥¼ ì„ ë³„í•˜ëŠ” ê²ƒì€ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— ë°ì´í„°ì˜ ë¬¸ì œë¥¼ ë°œê²¬í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 

## 2. Examples

ì†ì„ ì“´ ìˆ«ìž ë°ì´í„°ì…‹ì„ ì‚¬ìš©í•´ MMD-criticì˜ ì˜ˆì‹œë¥¼ ë‹¤ë£¨ê² ìŠµë‹ˆë‹¤. 

ì•„ëž˜ prototypesë¥¼ ë³´ë©´ ìˆ«ìžë§ˆë‹¤ ì´ë¯¸ì§€ì˜ ìˆ˜ê°€ ë‹¤ë¦„ì„ ì•Œ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì´ëŠ” í´ëž˜ìŠ¤ë³„ë¡œ ê³ ì •ëœ ê°œìˆ˜ì˜ prototypesê°€ ì•„ë‹ˆë¼ ì „ì²´ ë°ì´í„°ì…‹ì—ì„œ ê³ ì •ëœ ê°œìˆ˜ì˜ prototypesì„ ì°¾ì•˜ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤. ì˜ˆìƒëŒ€ë¡œ prototypesëŠ” ìˆ«ìžë¥¼ ì“°ëŠ” ë°©ì‹ì´ ì„œë¡œ ë‹¤ë¦…ë‹ˆë‹¤. 

![](Pasted%20image%2020240104220511.png) Figure 8.33 : Prototypes for a handwritten digits dataset.

## 3. Advantages

MMD-criticì˜ ì €ìžë“¤ì€ ì‚¬ìš©ìž ì—°êµ¬ì˜ ì°¸ê°€ìžë“¤ì—ê²Œ ì´ë¯¸ì§€ë¥¼ ì œê³µí–ˆê³ , ì°¸ê°€ìžë“¤ì€ 2ê°€ì§€ í´ëž˜ìŠ¤ (ì˜ˆ: 2ê°€ì§€ ê°œ í’ˆì¢…) ì¤‘ í•˜ë‚˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” 2ê°€ì§€ ì´ë¯¸ì§€ ì¤‘ í•˜ë‚˜ë¥¼ ì‹œê°ì ìœ¼ë¡œ ì¼ì¹˜ì‹œì¼œì•¼ í–ˆìŠµë‹ˆë‹¤. ê·¸ë“¤ì€ í´ëž˜ìŠ¤ì˜ ë¬´ìž‘ìœ„ ì´ë¯¸ì§€ ëŒ€ì‹  **prototypesê³¼ criticismsì´ ì œì‹œë˜ì—ˆì„ ë•Œ ê°€ìž¥ ì¢‹ì€ ì„±ì ì„ ê±°ë‘ì—ˆìŠµë‹ˆë‹¤**.

Prototypesê³¼ criticismsì˜ ê°œìˆ˜ëŠ” ìžìœ ë¡­ê²Œ ì„ íƒí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 

MMD-criticì€ ë°ì´í„°ì˜ ë°€ë„ ì¶”ì •ì¹˜ì™€ í•¨ê»˜ ìž‘ë™í•©ë‹ˆë‹¤. ì´ëŠ” ëª¨ë“  ìœ í˜•ì˜ ë°ì´í„°ì˜ ëª¨ë“  ìœ í˜•ì˜ ML ëª¨ë¸ì—ì„œ ìž‘ë™í•©ë‹ˆë‹¤. 

ì•Œê³ ë¦¬ì¦˜ì˜ êµ¬í˜„ì´ ì‰½ìŠµë‹ˆë‹¤. 

MMD-criticì€ í•´ì„ ê°€ëŠ¥ì„±ì„ ë†’ì´ê¸° ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ë°©ì‹ì´ ë§¤ìš° ìœ ì—°í•©ë‹ˆë‹¤. ë³µìž¡í•œ ë°ì´í„° ë¶„í¬ë¥¼ ì´í•´í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. í•´ì„ ê°€ëŠ¥í•œ ML ëª¨ë¸ êµ¬ì¶•ì— ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤. ë˜ëŠ” black box modelì˜ ì˜ì‚¬ê²°ì •ì— ë„ì›€ì„ ì¤„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

Criticisimsë¥¼ ì°¾ëŠ” ê²ƒì€ prototypesì˜ ì„ ë³„ê³¼ëŠ” ë³„ê°œìž…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ë“¤ ëª¨ë‘ prototypesì™€ ë°ì´í„°ì˜ ë°€ë„ë¥¼ ë¹„êµí•˜ëŠ” ë™ì¼í•œ ë°©ë²•ìœ¼ë¡œ ìƒì„±ë˜ê¸° ë•Œë¬¸ì— MMD-criticì— ë”°ë¼ prototypesì„ ì„ íƒí•˜ëŠ” ê²ƒì´ í•©ë¦¬ì ìž…ë‹ˆë‹¤. 


## 4. Disadvantages

ìˆ˜í•™ì ìœ¼ë¡œ prototypesì™€ criticismsì€ ì„œë¡œ ë‹¤ë¥´ê²Œ ì •ì˜ë˜ì§€ë§Œ, ê·¸ êµ¬ë¶„ì€ cutoff ê°’ (prototypesì˜ ìˆ˜)ì„ ê¸°ì¤€ìœ¼ë¡œ í•©ë‹ˆë‹¤. ë°ì´í„° ë¶„í¬ë¥¼ ì»¤ë²„/ëŒ€í‘œí•˜ê¸° ìœ„í•´ ë„ˆë¬´ ì ì€ ìˆ˜ì˜ prototypesì„ ì„ íƒí–ˆë‹¤ê³  í•´ë³´ê² ìŠµë‹ˆë‹¤. CriticismsëŠ” ê²°êµ­ ìž˜ ì„¤ëª…ë˜ì§€ ì•Šì€ ì˜ì—­ì— ì§‘ì¤‘ë  ê²ƒìž…ë‹ˆë‹¤. í•˜ì§€ë§Œ prototypesë¥¼ ë” ì¶”ê°€í•˜ë©´ ê°™ì€ ì˜ì—­ì— ëŒ€í•œ criticismsì´ ë‚˜íƒ€ë‚  ê²ƒìž…ë‹ˆë‹¤. ì–´ë–¤ í•´ì„ì„ í•˜ë“  criticismsëŠ” ê¸°ì¡´ Prototypesê³¼ ê·¸ê²ƒì— ìˆ˜ì— ëŒ€í•œ (ìž„ì˜ì˜) cutoff ê°’ì— í¬ê²Œ ì˜ì¡´í•©ë‹ˆë‹¤.

Prototypesê³¼ criticismsì˜ ìˆ˜ë¥¼ ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤. ì´ëŠ” ìž¥ì ì´ìž ë‹¨ì ìž…ë‹ˆë‹¤. ì ì ˆí•œ prototypes ìˆ˜ì— ëŒ€í•œ í•´ê²°ì±…ì´ ë  ìˆ˜ ìžˆëŠ” ë°©ë²•ì€ prototypes ìˆ˜ë¥¼ ì¦ê°€ì‹œí‚¤ë©´ì„œ MMD2 curveë¥¼ ì¸¡ì •í•˜ì—¬ scree plot methodë¡œ ê²°ì •í•˜ëŠ” ê²ƒìž…ë‹ˆë‹¤. 

Kenel ê´€ë ¨ hyperparameterì˜ ì„ íƒì´ í•„ìš”í•©ë‹ˆë‹¤. 

ì¼ë¶€ í”¼ì³ê°€ targetê³¼ ê´€ë ¨ì´ ì—†ì„ ìˆ˜ ìžˆë‹¤ëŠ” ê²ƒì„ ë¬´ì‹œí•˜ê³  ëª¨ë“  í”¼ì³ë¥¼ inputìœ¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤. í•œ ê°€ì§€ í•´ê²°ì±…ì€ raw pixels ëŒ€ì‹  embeddingê³¼ ê°™ì´ ê´€ë ¨ì„± ìžˆëŠ” í”¼ì³ë“¤ë§Œ ì‚¬ìš©í•˜ëŠ” ê²ƒìž…ë‹ˆë‹¤. 

ì‚¬ìš© ê°€ëŠ¥í•œ ì½”ë“œê°€ ëª‡ ê°€ì§€ ìžˆì§€ë§Œ, íŒ¨í‚¤ì§€í™” ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.

---

